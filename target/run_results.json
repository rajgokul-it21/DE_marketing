{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-04-15T09:32:06.248253Z", "invocation_id": "173c4295-23e0-4694-a5a5-347d3e4cdfc7", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-15T09:32:05.582907Z", "completed_at": "2025-04-15T09:32:05.630230Z"}, {"name": "execute", "started_at": "2025-04-15T09:32:05.631228Z", "completed_at": "2025-04-15T09:32:05.631228Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04932761192321777, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Marketing.stg_campaigns", "compiled": true, "compiled_code": "with source as (\n    select * from MARKETING.raw.raw_campaigns\n),\n\n\ncleaned as (\n    select\n        campaign_id,\n        \n    lower(trim(nullif(campaign_name, '')))\n as campaign_name,\n        upper(\n    lower(trim(nullif(channel_id, '')))\n) as channel_id,\n         \n    try_to_date(start_date, 'MM/DD/YYYY')\n as start_date,\n        \n    try_to_date(end_date, 'DD-MM-YYYY')\n as end_date,\n        initcap(trim(nullif(status, ''))) as status,\n        \n    lower(trim(nullif(owner, '')))\n as owner,\n        split(tags, ',') as tag_list\n    from source\n)\n\nselect * from cleaned", "relation_name": "MARKETING.marketing.stg_campaigns", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-15T09:32:05.634261Z", "completed_at": "2025-04-15T09:32:05.636230Z"}, {"name": "execute", "started_at": "2025-04-15T09:32:05.636230Z", "completed_at": "2025-04-15T09:32:05.636230Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0029754638671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Marketing.stg_channels", "compiled": true, "compiled_code": "with source as (\n    select * from MARKETING.raw.raw_channels\n),\n\n\n\ncleaned as (\n    select\n        upper(trim(nullif(channel_id, ''))) as channel_id,\n        lower(trim(nullif(channel_name, ''))) as channel_name,\n        lower(trim(nullif(channel_type, ''))) as channel_type,\n        initcap(trim(nullif(region, ''))) as region,\n        \n    nullif(\n        case \n            when lower(description) in ('', 'n/a', 'none', 'null', '-') then null \n            else description\n        end,\n        ''\n    )\n as description\n    from source\n)\n\nselect * from cleaned", "relation_name": "MARKETING.marketing.stg_channels", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-15T09:32:05.636230Z", "completed_at": "2025-04-15T09:32:05.652418Z"}, {"name": "execute", "started_at": "2025-04-15T09:32:05.652418Z", "completed_at": "2025-04-15T09:32:05.652418Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01618790626525879, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Marketing.stg_leads", "compiled": true, "compiled_code": "with source as (\n    select  * from MARKETING.raw.raw_leads\n),\n\ncleaned as (\n    select\n        lead_id,\n        campaign_id,\n        lower(trim(nullif(lead_source, ''))) as lead_source,\n        \n    case \n        when lower(converted) in ('1', 'true', 'yes') then true\n        when lower(converted) in ('0', 'false', 'no') then false\n        else null\n    end\n as is_converted,\n        initcap(trim(nullif(name, ''))) as name,\n        lower(trim(nullif(email, ''))) as email,\n        converted_date,\n    from source\n)\n\nselect * from cleaned", "relation_name": "MARKETING.marketing.stg_leads", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-15T09:32:05.652418Z", "completed_at": "2025-04-15T09:32:05.652418Z"}, {"name": "execute", "started_at": "2025-04-15T09:32:05.662072Z", "completed_at": "2025-04-15T09:32:05.662072Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00965428352355957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Marketing.stg_revenue", "compiled": true, "compiled_code": "with source as (\n    select  * from MARKETING.raw.raw_revenue\n),\n\ncleaned as (\n    select\n        lead_id,\n        campaign_id,\n        lower(trim(nullif(lead_source, ''))) as lead_source,\n        \n    case \n        when lower(converted) in ('1', 'true', 'yes') then true\n        when lower(converted) in ('0', 'false', 'no') then false\n        else null\n    end\n as is_converted,\n        revenue as revenue_amount, \n        cast(revenue_date as date) as revenue_date,\n    from source\n)\n\nselect * from cleaned", "relation_name": "MARKETING.marketing.stg_revenue", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-15T09:32:05.665113Z", "completed_at": "2025-04-15T09:32:05.668940Z"}, {"name": "execute", "started_at": "2025-04-15T09:32:05.668940Z", "completed_at": "2025-04-15T09:32:05.668940Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00485992431640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Marketing.stg_spend", "compiled": true, "compiled_code": "with source as (\n    select  * from MARKETING.raw.raw_spend\n),\n\ncleaned as (\n    select\n        spend_id,\n        campaign_id,\n        \n    try_to_date(spend_date, 'DD/MM/YYYY')\n as spend_date,\n        try_to_number(replace(spend_amount, '$', '')) as spend_amount,\n        lower(currency) as currency,\n        \n    nullif(\n        case \n            when lower(notes) in ('', 'n/a', 'none', 'null', '-') then null \n            else notes\n        end,\n        ''\n    )\n as notes,\n    from source\n)\n\nselect * from cleaned", "relation_name": "MARKETING.marketing.stg_spend", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-15T09:32:05.673194Z", "completed_at": "2025-04-15T09:32:05.685899Z"}, {"name": "execute", "started_at": "2025-04-15T09:32:05.685899Z", "completed_at": "2025-04-15T09:32:05.685899Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012704610824584961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Marketing.accepted_values_stg_campaigns_status__planned__active__completed.5e1619bd58", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        status as value_field,\n        count(*) as n_records\n\n    from MARKETING.marketing.stg_campaigns\n    group by status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'planned','active','completed'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-15T09:32:05.685899Z", "completed_at": "2025-04-15T09:32:05.702473Z"}, {"name": "execute", "started_at": "2025-04-15T09:32:05.702473Z", "completed_at": "2025-04-15T09:32:05.702473Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01657390594482422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Marketing.not_null_stg_campaigns_campaign_id.644b49426a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect campaign_id\nfrom MARKETING.marketing.stg_campaigns\nwhere campaign_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-15T09:32:05.702473Z", "completed_at": "2025-04-15T09:32:05.726378Z"}, {"name": "execute", "started_at": "2025-04-15T09:32:05.727391Z", "completed_at": "2025-04-15T09:32:05.727391Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0249176025390625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Marketing.unique_stg_campaigns_campaign_id.72679b60d0", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    campaign_id as unique_field,\n    count(*) as n_records\n\nfrom MARKETING.marketing.stg_campaigns\nwhere campaign_id is not null\ngroup by campaign_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-15T09:32:05.730605Z", "completed_at": "2025-04-15T09:32:05.736104Z"}, {"name": "execute", "started_at": "2025-04-15T09:32:05.737117Z", "completed_at": "2025-04-15T09:32:05.737117Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007522106170654297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Marketing.fct_campaign_channel_effectiveness", "compiled": true, "compiled_code": "with leads as (\n    select campaign_id, count(*) as total_leads\n    from MARKETING.marketing.stg_leads\n    group by campaign_id\n),\n\nconversions as (\n    select campaign_id, count(*) as converted_leads\n    from MARKETING.marketing.stg_leads\n    where is_converted = true\n    group by campaign_id\n)\n\nselect\n    c.campaign_id,\n    c.campaign_name,\n    c.channel_id,\n    l.total_leads,\n    cv.converted_leads,\n    round(cv.converted_leads * 1.0 / nullif(l.total_leads, 0), 2) as conversion_rate\nfrom MARKETING.marketing.stg_campaigns c\nleft join leads l on c.campaign_id = l.campaign_id\nleft join conversions cv on c.campaign_id = cv.campaign_id", "relation_name": "MARKETING.marketing.fct_campaign_channel_effectiveness", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-15T09:32:05.740112Z", "completed_at": "2025-04-15T09:32:05.744456Z"}, {"name": "execute", "started_at": "2025-04-15T09:32:05.744456Z", "completed_at": "2025-04-15T09:32:05.744456Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006342649459838867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Marketing.fct_inactive_campaigns", "compiled": true, "compiled_code": "with leads as (\n    select\n        campaign_id,\n        count(*) as total_leads,\n        sum(case when is_converted then 1 else 0 end) as total_conversions\n    from MARKETING.marketing.stg_leads\n    group by campaign_id\n),\n\nall_campaigns as (\n    select\n        campaign_id,\n        campaign_name,\n        status,\n        start_date,\n        end_date\n    from MARKETING.marketing.stg_campaigns\n),\n\njoined as (\n    select \n        c.campaign_id,\n        c.campaign_name,\n        c.status,\n        c.start_date,\n        c.end_date,\n        coalesce(l.total_leads, 0) as total_leads,\n        coalesce(l.total_conversions, 0) as total_conversions\n    from all_campaigns c\n    left join leads l on c.campaign_id = l.campaign_id\n)\n\nselect *,\n    case \n        when total_leads = 0 then 'No Leads'\n        when total_conversions = 0 then 'Zero Conversions'\n    end as issue\nfrom joined\nwhere total_leads = 0 or total_conversions = 0", "relation_name": "MARKETING.marketing.fct_inactive_campaigns", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-15T09:32:05.747590Z", "completed_at": "2025-04-15T09:32:05.751589Z"}, {"name": "execute", "started_at": "2025-04-15T09:32:05.752590Z", "completed_at": "2025-04-15T09:32:05.752590Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005967617034912109, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Marketing.fct_lead_time_to_convert", "compiled": true, "compiled_code": "with leads_extended as (\n    -- Step 1: Calculate time to convert per lead\n    select\n        l.lead_id,\n        l.campaign_id,\n        l.is_converted,\n        l.converted_date,\n        c.start_date,\n        -- Calculate time to convert only if the lead is converted, and the converted date is after or equal to start date\n        case \n            when l.is_converted = true and l.converted_date is not null and l.converted_date >= c.start_date\n            then datediff('day', c.start_date, l.converted_date)\n            else null -- Set to null if not converted, or converted date is before start date, or converted date is null\n        end as time_to_convert\n    from MARKETING.marketing.stg_leads l\n    left join MARKETING.marketing.stg_campaigns c\n        on l.campaign_id = c.campaign_id\n)\n\n-- Step 2: Aggregate to get average time to convert per campaign\nselect\n    campaign_id,\n    avg(time_to_convert) as avg_time_to_convert\nfrom leads_extended\nwhere time_to_convert is not null  -- Only consider converted leads\ngroup by campaign_id\norder by avg_time_to_convert", "relation_name": "MARKETING.marketing.fct_lead_time_to_convert", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-15T09:32:05.754590Z", "completed_at": "2025-04-15T09:32:05.759385Z"}, {"name": "execute", "started_at": "2025-04-15T09:32:05.760601Z", "completed_at": "2025-04-15T09:32:05.760601Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007011890411376953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Marketing.int_lead_conversion", "compiled": true, "compiled_code": "with leads_with_channel as (\n    select\n        l.lead_id,\n        l.is_converted,\n        c.channel_id\n    from MARKETING.marketing.stg_leads l\n    left join MARKETING.marketing.stg_campaigns c\n        on l.campaign_id = c.campaign_id\n)\n\nselect\n    channel_id,\n    count(*) as total_leads,\n    count_if(is_converted) as converted_leads\nfrom leads_with_channel\ngroup by channel_id", "relation_name": "MARKETING.marketing.int_lead_conversion", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-15T09:32:05.763250Z", "completed_at": "2025-04-15T09:32:05.767604Z"}, {"name": "execute", "started_at": "2025-04-15T09:32:05.768572Z", "completed_at": "2025-04-15T09:32:05.768572Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0059506893157958984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Marketing.int_lead_lifecycle", "compiled": true, "compiled_code": "with leads_extended as (\n    select\n        l.lead_id,\n        l.name,\n        l.email,\n        l.is_converted,\n        l.converted_date,\n        c.channel_id\n    from MARKETING.marketing.stg_leads l\n    left join MARKETING.marketing.stg_campaigns c\n        on l.campaign_id = c.campaign_id\n)\n\nselect *\nfrom leads_extended", "relation_name": "MARKETING.marketing.int_lead_lifecycle", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-15T09:32:05.770361Z", "completed_at": "2025-04-15T09:32:05.770361Z"}, {"name": "execute", "started_at": "2025-04-15T09:32:05.770361Z", "completed_at": "2025-04-15T09:32:05.770361Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0003612041473388672, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Marketing.tmp_campaign_lead_check", "compiled": true, "compiled_code": "select \n    campaign_id,\n    count(*) as total_leads,\n    sum(case when is_converted then 1 else 0 end) as total_conversions\nfrom MARKETING.marketing.stg_leads\ngroup by campaign_id\norder by total_leads desc", "relation_name": "MARKETING.marketing.tmp_campaign_lead_check", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-15T09:32:05.770361Z", "completed_at": "2025-04-15T09:32:05.784997Z"}, {"name": "execute", "started_at": "2025-04-15T09:32:05.784997Z", "completed_at": "2025-04-15T09:32:05.784997Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014636039733886719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Marketing.accepted_values_stg_leads_is_converted__True__False__None.f64a5036e1", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        is_converted as value_field,\n        count(*) as n_records\n\n    from MARKETING.marketing.stg_leads\n    group by is_converted\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'True','False','None'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-15T09:32:05.787029Z", "completed_at": "2025-04-15T09:32:05.846720Z"}, {"name": "execute", "started_at": "2025-04-15T09:32:05.846720Z", "completed_at": "2025-04-15T09:32:05.846720Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.06069207191467285, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Marketing.not_null_stg_leads_lead_id.2c6a8b754b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect lead_id\nfrom MARKETING.marketing.stg_leads\nwhere lead_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-15T09:32:05.849720Z", "completed_at": "2025-04-15T09:32:05.851721Z"}, {"name": "execute", "started_at": "2025-04-15T09:32:05.851721Z", "completed_at": "2025-04-15T09:32:05.851721Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0030007362365722656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.Marketing.unique_stg_leads_lead_id.4eba5ab6bf", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    lead_id as unique_field,\n    count(*) as n_records\n\nfrom MARKETING.marketing.stg_leads\nwhere lead_id is not null\ngroup by lead_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-15T09:32:05.851721Z", "completed_at": "2025-04-15T09:32:05.862330Z"}, {"name": "execute", "started_at": "2025-04-15T09:32:05.863344Z", "completed_at": "2025-04-15T09:32:05.863344Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011623382568359375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Marketing.fct_active_campaign_revenue", "compiled": true, "compiled_code": "select\n    c.campaign_id,\n    c.campaign_name,\n    sum(r.revenue_amount) as total_revenue\nfrom MARKETING.marketing.stg_campaigns c\nleft join MARKETING.marketing.stg_revenue r on c.campaign_id = r.campaign_id\nwhere c.status = 'Active'\ngroup by 1, 2", "relation_name": "MARKETING.marketing.fct_active_campaign_revenue", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-15T09:32:05.866339Z", "completed_at": "2025-04-15T09:32:05.868338Z"}, {"name": "execute", "started_at": "2025-04-15T09:32:05.868338Z", "completed_at": "2025-04-15T09:32:05.868338Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0029990673065185547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Marketing.fct_total_revenue_by_campaign", "compiled": true, "compiled_code": "select\n    campaign_id,\n    sum(revenue_amount) as total_revenue\nfrom MARKETING.marketing.stg_revenue\ngroup by campaign_id", "relation_name": "MARKETING.marketing.fct_total_revenue_by_campaign", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-15T09:32:05.868338Z", "completed_at": "2025-04-15T09:32:05.876113Z"}, {"name": "execute", "started_at": "2025-04-15T09:32:05.878121Z", "completed_at": "2025-04-15T09:32:05.878121Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009782552719116211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Marketing.fct_channel_spend_efficiency", "compiled": true, "compiled_code": "with leads as (\n    select campaign_id, count(*) as leads\n    from MARKETING.marketing.stg_leads\n    group by campaign_id\n),\n\nspend as (\n    select campaign_id, sum(spend_amount) as spend\n    from MARKETING.marketing.stg_spend\n    group by campaign_id\n),\n\ncombined as (\n    select\n        c.channel_id,\n        s.spend,\n        l.leads\n    from MARKETING.marketing.stg_campaigns c\n    left join spend s on c.campaign_id = s.campaign_id\n    left join leads l on c.campaign_id = l.campaign_id\n)\n\nselect\n    channel_id,\n    sum(spend) as total_spend,\n    sum(leads) as total_leads,\n    round(sum(spend) / nullif(sum(leads), 0), 2) as spend_per_lead\nfrom combined\ngroup by channel_id", "relation_name": "MARKETING.marketing.fct_channel_spend_efficiency", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-15T09:32:05.881069Z", "completed_at": "2025-04-15T09:32:05.885069Z"}, {"name": "execute", "started_at": "2025-04-15T09:32:05.885069Z", "completed_at": "2025-04-15T09:32:05.885069Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004961252212524414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Marketing.fct_monthly_spend_by_channel", "compiled": true, "compiled_code": "with spend as (\n    select\n        c.channel_id,\n        to_char(s.spend_date, 'YYYY-MM') as month,\n        sum(s.spend_amount) as total_spend\n    from MARKETING.marketing.stg_spend s\n    left join MARKETING.marketing.stg_campaigns c\n        on s.campaign_id = c.campaign_id\n    group by c.channel_id, to_char(s.spend_date, 'YYYY-MM')\n)\n\nselect * from spend", "relation_name": "MARKETING.marketing.fct_monthly_spend_by_channel", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-15T09:32:05.887157Z", "completed_at": "2025-04-15T09:32:05.891133Z"}, {"name": "execute", "started_at": "2025-04-15T09:32:05.893140Z", "completed_at": "2025-04-15T09:32:05.893140Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0059833526611328125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Marketing.int_campaign_performance", "compiled": true, "compiled_code": "with spend as (\n    select\n        campaign_id,\n        sum(spend_amount) as total_spend\n    from MARKETING.marketing.stg_spend\n    group by campaign_id\n),\n\nleads as (\n    select\n        campaign_id,\n        count(*) as total_leads,\n        count_if(is_converted) as converted_leads\n    from MARKETING.marketing.stg_leads\n    group by campaign_id\n)\n\nselect\n    c.campaign_id,\n    c.campaign_name,\n    c.channel_id,\n    c.start_date,\n    c.end_date,\n    s.total_spend,\n    l.total_leads,\n    l.converted_leads\nfrom MARKETING.marketing.stg_campaigns c\nleft join spend s on c.campaign_id = s.campaign_id\nleft join leads l on c.campaign_id = l.campaign_id", "relation_name": "MARKETING.marketing.int_campaign_performance", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-15T09:32:05.895789Z", "completed_at": "2025-04-15T09:32:05.899829Z"}, {"name": "execute", "started_at": "2025-04-15T09:32:05.899829Z", "completed_at": "2025-04-15T09:32:05.899829Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006688833236694336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Marketing.int_channel_spend", "compiled": true, "compiled_code": "with spend_with_channel as (\n    select\n        s.spend_id,\n        c.channel_id,\n        s.spend_amount\n    from MARKETING.marketing.stg_spend s\n    left join MARKETING.marketing.stg_campaigns c\n        on s.campaign_id = c.campaign_id\n)\n\nselect\n    channel_id,\n    sum(spend_amount) as total_channel_spend\nfrom spend_with_channel\ngroup by channel_id", "relation_name": "MARKETING.marketing.int_channel_spend", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-15T09:32:05.901832Z", "completed_at": "2025-04-15T09:32:05.901832Z"}, {"name": "execute", "started_at": "2025-04-15T09:32:05.901832Z", "completed_at": "2025-04-15T09:32:05.901832Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Marketing.fct_channel_conversion_rate", "compiled": true, "compiled_code": "with conversions as (\n    select * from MARKETING.marketing.int_lead_conversion\n)\n\nselect\n    channel_id,\n    total_leads,\n    converted_leads,\n    round(converted_leads * 1.0 / nullif(total_leads, 0), 2) as conversion_rate\nfrom conversions\norder by conversion_rate desc", "relation_name": "MARKETING.marketing.fct_channel_conversion_rate", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-15T09:32:05.901832Z", "completed_at": "2025-04-15T09:32:05.913514Z"}, {"name": "execute", "started_at": "2025-04-15T09:32:05.914481Z", "completed_at": "2025-04-15T09:32:05.914481Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012649059295654297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Marketing.fct_campaign_duration_cost", "compiled": true, "compiled_code": "with performance as (\n    select * from MARKETING.marketing.int_campaign_performance\n)\n\nselect\n    campaign_id,\n    campaign_name,\n    start_date,\n    end_date,\n    datediff('day', start_date, end_date) + 1 as duration_days,\n    total_spend,\n    round(total_spend / nullif(datediff('day', start_date, end_date) + 1, 0), 2) as cost_per_day\nfrom performance", "relation_name": "MARKETING.marketing.fct_campaign_duration_cost", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-15T09:32:05.916488Z", "completed_at": "2025-04-15T09:32:05.918488Z"}, {"name": "execute", "started_at": "2025-04-15T09:32:05.918488Z", "completed_at": "2025-04-15T09:32:05.918488Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0030002593994140625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.Marketing.fct_campaign_roi", "compiled": true, "compiled_code": "-- models/final/fct_campaign_roi.sql\n\nwith revenue as (\n    select\n        campaign_id,\n        sum(revenue_amount) as total_revenue\n    from MARKETING.marketing.stg_revenue\n    group by campaign_id\n),\n\nperformance as (\n    select *\n    from MARKETING.marketing.int_campaign_performance\n)\n\nselect\n    p.campaign_id,\n    p.campaign_name,\n    p.total_spend,\n    r.total_revenue,\n    (r.total_revenue - p.total_spend) / nullif(p.total_spend, 0) as roi\nfrom performance p\nleft join revenue r on p.campaign_id = r.campaign_id", "relation_name": "MARKETING.marketing.fct_campaign_roi", "batch_results": null}], "elapsed_time": 7.867633581161499, "args": {"send_anonymous_usage_stats": true, "require_batched_execution_for_custom_microbatch_strategy": false, "select": [], "compile": true, "require_yaml_configuration_for_mf_time_spines": false, "source_freshness_run_project_hooks": false, "static_parser": true, "use_colors": true, "print": true, "favor_state": false, "exclude": [], "cache_selected_only": false, "require_resource_names_without_spaces": false, "log_level": "info", "write_json": true, "macro_debugging": false, "skip_nodes_if_on_run_start_fails": false, "show_resource_report": false, "log_path": "C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs", "warn_error_options": {"include": [], "exclude": []}, "use_colors_file": true, "require_explicit_package_overrides_for_builtin_materializations": true, "log_format": "default", "state_modified_compare_more_unrendered_values": false, "indirect_selection": "eager", "log_format_file": "debug", "introspect": true, "profiles_dir": "C:\\Users\\RajgokulRM\\.dbt", "which": "generate", "empty_catalog": false, "defer": false, "partial_parse_file_diff": true, "invocation_command": "dbt docs generate", "strict_mode": false, "project_dir": "C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing", "quiet": false, "log_file_max_bytes": 10485760, "populate_cache": true, "printer_width": 80, "require_nested_cumulative_type_params": false, "state_modified_compare_vars": false, "static": false, "version_check": true, "vars": {}, "log_level_file": "debug", "partial_parse": true}}