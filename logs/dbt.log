[0m15:44:43.852347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE4957BBF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE4C0ED2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE4C0EE4E0>]}


============================== 15:44:43.857104 | 6533dc27-f67a-47d4-a957-8d32b508b61b ==============================
[0m15:44:43.857104 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:44:43.857635 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\RAJGOKUL R M\\.dbt', 'log_path': 'C:\\Users\\RAJGOKUL R M\\Documents\\DE_FINAL\\marketing\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'send_anonymous_usage_stats': 'True'}
[0m15:44:44.330296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6533dc27-f67a-47d4-a957-8d32b508b61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE4E028E60>]}
[0m15:44:44.389297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6533dc27-f67a-47d4-a957-8d32b508b61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE49EDF1A0>]}
[0m15:44:44.391296 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:44:44.664183 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:44:44.665182 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:44:44.666184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6533dc27-f67a-47d4-a957-8d32b508b61b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE4E41C530>]}
[0m15:44:47.066146 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two sources with the name "marketing_raw_campaigns".
  
  Since these resources have the same name, dbt will be unable to find the correct resource
  when looking for source("marketing", "raw_campaigns").
  
  To fix this, change the name of one of these resources:
  - source.Marketing.marketing.raw_campaigns (models\staging\schema.yml)
  - source.Marketing.marketing.raw_campaigns (models\schema.yml)
[0m15:44:47.068148 [debug] [MainThread]: Command `dbt run` failed at 15:44:47.068148 after 3.35 seconds
[0m15:44:47.069238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE4B7C7440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE4E8AEED0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE4E8AE2A0>]}
[0m15:44:47.069238 [debug] [MainThread]: Flushing usage events
[0m15:44:48.718342 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:46:18.849460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232919637A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023294063050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023294442DE0>]}


============================== 15:46:18.855342 | dc3828f0-4a91-4887-86c5-29930f5f143a ==============================
[0m15:46:18.855342 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:46:18.856348 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\RAJGOKUL R M\\Documents\\DE_FINAL\\marketing\\logs', 'profiles_dir': 'C:\\Users\\RAJGOKUL R M\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select staging', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:46:19.301346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc3828f0-4a91-4887-86c5-29930f5f143a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232966C9EB0>]}
[0m15:46:19.362344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc3828f0-4a91-4887-86c5-29930f5f143a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023294211A60>]}
[0m15:46:19.363347 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:46:19.596392 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:46:19.597393 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m15:46:19.598393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'dc3828f0-4a91-4887-86c5-29930f5f143a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000232965D7BF0>]}
[0m15:46:20.989631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc3828f0-4a91-4887-86c5-29930f5f143a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023296D8FC80>]}
[0m15:46:21.070019 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m15:46:21.075309 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m15:46:21.100681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc3828f0-4a91-4887-86c5-29930f5f143a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023296DADC40>]}
[0m15:46:21.100681 [info ] [MainThread]: Found 8 models, 6 data tests, 5 sources, 479 macros
[0m15:46:21.101750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc3828f0-4a91-4887-86c5-29930f5f143a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023296AFBA10>]}
[0m15:46:21.104118 [info ] [MainThread]: 
[0m15:46:21.104118 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:46:21.105139 [info ] [MainThread]: 
[0m15:46:21.106133 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:46:21.110129 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m15:46:23.148663 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m15:46:23.148663 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m15:46:23.149662 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:37.199261 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m15:46:37.200261 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:46:37.200261 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m15:46:37.201263 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m15:46:37.201263 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:37.201263 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m15:46:37.202507 [debug] [MainThread]: On list_MARKETING: No close available on handle
[0m15:46:37.202507 [info ] [MainThread]: 
[0m15:46:37.203517 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 16.10 seconds (16.10s).
[0m15:46:37.204610 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "MARKETING"
  Database Error
    250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting
    Verify that the hostnames and port numbers in SYSTEM$ALLOWLIST are added to your firewall's allowed list.
    To further troubleshoot your connection you may reference the following article: https://docs.snowflake.com/en/user-guide/client-connectivity-troubleshooting/overview.
[0m15:46:37.204610 [debug] [MainThread]: Command `dbt run` failed at 15:46:37.204610 after 18.47 seconds
[0m15:46:37.205994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002329498BB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002329246E0C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023296D07200>]}
[0m15:46:37.205994 [debug] [MainThread]: Flushing usage events
[0m15:46:39.402782 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:48:37.474897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020890CD77A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002088AC94EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020890CD6630>]}


============================== 15:48:37.481328 | fd562520-29db-4e95-8455-24f8fc810c69 ==============================
[0m15:48:37.481328 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:48:37.482328 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RAJGOKUL R M\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\RAJGOKUL R M\\Documents\\DE_FINAL\\marketing\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:48:37.903552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd562520-29db-4e95-8455-24f8fc810c69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020892DF9C10>]}
[0m15:48:37.965070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd562520-29db-4e95-8455-24f8fc810c69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208912C9AC0>]}
[0m15:48:37.966074 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:48:38.211490 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:48:38.328560 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m15:48:38.328560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'fd562520-29db-4e95-8455-24f8fc810c69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020891188050>]}
[0m15:48:39.731035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd562520-29db-4e95-8455-24f8fc810c69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208934B43B0>]}
[0m15:48:39.806468 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m15:48:39.810483 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m15:48:39.834139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd562520-29db-4e95-8455-24f8fc810c69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000208935223C0>]}
[0m15:48:39.835140 [info ] [MainThread]: Found 8 models, 6 data tests, 5 sources, 479 macros
[0m15:48:39.835140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd562520-29db-4e95-8455-24f8fc810c69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020893446270>]}
[0m15:48:39.837669 [info ] [MainThread]: 
[0m15:48:39.837669 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:48:39.838675 [info ] [MainThread]: 
[0m15:48:39.839670 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:48:39.843751 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m15:48:39.918322 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m15:48:39.919321 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m15:48:39.919321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:44.217425 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 4.298 seconds
[0m15:48:44.220281 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MARKETING, now create_MARKETING_marketing)
[0m15:48:44.220281 [debug] [ThreadPool]: Creating schema "database: "MARKETING"
schema: "marketing"
"
[0m15:48:44.226153 [debug] [ThreadPool]: Using snowflake connection "create_MARKETING_marketing"
[0m15:48:44.226153 [debug] [ThreadPool]: On create_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "create_MARKETING_marketing"} */
create schema if not exists MARKETING.marketing
[0m15:48:44.383470 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.157 seconds
[0m15:48:44.386461 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m15:48:44.399198 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m15:48:44.399198 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m15:48:44.400200 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:45.648726 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.249 seconds
[0m15:48:45.651724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd562520-29db-4e95-8455-24f8fc810c69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020892E6E540>]}
[0m15:48:45.657611 [debug] [Thread-1 (]: Began running node model.Marketing.stg_campaigns
[0m15:48:45.657611 [info ] [Thread-1 (]: 1 of 5 START sql view model marketing.stg_campaigns ............................ [RUN]
[0m15:48:45.658667 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.stg_campaigns'
[0m15:48:45.658667 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_campaigns
[0m15:48:45.667316 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_campaigns"
[0m15:48:45.669322 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_campaigns
[0m15:48:45.707432 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_campaigns"
[0m15:48:45.710433 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_campaigns"
[0m15:48:45.711431 [debug] [Thread-1 (]: On model.Marketing.stg_campaigns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_campaigns"} */
create or replace   view MARKETING.marketing.stg_campaigns
  
   as (
    with source as (
    select * from MARKETING.raw.raw_campaigns
),

cleaned as (
    select
        campaign_id,
        
    lower(trim(nullif(campaign_name, '')))
 as campaign_name,
        upper(
    lower(trim(nullif(channel_id, '')))
) as channel_id,
        
    try_to_date(start_date, 'DD/MM/YYYY')
 as start_date,
        
    try_to_date(end_date, 'DD-MM-YYYY')
 as end_date,
        
    case
        when title = 'lower' then lower(trim(nullif(status, '')))
        when title = 'upper' then upper(trim(nullif(status, '')))
        when title = 'title' then initcap(trim(nullif(status, '')))
        else status
    end
 as status,
        
    lower(trim(nullif(owner, '')))
 as owner,
        split(tags, ',') as tag_list
    from source
)

select * from cleaned
  );
[0m15:48:45.712431 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:48:47.051109 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbae6a-3201-8af3-0000-000cd70a9271
[0m15:48:47.051628 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 25 at position 13
invalid identifier 'TITLE'
[0m15:48:47.066250 [debug] [Thread-1 (]: Database Error in model stg_campaigns (models\staging\stg_campaigns.sql)
  000904 (42000): SQL compilation error: error line 25 at position 13
  invalid identifier 'TITLE'
  compiled code at target\run\Marketing\models\staging\stg_campaigns.sql
[0m15:48:47.068851 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd562520-29db-4e95-8455-24f8fc810c69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002089061FCB0>]}
[0m15:48:47.069386 [error] [Thread-1 (]: 1 of 5 ERROR creating sql view model marketing.stg_campaigns ................... [[31mERROR[0m in 1.41s]
[0m15:48:47.070449 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_campaigns
[0m15:48:47.070962 [debug] [Thread-1 (]: Began running node model.Marketing.stg_channels
[0m15:48:47.071489 [debug] [Thread-4 (]: Marking all children of 'model.Marketing.stg_campaigns' to be skipped because of status 'error'.  Reason: Database Error in model stg_campaigns (models\staging\stg_campaigns.sql)
  000904 (42000): SQL compilation error: error line 25 at position 13
  invalid identifier 'TITLE'
  compiled code at target\run\Marketing\models\staging\stg_campaigns.sql.
[0m15:48:47.072021 [info ] [Thread-1 (]: 2 of 5 START sql view model marketing.stg_channels ............................. [RUN]
[0m15:48:47.073587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_campaigns, now model.Marketing.stg_channels)
[0m15:48:47.074118 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_channels
[0m15:48:47.078343 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_channels"
[0m15:48:47.079405 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_channels
[0m15:48:47.082553 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_channels"
[0m15:48:47.085166 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_channels"
[0m15:48:47.085702 [debug] [Thread-1 (]: On model.Marketing.stg_channels: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_channels"} */
create or replace   view MARKETING.marketing.stg_channels
  
   as (
    with source as (
    select * from MARKETING.raw.raw_channels
),

cleaned as (
    select
        channel_id,
        
    case
        when title = 'lower' then lower(trim(nullif(channel_name, '')))
        when title = 'upper' then upper(trim(nullif(channel_name, '')))
        when title = 'title' then initcap(trim(nullif(channel_name, '')))
        else channel_name
    end
 as channel_name,
        
    case
        when lower = 'lower' then lower(trim(nullif(channel_type, '')))
        when lower = 'upper' then upper(trim(nullif(channel_type, '')))
        when lower = 'title' then initcap(trim(nullif(channel_type, '')))
        else channel_type
    end
 as channel_type,
        
    case
        when title = 'lower' then lower(trim(nullif(region, '')))
        when title = 'upper' then upper(trim(nullif(region, '')))
        when title = 'title' then initcap(trim(nullif(region, '')))
        else region
    end
 as region,
        
    nullif(
        case 
            when lower(description) in ('', 'n/a', 'none', 'null', '-') then null 
            else description
        end,
        ''
    )
 as description
    from source
)

select * from cleaned
  );
[0m15:48:47.221208 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbae6a-3201-8ade-0000-000cd70a82a5
[0m15:48:47.222208 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 13 at position 13
invalid identifier 'TITLE'
[0m15:48:47.226080 [debug] [Thread-1 (]: Database Error in model stg_channels (models\staging\stg_channels.sql)
  000904 (42000): SQL compilation error: error line 13 at position 13
  invalid identifier 'TITLE'
  compiled code at target\run\Marketing\models\staging\stg_channels.sql
[0m15:48:47.226080 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd562520-29db-4e95-8455-24f8fc810c69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020893CAAE10>]}
[0m15:48:47.227066 [error] [Thread-1 (]: 2 of 5 ERROR creating sql view model marketing.stg_channels .................... [[31mERROR[0m in 0.15s]
[0m15:48:47.228062 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_channels
[0m15:48:47.229403 [debug] [Thread-1 (]: Began running node model.Marketing.stg_leads
[0m15:48:47.229908 [debug] [Thread-4 (]: Marking all children of 'model.Marketing.stg_channels' to be skipped because of status 'error'.  Reason: Database Error in model stg_channels (models\staging\stg_channels.sql)
  000904 (42000): SQL compilation error: error line 13 at position 13
  invalid identifier 'TITLE'
  compiled code at target\run\Marketing\models\staging\stg_channels.sql.
[0m15:48:47.230619 [info ] [Thread-1 (]: 3 of 5 START sql view model marketing.stg_leads ................................ [RUN]
[0m15:48:47.231637 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_channels, now model.Marketing.stg_leads)
[0m15:48:47.231637 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_leads
[0m15:48:47.239002 [debug] [Thread-1 (]: Compilation Error in model stg_leads (models\staging\stg_leads.sql)
  'lower' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:48:47.239002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd562520-29db-4e95-8455-24f8fc810c69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020893CB5550>]}
[0m15:48:47.240006 [error] [Thread-1 (]: 3 of 5 ERROR creating sql view model marketing.stg_leads ....................... [[31mERROR[0m in 0.01s]
[0m15:48:47.240006 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_leads
[0m15:48:47.241005 [debug] [Thread-1 (]: Began running node model.Marketing.stg_revenue
[0m15:48:47.241005 [debug] [Thread-4 (]: Marking all children of 'model.Marketing.stg_leads' to be skipped because of status 'error'.  Reason: Compilation Error in model stg_leads (models\staging\stg_leads.sql)
  'lower' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m15:48:47.242254 [info ] [Thread-1 (]: 4 of 5 START sql view model marketing.stg_revenue .............................. [RUN]
[0m15:48:47.243262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_leads, now model.Marketing.stg_revenue)
[0m15:48:47.243262 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_revenue
[0m15:48:47.246465 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_revenue"
[0m15:48:47.248469 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_revenue
[0m15:48:47.250537 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_revenue"
[0m15:48:47.252993 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_revenue"
[0m15:48:47.252993 [debug] [Thread-1 (]: On model.Marketing.stg_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_revenue"} */
create or replace   view MARKETING.marketing.stg_revenue
  
   as (
    with source as (
    select * from MARKETING.raw.raw_revenue
),

cleaned as (
    select
        lead_id,
        campaign_id,
        
    case
        when lower = 'lower' then lower(trim(nullif(lead_source, '')))
        when lower = 'upper' then upper(trim(nullif(lead_source, '')))
        when lower = 'title' then initcap(trim(nullif(lead_source, '')))
        else lead_source
    end
 as lead_source,
        
    case 
        when lower(converted) in ('1', 'true', 'yes') then true
        when lower(converted) in ('0', 'false', 'no') then false
        else null
    end
 as is_converted,
        revenue,
        cast(revenue_date as date) as revenue_date
    from source
)

select * from cleaned
  );
[0m15:48:47.420271 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbae6a-3201-8b94-0000-000cd70ae01d
[0m15:48:47.421270 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 14 at position 13
invalid identifier 'LOWER'
[0m15:48:47.425270 [debug] [Thread-1 (]: Database Error in model stg_revenue (models\staging\stg_revenue.sql)
  000904 (42000): SQL compilation error: error line 14 at position 13
  invalid identifier 'LOWER'
  compiled code at target\run\Marketing\models\staging\stg_revenue.sql
[0m15:48:47.425270 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd562520-29db-4e95-8455-24f8fc810c69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020893CF84A0>]}
[0m15:48:47.426272 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model marketing.stg_revenue ..................... [[31mERROR[0m in 0.18s]
[0m15:48:47.427528 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_revenue
[0m15:48:47.427528 [debug] [Thread-1 (]: Began running node model.Marketing.stg_spend
[0m15:48:47.428539 [debug] [Thread-4 (]: Marking all children of 'model.Marketing.stg_revenue' to be skipped because of status 'error'.  Reason: Database Error in model stg_revenue (models\staging\stg_revenue.sql)
  000904 (42000): SQL compilation error: error line 14 at position 13
  invalid identifier 'LOWER'
  compiled code at target\run\Marketing\models\staging\stg_revenue.sql.
[0m15:48:47.428539 [info ] [Thread-1 (]: 5 of 5 START sql view model marketing.stg_spend ................................ [RUN]
[0m15:48:47.430012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_revenue, now model.Marketing.stg_spend)
[0m15:48:47.431236 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_spend
[0m15:48:47.434318 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_spend"
[0m15:48:47.435318 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_spend
[0m15:48:47.437833 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_spend"
[0m15:48:47.438838 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_spend"
[0m15:48:47.439992 [debug] [Thread-1 (]: On model.Marketing.stg_spend: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_spend"} */
create or replace   view MARKETING.marketing.stg_spend
  
   as (
    with source as (
    select * from MARKETING.raw.raw_spend
),

cleaned as (
    select
        spend_id,
        campaign_id,
        
    try_to_date(spend_date, 'DD/MM/YYYY')
 as spend_date,
        try_to_number(replace(spend_amount, '$', '')) as spend_amount,
        lower(currency) as currency,
        
    nullif(
        case 
            when lower(notes) in ('', 'n/a', 'none', 'null', '-') then null 
            else notes
        end,
        ''
    )
 as notes
    from source
)

select * from cleaned
  );
[0m15:48:47.740662 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.300 seconds
[0m15:48:47.762662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd562520-29db-4e95-8455-24f8fc810c69', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020893BC7440>]}
[0m15:48:47.763662 [info ] [Thread-1 (]: 5 of 5 OK created sql view model marketing.stg_spend ........................... [[32mSUCCESS 1[0m in 0.33s]
[0m15:48:47.764661 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_spend
[0m15:48:47.765846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:47.766877 [debug] [MainThread]: Connection 'create_MARKETING_marketing' was left open.
[0m15:48:47.766877 [debug] [MainThread]: On create_MARKETING_marketing: Close
[0m15:48:47.983099 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m15:48:47.984104 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m15:48:48.194134 [debug] [MainThread]: Connection 'model.Marketing.stg_spend' was left open.
[0m15:48:48.195126 [debug] [MainThread]: On model.Marketing.stg_spend: Close
[0m15:48:48.398256 [info ] [MainThread]: 
[0m15:48:48.399360 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 8.56 seconds (8.56s).
[0m15:48:48.401393 [debug] [MainThread]: Command end result
[0m15:48:48.425988 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m15:48:48.427986 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m15:48:48.434159 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\run_results.json
[0m15:48:48.434159 [info ] [MainThread]: 
[0m15:48:48.435159 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m15:48:48.435159 [info ] [MainThread]: 
[0m15:48:48.436156 [error] [MainThread]:   Database Error in model stg_campaigns (models\staging\stg_campaigns.sql)
  000904 (42000): SQL compilation error: error line 25 at position 13
  invalid identifier 'TITLE'
  compiled code at target\run\Marketing\models\staging\stg_campaigns.sql
[0m15:48:48.436156 [info ] [MainThread]: 
[0m15:48:48.437164 [error] [MainThread]:   Database Error in model stg_channels (models\staging\stg_channels.sql)
  000904 (42000): SQL compilation error: error line 13 at position 13
  invalid identifier 'TITLE'
  compiled code at target\run\Marketing\models\staging\stg_channels.sql
[0m15:48:48.437164 [info ] [MainThread]: 
[0m15:48:48.438323 [error] [MainThread]:   Compilation Error in model stg_leads (models\staging\stg_leads.sql)
  'lower' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:48:48.438323 [info ] [MainThread]: 
[0m15:48:48.439425 [error] [MainThread]:   Database Error in model stg_revenue (models\staging\stg_revenue.sql)
  000904 (42000): SQL compilation error: error line 14 at position 13
  invalid identifier 'LOWER'
  compiled code at target\run\Marketing\models\staging\stg_revenue.sql
[0m15:48:48.439425 [info ] [MainThread]: 
[0m15:48:48.440518 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=4 SKIP=0 TOTAL=5
[0m15:48:48.441687 [debug] [MainThread]: Command `dbt run` failed at 15:48:48.441687 after 11.08 seconds
[0m15:48:48.442192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002089320BCE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020892F413A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002089061C830>]}
[0m15:48:48.442192 [debug] [MainThread]: Flushing usage events
[0m15:48:52.039131 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:52:48.846099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF872E9AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF8B112540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF8B0BF500>]}


============================== 15:52:48.850152 | 9dbc453a-7fa3-40f5-ae88-1176794ecd34 ==============================
[0m15:52:48.850152 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:52:48.851150 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\RAJGOKUL R M\\.dbt', 'log_path': 'C:\\Users\\RAJGOKUL R M\\Documents\\DE_FINAL\\marketing\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select staging', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:52:49.269152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9dbc453a-7fa3-40f5-ae88-1176794ecd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF8B6AC2C0>]}
[0m15:52:49.328029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9dbc453a-7fa3-40f5-ae88-1176794ecd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF8AD7EC00>]}
[0m15:52:49.330025 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:52:49.559612 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:52:49.739165 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:52:49.741171 [debug] [MainThread]: Partial parsing: updated file: Marketing://macros\clean_utils.sql
[0m15:52:49.741171 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_leads.sql
[0m15:52:50.264688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9dbc453a-7fa3-40f5-ae88-1176794ecd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF8D67E300>]}
[0m15:52:50.341688 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m15:52:50.345688 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m15:52:50.368983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9dbc453a-7fa3-40f5-ae88-1176794ecd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF8D6F9340>]}
[0m15:52:50.368983 [info ] [MainThread]: Found 8 models, 6 data tests, 5 sources, 479 macros
[0m15:52:50.370350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dbc453a-7fa3-40f5-ae88-1176794ecd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF8D66A750>]}
[0m15:52:50.372603 [info ] [MainThread]: 
[0m15:52:50.372603 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:52:50.373601 [info ] [MainThread]: 
[0m15:52:50.374602 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:52:50.378611 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m15:52:50.455750 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m15:52:50.456751 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m15:52:50.456751 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:51.881983 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.425 seconds
[0m15:52:51.885957 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m15:52:51.896187 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m15:52:51.897187 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m15:52:51.897187 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:52.916679 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.020 seconds
[0m15:52:52.920167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9dbc453a-7fa3-40f5-ae88-1176794ecd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF8D668CE0>]}
[0m15:52:52.923176 [debug] [Thread-1 (]: Began running node model.Marketing.stg_campaigns
[0m15:52:52.924180 [info ] [Thread-1 (]: 1 of 5 START sql view model marketing.stg_campaigns ............................ [RUN]
[0m15:52:52.925177 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.stg_campaigns'
[0m15:52:52.926176 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_campaigns
[0m15:52:52.935173 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_campaigns"
[0m15:52:52.936175 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_campaigns
[0m15:52:52.964198 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_campaigns"
[0m15:52:52.966201 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_campaigns"
[0m15:52:52.966201 [debug] [Thread-1 (]: On model.Marketing.stg_campaigns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_campaigns"} */
create or replace   view MARKETING.marketing.stg_campaigns
  
   as (
    with source as (
    select * from MARKETING.raw.raw_campaigns
),

cleaned as (
    select
        campaign_id,
        
    lower(trim(nullif(campaign_name, '')))
 as campaign_name,
        upper(
    lower(trim(nullif(channel_id, '')))
) as channel_id,
        
    try_to_date(start_date, 'DD/MM/YYYY')
 as start_date,
        
    try_to_date(end_date, 'DD-MM-YYYY')
 as end_date,
        initcap(trim(nullif(status, ''))) as status,
        
    lower(trim(nullif(owner, '')))
 as owner,
        split(tags, ',') as tag_list
    from source
)

select * from cleaned
  );
[0m15:52:52.967199 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:52:54.312067 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.345 seconds
[0m15:52:54.336049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dbc453a-7fa3-40f5-ae88-1176794ecd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF8850BC50>]}
[0m15:52:54.336049 [info ] [Thread-1 (]: 1 of 5 OK created sql view model marketing.stg_campaigns ....................... [[32mSUCCESS 1[0m in 1.41s]
[0m15:52:54.337294 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_campaigns
[0m15:52:54.338636 [debug] [Thread-1 (]: Began running node model.Marketing.stg_channels
[0m15:52:54.338636 [info ] [Thread-1 (]: 2 of 5 START sql view model marketing.stg_channels ............................. [RUN]
[0m15:52:54.339642 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_campaigns, now model.Marketing.stg_channels)
[0m15:52:54.340663 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_channels
[0m15:52:54.344064 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_channels"
[0m15:52:54.345066 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_channels
[0m15:52:54.349210 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_channels"
[0m15:52:54.351211 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_channels"
[0m15:52:54.351211 [debug] [Thread-1 (]: On model.Marketing.stg_channels: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_channels"} */
create or replace   view MARKETING.marketing.stg_channels
  
   as (
    with source as (
    select * from MARKETING.raw.raw_channels
),

cleaned as (
    select
        channel_id,
        initcap(trim(nullif(channel_name, ''))) as channel_name,
        lower(trim(nullif(channel_type, ''))) as channel_type,
        initcap(trim(nullif(region, ''))) as region,
        
    nullif(
        case 
            when lower(description) in ('', 'n/a', 'none', 'null', '-') then null 
            else description
        end,
        ''
    )
 as description
    from source
)

select * from cleaned
  );
[0m15:52:54.639188 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.287 seconds
[0m15:52:54.642203 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dbc453a-7fa3-40f5-ae88-1176794ecd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF8DB9EC00>]}
[0m15:52:54.643203 [info ] [Thread-1 (]: 2 of 5 OK created sql view model marketing.stg_channels ........................ [[32mSUCCESS 1[0m in 0.30s]
[0m15:52:54.644257 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_channels
[0m15:52:54.644257 [debug] [Thread-1 (]: Began running node model.Marketing.stg_leads
[0m15:52:54.645302 [info ] [Thread-1 (]: 3 of 5 START sql view model marketing.stg_leads ................................ [RUN]
[0m15:52:54.646322 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_channels, now model.Marketing.stg_leads)
[0m15:52:54.646322 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_leads
[0m15:52:54.651150 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_leads"
[0m15:52:54.652152 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_leads
[0m15:52:54.654691 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_leads"
[0m15:52:54.656699 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_leads"
[0m15:52:54.656699 [debug] [Thread-1 (]: On model.Marketing.stg_leads: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_leads"} */
create or replace   view MARKETING.marketing.stg_leads
  
   as (
    with source as (
    select * from MARKETING.raw.raw_leads
),

cleaned as (
    select
        lead_id,
        campaign_id,
        lower(trim(nullif(lead_source, ''))) as lead_source,
        
    case 
        when lower(converted) in ('1', 'true', 'yes') then true
        when lower(converted) in ('0', 'false', 'no') then false
        else null
    end
 as is_converted,
        initcap(trim(nullif(name, ''))) as name,
        lower(trim(nullif(email, ''))) as email,
        converted_date
    from source
)

select * from cleaned
  );
[0m15:52:54.951955 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.295 seconds
[0m15:52:54.954964 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dbc453a-7fa3-40f5-ae88-1176794ecd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF8DAF63C0>]}
[0m15:52:54.954964 [info ] [Thread-1 (]: 3 of 5 OK created sql view model marketing.stg_leads ........................... [[32mSUCCESS 1[0m in 0.31s]
[0m15:52:54.955965 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_leads
[0m15:52:54.957755 [debug] [Thread-1 (]: Began running node model.Marketing.stg_revenue
[0m15:52:54.957755 [info ] [Thread-1 (]: 4 of 5 START sql view model marketing.stg_revenue .............................. [RUN]
[0m15:52:54.958763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_leads, now model.Marketing.stg_revenue)
[0m15:52:54.959761 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_revenue
[0m15:52:54.963621 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_revenue"
[0m15:52:54.964621 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_revenue
[0m15:52:54.967464 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_revenue"
[0m15:52:54.969976 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_revenue"
[0m15:52:54.970480 [debug] [Thread-1 (]: On model.Marketing.stg_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_revenue"} */
create or replace   view MARKETING.marketing.stg_revenue
  
   as (
    with source as (
    select * from MARKETING.raw.raw_revenue
),

cleaned as (
    select
        lead_id,
        campaign_id,
        lower(trim(nullif(lead_source, ''))) as lead_source,
        
    case 
        when lower(converted) in ('1', 'true', 'yes') then true
        when lower(converted) in ('0', 'false', 'no') then false
        else null
    end
 as is_converted,
        revenue,
        cast(revenue_date as date) as revenue_date
    from source
)

select * from cleaned
  );
[0m15:52:55.272439 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.301 seconds
[0m15:52:55.274449 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dbc453a-7fa3-40f5-ae88-1176794ecd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF8DAF4410>]}
[0m15:52:55.275440 [info ] [Thread-1 (]: 4 of 5 OK created sql view model marketing.stg_revenue ......................... [[32mSUCCESS 1[0m in 0.32s]
[0m15:52:55.276427 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_revenue
[0m15:52:55.277853 [debug] [Thread-1 (]: Began running node model.Marketing.stg_spend
[0m15:52:55.277853 [info ] [Thread-1 (]: 5 of 5 START sql view model marketing.stg_spend ................................ [RUN]
[0m15:52:55.279346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_revenue, now model.Marketing.stg_spend)
[0m15:52:55.279346 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_spend
[0m15:52:55.282960 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_spend"
[0m15:52:55.283960 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_spend
[0m15:52:55.286960 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_spend"
[0m15:52:55.288751 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_spend"
[0m15:52:55.289964 [debug] [Thread-1 (]: On model.Marketing.stg_spend: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_spend"} */
create or replace   view MARKETING.marketing.stg_spend
  
   as (
    with source as (
    select * from MARKETING.raw.raw_spend
),

cleaned as (
    select
        spend_id,
        campaign_id,
        
    try_to_date(spend_date, 'DD/MM/YYYY')
 as spend_date,
        try_to_number(replace(spend_amount, '$', '')) as spend_amount,
        lower(currency) as currency,
        
    nullif(
        case 
            when lower(notes) in ('', 'n/a', 'none', 'null', '-') then null 
            else notes
        end,
        ''
    )
 as notes
    from source
)

select * from cleaned
  );
[0m15:52:55.520995 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.230 seconds
[0m15:52:55.525514 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dbc453a-7fa3-40f5-ae88-1176794ecd34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF8D6B3FE0>]}
[0m15:52:55.526514 [info ] [Thread-1 (]: 5 of 5 OK created sql view model marketing.stg_spend ........................... [[32mSUCCESS 1[0m in 0.25s]
[0m15:52:55.527512 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_spend
[0m15:52:55.528510 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:52:55.528510 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m15:52:55.528510 [debug] [MainThread]: On list_MARKETING: Close
[0m15:52:55.724591 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m15:52:55.725095 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m15:52:55.907418 [debug] [MainThread]: Connection 'model.Marketing.stg_spend' was left open.
[0m15:52:55.908415 [debug] [MainThread]: On model.Marketing.stg_spend: Close
[0m15:52:56.082140 [info ] [MainThread]: 
[0m15:52:56.083139 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.71 seconds (5.71s).
[0m15:52:56.085139 [debug] [MainThread]: Command end result
[0m15:52:56.108819 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m15:52:56.110913 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m15:52:56.117691 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\run_results.json
[0m15:52:56.117691 [info ] [MainThread]: 
[0m15:52:56.118745 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:52:56.118745 [info ] [MainThread]: 
[0m15:52:56.119750 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:52:56.120753 [debug] [MainThread]: Command `dbt run` succeeded at 15:52:56.120753 after 7.38 seconds
[0m15:52:56.120753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF872E9AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF8B1ECFE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AF8B1EDCD0>]}
[0m15:52:56.121751 [debug] [MainThread]: Flushing usage events
[0m15:53:00.636677 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:08:24.258519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BAB889AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BAC8E12B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BAF5DEB70>]}


============================== 16:08:24.264678 | d8d63923-c6cf-4d6b-aa4a-7a810a2a98fa ==============================
[0m16:08:24.264678 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:08:24.265679 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RAJGOKUL R M\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\RAJGOKUL R M\\Documents\\DE_FINAL\\marketing\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select staging', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:08:24.851404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8d63923-c6cf-4d6b-aa4a-7a810a2a98fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BAF6EF830>]}
[0m16:08:24.939629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8d63923-c6cf-4d6b-aa4a-7a810a2a98fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BAF7EF920>]}
[0m16:08:24.942106 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:08:25.258261 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:08:25.372484 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m16:08:25.373382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd8d63923-c6cf-4d6b-aa4a-7a810a2a98fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BAF526690>]}
[0m16:08:26.764015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8d63923-c6cf-4d6b-aa4a-7a810a2a98fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB1AD0DD0>]}
[0m16:08:26.865706 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m16:08:26.868714 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m16:08:26.892485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8d63923-c6cf-4d6b-aa4a-7a810a2a98fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB1DC1E80>]}
[0m16:08:26.893485 [info ] [MainThread]: Found 8 models, 6 data tests, 5 sources, 479 macros
[0m16:08:26.894487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8d63923-c6cf-4d6b-aa4a-7a810a2a98fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB1B26000>]}
[0m16:08:26.895486 [info ] [MainThread]: 
[0m16:08:26.896494 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:08:26.896494 [info ] [MainThread]: 
[0m16:08:26.897653 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:08:26.901877 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m16:08:26.974564 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m16:08:26.975564 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m16:08:26.975564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:31.081852 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 4.107 seconds
[0m16:08:31.086574 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m16:08:31.096590 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m16:08:31.097590 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m16:08:31.097590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:08:31.927340 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.829 seconds
[0m16:08:31.931659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8d63923-c6cf-4d6b-aa4a-7a810a2a98fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB1C09100>]}
[0m16:08:31.936981 [debug] [Thread-1 (]: Began running node model.Marketing.stg_campaigns
[0m16:08:31.937988 [info ] [Thread-1 (]: 1 of 5 START sql table model marketing.stg_campaigns ........................... [RUN]
[0m16:08:31.939085 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.stg_campaigns'
[0m16:08:31.939085 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_campaigns
[0m16:08:31.949032 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_campaigns"
[0m16:08:31.950032 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_campaigns
[0m16:08:31.970029 [debug] [Thread-1 (]:  adapter: Dropping relation "MARKETING"."MARKETING"."STG_CAMPAIGNS" because it is a view and target relation MARKETING.marketing.stg_campaigns is of type table.
[0m16:08:31.977036 [debug] [Thread-1 (]: Applying DROP to: "MARKETING"."MARKETING"."STG_CAMPAIGNS"
[0m16:08:31.986321 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_campaigns"
[0m16:08:31.987329 [debug] [Thread-1 (]: On model.Marketing.stg_campaigns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_campaigns"} */
drop view if exists "MARKETING"."MARKETING"."STG_CAMPAIGNS" cascade
[0m16:08:31.987329 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:08:32.936366 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.948 seconds
[0m16:08:32.954407 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_campaigns"
[0m16:08:32.955407 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_campaigns"
[0m16:08:32.957275 [debug] [Thread-1 (]: On model.Marketing.stg_campaigns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_campaigns"} */
create or replace transient table MARKETING.marketing.stg_campaigns
         as
        (with source as (
    select * from MARKETING.raw.raw_campaigns
),

cleaned as (
    select
        campaign_id,
        
    lower(trim(nullif(campaign_name, '')))
 as campaign_name,
        upper(
    lower(trim(nullif(channel_id, '')))
) as channel_id,
        
    try_to_date(start_date, 'DD/MM/YYYY')
 as start_date,
        
    try_to_date(end_date, 'DD-MM-YYYY')
 as end_date,
        initcap(trim(nullif(status, ''))) as status,
        
    lower(trim(nullif(owner, '')))
 as owner,
        split(tags, ',') as tag_list
    from source
)

select * from cleaned
        );
[0m16:08:33.753609 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.796 seconds
[0m16:08:33.781522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d63923-c6cf-4d6b-aa4a-7a810a2a98fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BACAABB30>]}
[0m16:08:33.782031 [info ] [Thread-1 (]: 1 of 5 OK created sql table model marketing.stg_campaigns ...................... [[32mSUCCESS 1[0m in 1.84s]
[0m16:08:33.783038 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_campaigns
[0m16:08:33.784080 [debug] [Thread-1 (]: Began running node model.Marketing.stg_channels
[0m16:08:33.784080 [info ] [Thread-1 (]: 2 of 5 START sql table model marketing.stg_channels ............................ [RUN]
[0m16:08:33.785417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_campaigns, now model.Marketing.stg_channels)
[0m16:08:33.786506 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_channels
[0m16:08:33.789515 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_channels"
[0m16:08:33.791216 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_channels
[0m16:08:33.793226 [debug] [Thread-1 (]:  adapter: Dropping relation "MARKETING"."MARKETING"."STG_CHANNELS" because it is a view and target relation MARKETING.marketing.stg_channels is of type table.
[0m16:08:33.796225 [debug] [Thread-1 (]: Applying DROP to: "MARKETING"."MARKETING"."STG_CHANNELS"
[0m16:08:33.796225 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_channels"
[0m16:08:33.797636 [debug] [Thread-1 (]: On model.Marketing.stg_channels: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_channels"} */
drop view if exists "MARKETING"."MARKETING"."STG_CHANNELS" cascade
[0m16:08:33.958470 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.160 seconds
[0m16:08:33.960471 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_channels"
[0m16:08:33.962469 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_channels"
[0m16:08:33.963469 [debug] [Thread-1 (]: On model.Marketing.stg_channels: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_channels"} */
create or replace transient table MARKETING.marketing.stg_channels
         as
        (with source as (
    select * from MARKETING.raw.raw_channels
),

cleaned as (
    select
        channel_id,
        lower(trim(nullif(channel_name, ''))) as channel_name,
        lower(trim(nullif(channel_type, ''))) as channel_type,
        initcap(trim(nullif(region, ''))) as region,
        
    nullif(
        case 
            when lower(description) in ('', 'n/a', 'none', 'null', '-') then null 
            else description
        end,
        ''
    )
 as description
    from source
)

select * from cleaned
        );
[0m16:08:34.659426 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.696 seconds
[0m16:08:34.662439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d63923-c6cf-4d6b-aa4a-7a810a2a98fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB22D3FE0>]}
[0m16:08:34.663445 [info ] [Thread-1 (]: 2 of 5 OK created sql table model marketing.stg_channels ....................... [[32mSUCCESS 1[0m in 0.88s]
[0m16:08:34.664448 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_channels
[0m16:08:34.665446 [debug] [Thread-1 (]: Began running node model.Marketing.stg_leads
[0m16:08:34.666445 [info ] [Thread-1 (]: 3 of 5 START sql table model marketing.stg_leads ............................... [RUN]
[0m16:08:34.666949 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_channels, now model.Marketing.stg_leads)
[0m16:08:34.667955 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_leads
[0m16:08:34.671516 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_leads"
[0m16:08:34.672516 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_leads
[0m16:08:34.675978 [debug] [Thread-1 (]:  adapter: Dropping relation "MARKETING"."MARKETING"."STG_LEADS" because it is a view and target relation MARKETING.marketing.stg_leads is of type table.
[0m16:08:34.678981 [debug] [Thread-1 (]: Applying DROP to: "MARKETING"."MARKETING"."STG_LEADS"
[0m16:08:34.678981 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_leads"
[0m16:08:34.679985 [debug] [Thread-1 (]: On model.Marketing.stg_leads: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_leads"} */
drop view if exists "MARKETING"."MARKETING"."STG_LEADS" cascade
[0m16:08:34.982896 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.302 seconds
[0m16:08:34.985893 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_leads"
[0m16:08:34.987896 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_leads"
[0m16:08:34.988896 [debug] [Thread-1 (]: On model.Marketing.stg_leads: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_leads"} */
create or replace transient table MARKETING.marketing.stg_leads
         as
        (with source as (
    select * from MARKETING.raw.raw_leads
),

cleaned as (
    select
        lead_id,
        campaign_id,
        lower(trim(nullif(lead_source, ''))) as lead_source,
        
    case 
        when lower(converted) in ('1', 'true', 'yes') then true
        when lower(converted) in ('0', 'false', 'no') then false
        else null
    end
 as is_converted,
        initcap(trim(nullif(name, ''))) as name,
        lower(trim(nullif(email, ''))) as email,
        converted_date
    from source
)

select * from cleaned
        );
[0m16:08:35.725744 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.736 seconds
[0m16:08:35.728456 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d63923-c6cf-4d6b-aa4a-7a810a2a98fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB2408E00>]}
[0m16:08:35.728456 [info ] [Thread-1 (]: 3 of 5 OK created sql table model marketing.stg_leads .......................... [[32mSUCCESS 1[0m in 1.06s]
[0m16:08:35.730803 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_leads
[0m16:08:35.730803 [debug] [Thread-1 (]: Began running node model.Marketing.stg_revenue
[0m16:08:35.731846 [info ] [Thread-1 (]: 4 of 5 START sql table model marketing.stg_revenue ............................. [RUN]
[0m16:08:35.732860 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_leads, now model.Marketing.stg_revenue)
[0m16:08:35.732860 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_revenue
[0m16:08:35.736880 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_revenue"
[0m16:08:35.738877 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_revenue
[0m16:08:35.741150 [debug] [Thread-1 (]:  adapter: Dropping relation "MARKETING"."MARKETING"."STG_REVENUE" because it is a view and target relation MARKETING.marketing.stg_revenue is of type table.
[0m16:08:35.743406 [debug] [Thread-1 (]: Applying DROP to: "MARKETING"."MARKETING"."STG_REVENUE"
[0m16:08:35.744453 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_revenue"
[0m16:08:35.744453 [debug] [Thread-1 (]: On model.Marketing.stg_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_revenue"} */
drop view if exists "MARKETING"."MARKETING"."STG_REVENUE" cascade
[0m16:08:35.873061 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.128 seconds
[0m16:08:35.875321 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_revenue"
[0m16:08:35.877110 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_revenue"
[0m16:08:35.878121 [debug] [Thread-1 (]: On model.Marketing.stg_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_revenue"} */
create or replace transient table MARKETING.marketing.stg_revenue
         as
        (with source as (
    select * from MARKETING.raw.raw_revenue
),

cleaned as (
    select
        lead_id,
        campaign_id,
        lower(trim(nullif(lead_source, ''))) as lead_source,
        
    case 
        when lower(converted) in ('1', 'true', 'yes') then true
        when lower(converted) in ('0', 'false', 'no') then false
        else null
    end
 as is_converted,
        revenue,
        cast(revenue_date as date) as revenue_date
    from source
)

select * from cleaned
        );
[0m16:08:36.384754 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.506 seconds
[0m16:08:36.387123 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d63923-c6cf-4d6b-aa4a-7a810a2a98fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB23DA5A0>]}
[0m16:08:36.387123 [info ] [Thread-1 (]: 4 of 5 OK created sql table model marketing.stg_revenue ........................ [[32mSUCCESS 1[0m in 0.65s]
[0m16:08:36.388143 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_revenue
[0m16:08:36.389144 [debug] [Thread-1 (]: Began running node model.Marketing.stg_spend
[0m16:08:36.389144 [info ] [Thread-1 (]: 5 of 5 START sql table model marketing.stg_spend ............................... [RUN]
[0m16:08:36.390144 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_revenue, now model.Marketing.stg_spend)
[0m16:08:36.391144 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_spend
[0m16:08:36.393694 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_spend"
[0m16:08:36.394694 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_spend
[0m16:08:36.397622 [debug] [Thread-1 (]:  adapter: Dropping relation "MARKETING"."MARKETING"."STG_SPEND" because it is a view and target relation MARKETING.marketing.stg_spend is of type table.
[0m16:08:36.399460 [debug] [Thread-1 (]: Applying DROP to: "MARKETING"."MARKETING"."STG_SPEND"
[0m16:08:36.400464 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_spend"
[0m16:08:36.400464 [debug] [Thread-1 (]: On model.Marketing.stg_spend: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_spend"} */
drop view if exists "MARKETING"."MARKETING"."STG_SPEND" cascade
[0m16:08:36.538758 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.138 seconds
[0m16:08:36.540935 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_spend"
[0m16:08:36.542468 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_spend"
[0m16:08:36.543466 [debug] [Thread-1 (]: On model.Marketing.stg_spend: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_spend"} */
create or replace transient table MARKETING.marketing.stg_spend
         as
        (with source as (
    select * from MARKETING.raw.raw_spend
),

cleaned as (
    select
        spend_id,
        campaign_id,
        
    try_to_date(spend_date, 'DD/MM/YYYY')
 as spend_date,
        try_to_number(replace(spend_amount, '$', '')) as spend_amount,
        lower(currency) as currency,
        
    nullif(
        case 
            when lower(notes) in ('', 'n/a', 'none', 'null', '-') then null 
            else notes
        end,
        ''
    )
 as notes
    from source
)

select * from cleaned
        );
[0m16:08:37.050059 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.506 seconds
[0m16:08:37.052067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8d63923-c6cf-4d6b-aa4a-7a810a2a98fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB224B9E0>]}
[0m16:08:37.053067 [info ] [Thread-1 (]: 5 of 5 OK created sql table model marketing.stg_spend .......................... [[32mSUCCESS 1[0m in 0.66s]
[0m16:08:37.054065 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_spend
[0m16:08:37.055064 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:08:37.055064 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m16:08:37.056065 [debug] [MainThread]: On list_MARKETING: Close
[0m16:08:37.325020 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m16:08:37.326043 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m16:08:37.594815 [debug] [MainThread]: Connection 'model.Marketing.stg_spend' was left open.
[0m16:08:37.594815 [debug] [MainThread]: On model.Marketing.stg_spend: Close
[0m16:08:37.796998 [info ] [MainThread]: 
[0m16:08:37.797989 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 10.90 seconds (10.90s).
[0m16:08:37.799410 [debug] [MainThread]: Command end result
[0m16:08:37.897936 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m16:08:37.900928 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m16:08:37.908890 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\run_results.json
[0m16:08:37.909899 [info ] [MainThread]: 
[0m16:08:37.909899 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:08:37.910897 [info ] [MainThread]: 
[0m16:08:37.911895 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:08:37.912899 [debug] [MainThread]: Command `dbt run` succeeded at 16:08:37.912899 after 13.78 seconds
[0m16:08:37.913896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BACBD5B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BB2045850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021BAE938260>]}
[0m16:08:37.913896 [debug] [MainThread]: Flushing usage events
[0m16:08:41.328382 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:10:14.383045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260233E3650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260258C78C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260258C71D0>]}


============================== 16:10:14.388045 | 99d0bd83-b685-4319-8775-98eb6242d5ce ==============================
[0m16:10:14.388045 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:10:14.388045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\RAJGOKUL R M\\Documents\\DE_FINAL\\marketing\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\RAJGOKUL R M\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'send_anonymous_usage_stats': 'True'}
[0m16:10:14.793902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99d0bd83-b685-4319-8775-98eb6242d5ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260280C9910>]}
[0m16:10:14.852942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99d0bd83-b685-4319-8775-98eb6242d5ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026026437AD0>]}
[0m16:10:14.854945 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:10:15.099454 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:10:15.299974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m16:10:15.300974 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_channels.sql
[0m16:10:15.301974 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_spend.sql
[0m16:10:15.301974 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_campaigns.sql
[0m16:10:15.303122 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_revenue.sql
[0m16:10:15.303625 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_leads.sql
[0m16:10:15.808040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99d0bd83-b685-4319-8775-98eb6242d5ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260287512B0>]}
[0m16:10:15.885255 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m16:10:15.889254 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m16:10:15.913160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99d0bd83-b685-4319-8775-98eb6242d5ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026028748FE0>]}
[0m16:10:15.914268 [info ] [MainThread]: Found 8 models, 6 data tests, 5 sources, 479 macros
[0m16:10:15.914268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99d0bd83-b685-4319-8775-98eb6242d5ce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260287807D0>]}
[0m16:10:15.916617 [info ] [MainThread]: 
[0m16:10:15.917617 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:10:15.917617 [info ] [MainThread]: 
[0m16:10:15.918618 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:10:15.922660 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m16:10:15.996208 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m16:10:15.996712 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m16:10:15.996712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:17.434751 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m16:10:17.434751 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:10:17.435691 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m16:10:17.436711 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:10:17.436711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:17.438072 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m16:10:17.438072 [debug] [MainThread]: On list_MARKETING: No close available on handle
[0m16:10:17.439079 [info ] [MainThread]: 
[0m16:10:17.439079 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.52 seconds (1.52s).
[0m16:10:17.440080 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "MARKETING"
  Database Error
    250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting
[0m16:10:17.441083 [debug] [MainThread]: Command `dbt run` failed at 16:10:17.441083 after 3.17 seconds
[0m16:10:17.442079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000260259539E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026028651220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002602621E480>]}
[0m16:10:17.442079 [debug] [MainThread]: Flushing usage events
[0m16:10:19.391161 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:10:49.181962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001234DF6BD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001234E4E8D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001234E4EB590>]}


============================== 16:10:49.188056 | 77749ee0-8186-4dcd-8c4f-9c66efa88524 ==============================
[0m16:10:49.188056 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:10:49.189069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\RAJGOKUL R M\\Documents\\DE_FINAL\\marketing\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\RAJGOKUL R M\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select staging', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:10:49.616730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '77749ee0-8186-4dcd-8c4f-9c66efa88524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012352CF6030>]}
[0m16:10:49.675731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '77749ee0-8186-4dcd-8c4f-9c66efa88524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001235042D880>]}
[0m16:10:49.676731 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:10:49.939792 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:10:50.100609 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:10:50.100609 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:10:50.142787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '77749ee0-8186-4dcd-8c4f-9c66efa88524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012352D9E6F0>]}
[0m16:10:50.220338 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m16:10:50.223080 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m16:10:50.249415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '77749ee0-8186-4dcd-8c4f-9c66efa88524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012353135B50>]}
[0m16:10:50.249415 [info ] [MainThread]: Found 8 models, 6 data tests, 5 sources, 479 macros
[0m16:10:50.250504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77749ee0-8186-4dcd-8c4f-9c66efa88524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123530F4CB0>]}
[0m16:10:50.252512 [info ] [MainThread]: 
[0m16:10:50.253014 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:10:50.253014 [info ] [MainThread]: 
[0m16:10:50.254027 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:10:50.259019 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m16:10:50.332527 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m16:10:50.332527 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m16:10:50.333527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:51.841693 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.508 seconds
[0m16:10:51.844989 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m16:10:51.855011 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m16:10:51.855526 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m16:10:51.856045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:53.447814 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.591 seconds
[0m16:10:53.451372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '77749ee0-8186-4dcd-8c4f-9c66efa88524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012352C7E300>]}
[0m16:10:53.454933 [debug] [Thread-1 (]: Began running node model.Marketing.stg_campaigns
[0m16:10:53.455972 [info ] [Thread-1 (]: 1 of 5 START sql table model marketing.stg_campaigns ........................... [RUN]
[0m16:10:53.456979 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.stg_campaigns'
[0m16:10:53.456979 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_campaigns
[0m16:10:53.471979 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_campaigns"
[0m16:10:53.472978 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_campaigns
[0m16:10:53.503285 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_campaigns"
[0m16:10:53.505287 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_campaigns"
[0m16:10:53.506285 [debug] [Thread-1 (]: On model.Marketing.stg_campaigns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_campaigns"} */
create or replace transient table MARKETING.marketing.stg_campaigns
         as
        (with source as (
    select * from MARKETING.raw.raw_campaigns
),

cleaned as (
    select
        campaign_id,
        
    lower(trim(nullif(campaign_name, '')))
 as campaign_name,
        upper(
    lower(trim(nullif(channel_id, '')))
) as channel_id,
        
    try_to_date(start_date, 'DD/MM/YYYY')
 as start_date,
        
    try_to_date(end_date, 'DD-MM-YYYY')
 as end_date,
        initcap(trim(nullif(status, ''))) as status,
        
    lower(trim(nullif(owner, '')))
 as owner,
        split(tags, ',') as tag_list
    from source
)

select DISTINCT * from cleaned
        );
[0m16:10:53.506285 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:10:55.163937 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.657 seconds
[0m16:10:55.244430 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77749ee0-8186-4dcd-8c4f-9c66efa88524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012353052030>]}
[0m16:10:55.245432 [info ] [Thread-1 (]: 1 of 5 OK created sql table model marketing.stg_campaigns ...................... [[32mSUCCESS 1[0m in 1.79s]
[0m16:10:55.246431 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_campaigns
[0m16:10:55.247431 [debug] [Thread-1 (]: Began running node model.Marketing.stg_channels
[0m16:10:55.247431 [info ] [Thread-1 (]: 2 of 5 START sql table model marketing.stg_channels ............................ [RUN]
[0m16:10:55.248443 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_campaigns, now model.Marketing.stg_channels)
[0m16:10:55.248443 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_channels
[0m16:10:55.252436 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_channels"
[0m16:10:55.253436 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_channels
[0m16:10:55.256298 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_channels"
[0m16:10:55.258309 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_channels"
[0m16:10:55.258309 [debug] [Thread-1 (]: On model.Marketing.stg_channels: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_channels"} */
create or replace transient table MARKETING.marketing.stg_channels
         as
        (with source as (
    select * from MARKETING.raw.raw_channels
),

cleaned as (
    select
        channel_id,
        lower(trim(nullif(channel_name, ''))) as channel_name,
        lower(trim(nullif(channel_type, ''))) as channel_type,
        initcap(trim(nullif(region, ''))) as region,
        
    nullif(
        case 
            when lower(description) in ('', 'n/a', 'none', 'null', '-') then null 
            else description
        end,
        ''
    )
 as description
    from source
)

select DISTINCT * from cleaned
        );
[0m16:10:56.096817 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.838 seconds
[0m16:10:56.099467 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77749ee0-8186-4dcd-8c4f-9c66efa88524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123530533B0>]}
[0m16:10:56.100002 [info ] [Thread-1 (]: 2 of 5 OK created sql table model marketing.stg_channels ....................... [[32mSUCCESS 1[0m in 0.85s]
[0m16:10:56.101068 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_channels
[0m16:10:56.101636 [debug] [Thread-1 (]: Began running node model.Marketing.stg_leads
[0m16:10:56.102168 [info ] [Thread-1 (]: 3 of 5 START sql table model marketing.stg_leads ............................... [RUN]
[0m16:10:56.102700 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_channels, now model.Marketing.stg_leads)
[0m16:10:56.103225 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_leads
[0m16:10:56.107932 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_leads"
[0m16:10:56.108457 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_leads
[0m16:10:56.111117 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_leads"
[0m16:10:56.112778 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_leads"
[0m16:10:56.113282 [debug] [Thread-1 (]: On model.Marketing.stg_leads: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_leads"} */
create or replace transient table MARKETING.marketing.stg_leads
         as
        (with source as (
    select * from MARKETING.raw.raw_leads
),

cleaned as (
    select
        lead_id,
        campaign_id,
        lower(trim(nullif(lead_source, ''))) as lead_source,
        
    case 
        when lower(converted) in ('1', 'true', 'yes') then true
        when lower(converted) in ('0', 'false', 'no') then false
        else null
    end
 as is_converted,
        initcap(trim(nullif(name, ''))) as name,
        lower(trim(nullif(email, ''))) as email,
        converted_date
    from source
)

select DISTINCT * from cleaned
        );
[0m16:10:56.763969 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.650 seconds
[0m16:10:56.766966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77749ee0-8186-4dcd-8c4f-9c66efa88524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012353052870>]}
[0m16:10:56.767485 [info ] [Thread-1 (]: 3 of 5 OK created sql table model marketing.stg_leads .......................... [[32mSUCCESS 1[0m in 0.66s]
[0m16:10:56.768577 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_leads
[0m16:10:56.769587 [debug] [Thread-1 (]: Began running node model.Marketing.stg_revenue
[0m16:10:56.770630 [info ] [Thread-1 (]: 4 of 5 START sql table model marketing.stg_revenue ............................. [RUN]
[0m16:10:56.770630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_leads, now model.Marketing.stg_revenue)
[0m16:10:56.771635 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_revenue
[0m16:10:56.775357 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_revenue"
[0m16:10:56.776360 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_revenue
[0m16:10:56.779357 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_revenue"
[0m16:10:56.780358 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_revenue"
[0m16:10:56.781356 [debug] [Thread-1 (]: On model.Marketing.stg_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_revenue"} */
create or replace transient table MARKETING.marketing.stg_revenue
         as
        (with source as (
    select * from MARKETING.raw.raw_revenue
),

cleaned as (
    select
        lead_id,
        campaign_id,
        lower(trim(nullif(lead_source, ''))) as lead_source,
        
    case 
        when lower(converted) in ('1', 'true', 'yes') then true
        when lower(converted) in ('0', 'false', 'no') then false
        else null
    end
 as is_converted,
        revenue,
        cast(revenue_date as date) as revenue_date
    from source
)

select DISTINCT * from cleaned
        );
[0m16:10:57.352129 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.570 seconds
[0m16:10:57.354129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77749ee0-8186-4dcd-8c4f-9c66efa88524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123536FE6C0>]}
[0m16:10:57.355129 [info ] [Thread-1 (]: 4 of 5 OK created sql table model marketing.stg_revenue ........................ [[32mSUCCESS 1[0m in 0.58s]
[0m16:10:57.356116 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_revenue
[0m16:10:57.357115 [debug] [Thread-1 (]: Began running node model.Marketing.stg_spend
[0m16:10:57.358112 [info ] [Thread-1 (]: 5 of 5 START sql table model marketing.stg_spend ............................... [RUN]
[0m16:10:57.359126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_revenue, now model.Marketing.stg_spend)
[0m16:10:57.359126 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_spend
[0m16:10:57.362988 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_spend"
[0m16:10:57.363987 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_spend
[0m16:10:57.366988 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_spend"
[0m16:10:57.367987 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_spend"
[0m16:10:57.367987 [debug] [Thread-1 (]: On model.Marketing.stg_spend: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_spend"} */
create or replace transient table MARKETING.marketing.stg_spend
         as
        (with source as (
    select * from MARKETING.raw.raw_spend
),

cleaned as (
    select
        spend_id,
        campaign_id,
        
    try_to_date(spend_date, 'DD/MM/YYYY')
 as spend_date,
        try_to_number(replace(spend_amount, '$', '')) as spend_amount,
        lower(currency) as currency,
        
    nullif(
        case 
            when lower(notes) in ('', 'n/a', 'none', 'null', '-') then null 
            else notes
        end,
        ''
    )
 as notes
    from source
)

select DISTINCT * from cleaned
        );
[0m16:10:57.980201 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.612 seconds
[0m16:10:57.983200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '77749ee0-8186-4dcd-8c4f-9c66efa88524', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000123536FFAA0>]}
[0m16:10:57.983704 [info ] [Thread-1 (]: 5 of 5 OK created sql table model marketing.stg_spend .......................... [[32mSUCCESS 1[0m in 0.62s]
[0m16:10:57.984716 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_spend
[0m16:10:57.985776 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:57.987195 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m16:10:57.987195 [debug] [MainThread]: On list_MARKETING: Close
[0m16:10:58.236109 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m16:10:58.236637 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m16:10:58.415576 [debug] [MainThread]: Connection 'model.Marketing.stg_spend' was left open.
[0m16:10:58.416576 [debug] [MainThread]: On model.Marketing.stg_spend: Close
[0m16:10:58.592033 [info ] [MainThread]: 
[0m16:10:58.593123 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 8.34 seconds (8.34s).
[0m16:10:58.594677 [debug] [MainThread]: Command end result
[0m16:10:58.620473 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m16:10:58.623474 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m16:10:58.629344 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\run_results.json
[0m16:10:58.629344 [info ] [MainThread]: 
[0m16:10:58.630349 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:10:58.631344 [info ] [MainThread]: 
[0m16:10:58.631344 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:10:58.632344 [debug] [MainThread]: Command `dbt run` succeeded at 16:10:58.632344 after 9.56 seconds
[0m16:10:58.633344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001234E09BC80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001235097FE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001235097F7A0>]}
[0m16:10:58.633344 [debug] [MainThread]: Flushing usage events
[0m16:11:02.104244 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:12:10.298844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594908DB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025948EE6CC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259466ED310>]}


============================== 16:12:10.304013 | f21521df-272d-42f4-849d-8a4f9fdba7b0 ==============================
[0m16:12:10.304013 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:12:10.305100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\RAJGOKUL R M\\Documents\\DE_FINAL\\marketing\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\RAJGOKUL R M\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select staging', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:12:10.800663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f21521df-272d-42f4-849d-8a4f9fdba7b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025949052630>]}
[0m16:12:10.871760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f21521df-272d-42f4-849d-8a4f9fdba7b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259488BD940>]}
[0m16:12:10.873908 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:12:11.158124 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:12:11.356370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m16:12:11.357367 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_revenue.sql
[0m16:12:11.357367 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_campaigns.sql
[0m16:12:11.358368 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_spend.sql
[0m16:12:11.358368 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_channels.sql
[0m16:12:11.359368 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_leads.sql
[0m16:12:11.916912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f21521df-272d-42f4-849d-8a4f9fdba7b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594B64C5F0>]}
[0m16:12:12.002137 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m16:12:12.006664 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m16:12:12.034081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f21521df-272d-42f4-849d-8a4f9fdba7b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594B604BC0>]}
[0m16:12:12.035447 [info ] [MainThread]: Found 8 models, 6 data tests, 5 sources, 479 macros
[0m16:12:12.036513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f21521df-272d-42f4-849d-8a4f9fdba7b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594B618470>]}
[0m16:12:12.038994 [info ] [MainThread]: 
[0m16:12:12.040001 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:12:12.040001 [info ] [MainThread]: 
[0m16:12:12.041475 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:12:12.046591 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m16:12:12.152687 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m16:12:12.154004 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m16:12:12.154509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:13.581758 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m16:12:13.581758 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:12:13.582758 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m16:12:13.582758 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m16:12:13.583975 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:12:13.584479 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m16:12:13.584479 [debug] [MainThread]: On list_MARKETING: No close available on handle
[0m16:12:13.584479 [info ] [MainThread]: 
[0m16:12:13.585547 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.54 seconds (1.54s).
[0m16:12:13.586052 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "MARKETING"
  Database Error
    250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting
[0m16:12:13.587582 [debug] [MainThread]: Command `dbt run` failed at 16:12:13.587582 after 3.40 seconds
[0m16:12:13.588634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000259488378C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594B3BA360>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002594B4CA4B0>]}
[0m16:12:13.589643 [debug] [MainThread]: Flushing usage events
[0m16:12:15.972379 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:12:26.751750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002486B325A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002486AAA7380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002486AAA7620>]}


============================== 16:12:26.757008 | c46349ad-717f-49b3-b84b-84366c75a10b ==============================
[0m16:12:26.757008 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:12:26.758009 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\RAJGOKUL R M\\Documents\\DE_FINAL\\marketing\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\RAJGOKUL R M\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'send_anonymous_usage_stats': 'True'}
[0m16:12:27.186652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c46349ad-717f-49b3-b84b-84366c75a10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002486B6A7F80>]}
[0m16:12:27.245752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c46349ad-717f-49b3-b84b-84366c75a10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002486AD7EFF0>]}
[0m16:12:27.247257 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:12:27.489851 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:12:27.669483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:12:27.669483 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_spend.sql
[0m16:12:28.011805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c46349ad-717f-49b3-b84b-84366c75a10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002486D72D280>]}
[0m16:12:28.170814 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m16:12:28.173816 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m16:12:28.197072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c46349ad-717f-49b3-b84b-84366c75a10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002486D65FB00>]}
[0m16:12:28.198059 [info ] [MainThread]: Found 8 models, 6 data tests, 5 sources, 479 macros
[0m16:12:28.198059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c46349ad-717f-49b3-b84b-84366c75a10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002486CF43B00>]}
[0m16:12:28.200058 [info ] [MainThread]: 
[0m16:12:28.201060 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:12:28.201060 [info ] [MainThread]: 
[0m16:12:28.202174 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:12:28.207284 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m16:12:28.279920 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m16:12:28.280920 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m16:12:28.280920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:30.720529 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.439 seconds
[0m16:12:30.724529 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m16:12:30.734040 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m16:12:30.734040 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m16:12:30.735041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:12:32.414321 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.679 seconds
[0m16:12:32.417332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c46349ad-717f-49b3-b84b-84366c75a10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000248687A9DF0>]}
[0m16:12:32.421330 [debug] [Thread-1 (]: Began running node model.Marketing.stg_campaigns
[0m16:12:32.422333 [info ] [Thread-1 (]: 1 of 5 START sql table model marketing.stg_campaigns ........................... [RUN]
[0m16:12:32.423331 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.stg_campaigns'
[0m16:12:32.423331 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_campaigns
[0m16:12:32.434835 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_campaigns"
[0m16:12:32.435835 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_campaigns
[0m16:12:32.465696 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_campaigns"
[0m16:12:32.467698 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_campaigns"
[0m16:12:32.468700 [debug] [Thread-1 (]: On model.Marketing.stg_campaigns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_campaigns"} */
create or replace transient table MARKETING.marketing.stg_campaigns
         as
        (with source as (
    select DISTINCT * from MARKETING.raw.raw_campaigns
),

cleaned as (
    select
        campaign_id,
        
    lower(trim(nullif(campaign_name, '')))
 as campaign_name,
        upper(
    lower(trim(nullif(channel_id, '')))
) as channel_id,
        
    try_to_date(start_date, 'DD/MM/YYYY')
 as start_date,
        
    try_to_date(end_date, 'DD-MM-YYYY')
 as end_date,
        initcap(trim(nullif(status, ''))) as status,
        
    lower(trim(nullif(owner, '')))
 as owner,
        split(tags, ',') as tag_list
    from source
)

select DISTINCT * from cleaned
        );
[0m16:12:32.468700 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:12:33.882207 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.413 seconds
[0m16:12:33.908227 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c46349ad-717f-49b3-b84b-84366c75a10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002486AA83C50>]}
[0m16:12:33.909218 [info ] [Thread-1 (]: 1 of 5 OK created sql table model marketing.stg_campaigns ...................... [[32mSUCCESS 1[0m in 1.48s]
[0m16:12:33.910216 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_campaigns
[0m16:12:33.910216 [debug] [Thread-1 (]: Began running node model.Marketing.stg_channels
[0m16:12:33.911216 [info ] [Thread-1 (]: 2 of 5 START sql table model marketing.stg_channels ............................ [RUN]
[0m16:12:33.911216 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_campaigns, now model.Marketing.stg_channels)
[0m16:12:33.912216 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_channels
[0m16:12:33.915500 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_channels"
[0m16:12:33.916500 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_channels
[0m16:12:33.918510 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_channels"
[0m16:12:33.919507 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_channels"
[0m16:12:33.920508 [debug] [Thread-1 (]: On model.Marketing.stg_channels: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_channels"} */
create or replace transient table MARKETING.marketing.stg_channels
         as
        (with source as (
    select DISTINCT * from MARKETING.raw.raw_channels
),

cleaned as (
    select
        channel_id,
        lower(trim(nullif(channel_name, ''))) as channel_name,
        lower(trim(nullif(channel_type, ''))) as channel_type,
        initcap(trim(nullif(region, ''))) as region,
        
    nullif(
        case 
            when lower(description) in ('', 'n/a', 'none', 'null', '-') then null 
            else description
        end,
        ''
    )
 as description
    from source
)

select DISTINCT * from cleaned
        );
[0m16:12:34.613047 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.692 seconds
[0m16:12:34.615047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c46349ad-717f-49b3-b84b-84366c75a10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002486DCC7530>]}
[0m16:12:34.616047 [info ] [Thread-1 (]: 2 of 5 OK created sql table model marketing.stg_channels ....................... [[32mSUCCESS 1[0m in 0.70s]
[0m16:12:34.617047 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_channels
[0m16:12:34.618047 [debug] [Thread-1 (]: Began running node model.Marketing.stg_leads
[0m16:12:34.618047 [info ] [Thread-1 (]: 3 of 5 START sql table model marketing.stg_leads ............................... [RUN]
[0m16:12:34.619052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_channels, now model.Marketing.stg_leads)
[0m16:12:34.619052 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_leads
[0m16:12:34.624052 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_leads"
[0m16:12:34.625052 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_leads
[0m16:12:34.630057 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_leads"
[0m16:12:34.631056 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_leads"
[0m16:12:34.632052 [debug] [Thread-1 (]: On model.Marketing.stg_leads: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_leads"} */
create or replace transient table MARKETING.marketing.stg_leads
         as
        (with source as (
    select DISTINCT * from MARKETING.raw.raw_leads
),

cleaned as (
    select
        lead_id,
        campaign_id,
        lower(trim(nullif(lead_source, ''))) as lead_source,
        
    case 
        when lower(converted) in ('1', 'true', 'yes') then true
        when lower(converted) in ('0', 'false', 'no') then false
        else null
    end
 as is_converted,
        initcap(trim(nullif(name, ''))) as name,
        lower(trim(nullif(email, ''))) as email,
        converted_date
    from source
)

select DISTINCT * from cleaned
        );
[0m16:12:35.220909 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.589 seconds
[0m16:12:35.224857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c46349ad-717f-49b3-b84b-84366c75a10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002486DD84A70>]}
[0m16:12:35.225882 [info ] [Thread-1 (]: 3 of 5 OK created sql table model marketing.stg_leads .......................... [[32mSUCCESS 1[0m in 0.61s]
[0m16:12:35.226866 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_leads
[0m16:12:35.226866 [debug] [Thread-1 (]: Began running node model.Marketing.stg_revenue
[0m16:12:35.227867 [info ] [Thread-1 (]: 4 of 5 START sql table model marketing.stg_revenue ............................. [RUN]
[0m16:12:35.229160 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_leads, now model.Marketing.stg_revenue)
[0m16:12:35.229160 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_revenue
[0m16:12:35.233525 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_revenue"
[0m16:12:35.234524 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_revenue
[0m16:12:35.236243 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_revenue"
[0m16:12:35.238251 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_revenue"
[0m16:12:35.238251 [debug] [Thread-1 (]: On model.Marketing.stg_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_revenue"} */
create or replace transient table MARKETING.marketing.stg_revenue
         as
        (with source as (
    select DISTINCT * from MARKETING.raw.raw_revenue
),

cleaned as (
    select
        lead_id,
        campaign_id,
        lower(trim(nullif(lead_source, ''))) as lead_source,
        
    case 
        when lower(converted) in ('1', 'true', 'yes') then true
        when lower(converted) in ('0', 'false', 'no') then false
        else null
    end
 as is_converted,
        revenue,
        cast(revenue_date as date) as revenue_date
    from source
)

select DISTINCT * from cleaned
        );
[0m16:12:36.048896 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.810 seconds
[0m16:12:36.051237 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c46349ad-717f-49b3-b84b-84366c75a10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002486DCCBD70>]}
[0m16:12:36.051759 [info ] [Thread-1 (]: 4 of 5 OK created sql table model marketing.stg_revenue ........................ [[32mSUCCESS 1[0m in 0.82s]
[0m16:12:36.052768 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_revenue
[0m16:12:36.053836 [debug] [Thread-1 (]: Began running node model.Marketing.stg_spend
[0m16:12:36.054358 [info ] [Thread-1 (]: 5 of 5 START sql table model marketing.stg_spend ............................... [RUN]
[0m16:12:36.055366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_revenue, now model.Marketing.stg_spend)
[0m16:12:36.056378 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_spend
[0m16:12:36.059384 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_spend"
[0m16:12:36.060390 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_spend
[0m16:12:36.063984 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_spend"
[0m16:12:36.064991 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_spend"
[0m16:12:36.064991 [debug] [Thread-1 (]: On model.Marketing.stg_spend: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_spend"} */
create or replace transient table MARKETING.marketing.stg_spend
         as
        (with source as (
    select DISTINCT * from MARKETING.raw.raw_spend
),

cleaned as (
    select
        spend_id,
        campaign_id,
        
    try_to_date(spend_date, 'DD/MM/YYYY')
 as spend_date,
        try_to_number(replace(spend_amount, '$', '')) as spend_amount,
        lower(currency) as currency,
        
    nullif(
        case 
            when lower(notes) in ('', 'n/a', 'none', 'null', '-') then null 
            else notes
        end,
        ''
    )
 as notes
    from source
)

select  DISTINCT * from cleaned
        );
[0m16:12:36.545758 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.480 seconds
[0m16:12:36.548756 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c46349ad-717f-49b3-b84b-84366c75a10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002486DB737A0>]}
[0m16:12:36.548756 [info ] [Thread-1 (]: 5 of 5 OK created sql table model marketing.stg_spend .......................... [[32mSUCCESS 1[0m in 0.49s]
[0m16:12:36.549758 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_spend
[0m16:12:36.551756 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:12:36.551756 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m16:12:36.552836 [debug] [MainThread]: On list_MARKETING: Close
[0m16:12:36.697972 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m16:12:36.698971 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m16:12:36.842892 [debug] [MainThread]: Connection 'model.Marketing.stg_spend' was left open.
[0m16:12:36.842892 [debug] [MainThread]: On model.Marketing.stg_spend: Close
[0m16:12:37.044696 [info ] [MainThread]: 
[0m16:12:37.045686 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 8.84 seconds (8.84s).
[0m16:12:37.047605 [debug] [MainThread]: Command end result
[0m16:12:37.073095 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m16:12:37.075668 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m16:12:37.081590 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\run_results.json
[0m16:12:37.081590 [info ] [MainThread]: 
[0m16:12:37.082746 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:12:37.082746 [info ] [MainThread]: 
[0m16:12:37.082746 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:12:37.084065 [debug] [MainThread]: Command `dbt run` succeeded at 16:12:37.084065 after 10.44 seconds
[0m16:12:37.085239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002486AF2F830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002486B45F680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002486AF79D90>]}
[0m16:12:37.085239 [debug] [MainThread]: Flushing usage events
[0m16:12:40.065616 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:16:11.294391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251ED159610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251EC715820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251ED159520>]}


============================== 16:16:11.298397 | 093919eb-2857-41b0-b345-3835054578fc ==============================
[0m16:16:11.298397 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:16:11.299397 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\RAJGOKUL R M\\.dbt', 'log_path': 'C:\\Users\\RAJGOKUL R M\\Documents\\DE_FINAL\\marketing\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select staging', 'send_anonymous_usage_stats': 'True'}
[0m16:16:11.733597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '093919eb-2857-41b0-b345-3835054578fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251EEF20F20>]}
[0m16:16:11.790903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '093919eb-2857-41b0-b345-3835054578fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251ECC89670>]}
[0m16:16:11.792929 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:16:12.031998 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:16:12.207048 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:16:12.208504 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:16:12.249860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '093919eb-2857-41b0-b345-3835054578fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251EF12D5B0>]}
[0m16:16:12.346775 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m16:16:12.351990 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m16:16:12.384632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '093919eb-2857-41b0-b345-3835054578fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251ED263950>]}
[0m16:16:12.385693 [info ] [MainThread]: Found 8 models, 6 data tests, 5 sources, 479 macros
[0m16:16:12.386230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '093919eb-2857-41b0-b345-3835054578fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251EAD89D00>]}
[0m16:16:12.388368 [info ] [MainThread]: 
[0m16:16:12.388368 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:16:12.389374 [info ] [MainThread]: 
[0m16:16:12.389374 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:16:12.395044 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m16:16:12.471879 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m16:16:12.472878 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m16:16:12.472878 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:14.024738 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.551 seconds
[0m16:16:14.028515 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m16:16:14.042871 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m16:16:14.043871 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m16:16:14.044870 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:15.395568 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.352 seconds
[0m16:16:15.399531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '093919eb-2857-41b0-b345-3835054578fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251EF49B110>]}
[0m16:16:15.402652 [debug] [Thread-1 (]: Began running node model.Marketing.stg_campaigns
[0m16:16:15.403664 [info ] [Thread-1 (]: 1 of 5 START sql table model marketing.stg_campaigns ........................... [RUN]
[0m16:16:15.404662 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.stg_campaigns'
[0m16:16:15.404662 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_campaigns
[0m16:16:15.417831 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_campaigns"
[0m16:16:15.418832 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_campaigns
[0m16:16:15.448356 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_campaigns"
[0m16:16:15.450361 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_campaigns"
[0m16:16:15.450361 [debug] [Thread-1 (]: On model.Marketing.stg_campaigns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_campaigns"} */
create or replace transient table MARKETING.marketing.stg_campaigns
         as
        (with source as (
    select DISTINCT * from MARKETING.raw.raw_campaigns
),

cleaned as (
    select
        campaign_id,
        
    lower(trim(nullif(campaign_name, '')))
 as campaign_name,
        upper(
    lower(trim(nullif(channel_id, '')))
) as channel_id,
        
    try_to_date(start_date, 'DD/MM/YYYY')
 as start_date,
        
    try_to_date(end_date, 'DD-MM-YYYY')
 as end_date,
        initcap(trim(nullif(status, ''))) as status,
        
    lower(trim(nullif(owner, '')))
 as owner,
        split(tags, ',') as tag_list
    from source
)

select DISTINCT * from cleaned
        );
[0m16:16:15.451358 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:16:17.187555 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.736 seconds
[0m16:16:17.267588 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '093919eb-2857-41b0-b345-3835054578fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251EF39EA80>]}
[0m16:16:17.268296 [info ] [Thread-1 (]: 1 of 5 OK created sql table model marketing.stg_campaigns ...................... [[32mSUCCESS 1[0m in 1.86s]
[0m16:16:17.269302 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_campaigns
[0m16:16:17.270311 [debug] [Thread-1 (]: Began running node model.Marketing.stg_channels
[0m16:16:17.270311 [info ] [Thread-1 (]: 2 of 5 START sql table model marketing.stg_channels ............................ [RUN]
[0m16:16:17.271306 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_campaigns, now model.Marketing.stg_channels)
[0m16:16:17.271306 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_channels
[0m16:16:17.276308 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_channels"
[0m16:16:17.276308 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_channels
[0m16:16:17.279307 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_channels"
[0m16:16:17.280307 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_channels"
[0m16:16:17.281308 [debug] [Thread-1 (]: On model.Marketing.stg_channels: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_channels"} */
create or replace transient table MARKETING.marketing.stg_channels
         as
        (with source as (
    select DISTINCT * from MARKETING.raw.raw_channels
),

cleaned as (
    select
        channel_id,
        lower(trim(nullif(channel_name, ''))) as channel_name,
        lower(trim(nullif(channel_type, ''))) as channel_type,
        initcap(trim(nullif(region, ''))) as region,
        
    nullif(
        case 
            when lower(description) in ('', 'n/a', 'none', 'null', '-') then null 
            else description
        end,
        ''
    )
 as description
    from source
)

select DISTINCT * from cleaned
        );
[0m16:16:17.787830 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.506 seconds
[0m16:16:17.789842 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '093919eb-2857-41b0-b345-3835054578fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251EF018410>]}
[0m16:16:17.791338 [info ] [Thread-1 (]: 2 of 5 OK created sql table model marketing.stg_channels ....................... [[32mSUCCESS 1[0m in 0.52s]
[0m16:16:17.792362 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_channels
[0m16:16:17.792362 [debug] [Thread-1 (]: Began running node model.Marketing.stg_leads
[0m16:16:17.793348 [info ] [Thread-1 (]: 3 of 5 START sql table model marketing.stg_leads ............................... [RUN]
[0m16:16:17.794511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_channels, now model.Marketing.stg_leads)
[0m16:16:17.795033 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_leads
[0m16:16:17.800051 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_leads"
[0m16:16:17.801051 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_leads
[0m16:16:17.803048 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_leads"
[0m16:16:17.805049 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_leads"
[0m16:16:17.805049 [debug] [Thread-1 (]: On model.Marketing.stg_leads: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_leads"} */
create or replace transient table MARKETING.marketing.stg_leads
         as
        (with source as (
    select DISTINCT * from MARKETING.raw.raw_leads
),

cleaned as (
    select
        lead_id,
        campaign_id,
        lower(trim(nullif(lead_source, ''))) as lead_source,
        
    case 
        when lower(converted) in ('1', 'true', 'yes') then true
        when lower(converted) in ('0', 'false', 'no') then false
        else null
    end
 as is_converted,
        initcap(trim(nullif(name, ''))) as name,
        lower(trim(nullif(email, ''))) as email,
        converted_date
    from source
)

select DISTINCT * from cleaned
        );
[0m16:16:18.381883 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.576 seconds
[0m16:16:18.383881 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '093919eb-2857-41b0-b345-3835054578fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251EF4A6E40>]}
[0m16:16:18.384881 [info ] [Thread-1 (]: 3 of 5 OK created sql table model marketing.stg_leads .......................... [[32mSUCCESS 1[0m in 0.59s]
[0m16:16:18.385883 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_leads
[0m16:16:18.385883 [debug] [Thread-1 (]: Began running node model.Marketing.stg_revenue
[0m16:16:18.386881 [info ] [Thread-1 (]: 4 of 5 START sql table model marketing.stg_revenue ............................. [RUN]
[0m16:16:18.387385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_leads, now model.Marketing.stg_revenue)
[0m16:16:18.387385 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_revenue
[0m16:16:18.391253 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_revenue"
[0m16:16:18.391253 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_revenue
[0m16:16:18.394055 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_revenue"
[0m16:16:18.395060 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_revenue"
[0m16:16:18.395060 [debug] [Thread-1 (]: On model.Marketing.stg_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_revenue"} */
create or replace transient table MARKETING.marketing.stg_revenue
         as
        (with source as (
    select DISTINCT * from MARKETING.raw.raw_revenue
),

cleaned as (
    select
        lead_id,
        campaign_id,
        lower(trim(nullif(lead_source, ''))) as lead_source,
        
    case 
        when lower(converted) in ('1', 'true', 'yes') then true
        when lower(converted) in ('0', 'false', 'no') then false
        else null
    end
 as is_converted,
        revenue,
        cast(revenue_date as date) as revenue_date
    from source
)

select DISTINCT * from cleaned
        );
[0m16:16:18.944643 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.549 seconds
[0m16:16:18.947640 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '093919eb-2857-41b0-b345-3835054578fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251EFA3E630>]}
[0m16:16:18.948640 [info ] [Thread-1 (]: 4 of 5 OK created sql table model marketing.stg_revenue ........................ [[32mSUCCESS 1[0m in 0.56s]
[0m16:16:18.949632 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_revenue
[0m16:16:18.949632 [debug] [Thread-1 (]: Began running node model.Marketing.stg_spend
[0m16:16:18.950627 [info ] [Thread-1 (]: 5 of 5 START sql table model marketing.stg_spend ............................... [RUN]
[0m16:16:18.951625 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_revenue, now model.Marketing.stg_spend)
[0m16:16:18.952632 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_spend
[0m16:16:18.955628 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_spend"
[0m16:16:18.956630 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_spend
[0m16:16:18.959628 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_spend"
[0m16:16:18.960630 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_spend"
[0m16:16:18.961628 [debug] [Thread-1 (]: On model.Marketing.stg_spend: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_spend"} */
create or replace transient table MARKETING.marketing.stg_spend
         as
        (with source as (
    select DISTINCT * from MARKETING.raw.raw_spend
),

cleaned as (
    select
        spend_id,
        campaign_id,
        
    try_to_date(spend_date, 'DD/MM/YYYY')
 as spend_date,
        try_to_number(replace(spend_amount, '$', '')) as spend_amount,
        lower(currency) as currency,
        
    nullif(
        case 
            when lower(notes) in ('', 'n/a', 'none', 'null', '-') then null 
            else notes
        end,
        ''
    )
 as notes
    from source
)

select  DISTINCT * from cleaned
        );
[0m16:16:19.571793 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.609 seconds
[0m16:16:19.573793 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '093919eb-2857-41b0-b345-3835054578fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251EFA280B0>]}
[0m16:16:19.574909 [info ] [Thread-1 (]: 5 of 5 OK created sql table model marketing.stg_spend .......................... [[32mSUCCESS 1[0m in 0.62s]
[0m16:16:19.576140 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_spend
[0m16:16:19.577477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:16:19.577477 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m16:16:19.578519 [debug] [MainThread]: On list_MARKETING: Close
[0m16:16:19.748372 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m16:16:19.749372 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m16:16:19.909307 [debug] [MainThread]: Connection 'model.Marketing.stg_spend' was left open.
[0m16:16:19.910296 [debug] [MainThread]: On model.Marketing.stg_spend: Close
[0m16:16:20.062472 [info ] [MainThread]: 
[0m16:16:20.063554 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 7.67 seconds (7.67s).
[0m16:16:20.065472 [debug] [MainThread]: Command end result
[0m16:16:20.091453 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m16:16:20.093960 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m16:16:20.098965 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\run_results.json
[0m16:16:20.099965 [info ] [MainThread]: 
[0m16:16:20.099965 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:16:20.100964 [info ] [MainThread]: 
[0m16:16:20.101965 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:16:20.101965 [debug] [MainThread]: Command `dbt run` succeeded at 16:16:20.101965 after 8.92 seconds
[0m16:16:20.102964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251EDC92BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251EF2D08F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000251EA7FF860>]}
[0m16:16:20.102964 [debug] [MainThread]: Flushing usage events
[0m16:16:23.749441 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:17:50.928326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B550AD430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B57EDE870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B5855B590>]}


============================== 16:17:50.932331 | 486a987e-f127-4dbe-8f27-156f4e95d471 ==============================
[0m16:17:50.932331 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:17:50.933334 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RAJGOKUL R M\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\RAJGOKUL R M\\Documents\\DE_FINAL\\marketing\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:17:51.343881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '486a987e-f127-4dbe-8f27-156f4e95d471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B5A70BEC0>]}
[0m16:17:51.400881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '486a987e-f127-4dbe-8f27-156f4e95d471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B550AD430>]}
[0m16:17:51.402880 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:17:51.655319 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:17:51.847952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m16:17:51.848951 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_leads.sql
[0m16:17:51.849951 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_spend.sql
[0m16:17:51.849951 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_campaigns.sql
[0m16:17:51.850951 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_channels.sql
[0m16:17:51.850951 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_revenue.sql
[0m16:17:52.376421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '486a987e-f127-4dbe-8f27-156f4e95d471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B5AD9BC80>]}
[0m16:17:52.451589 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m16:17:52.455680 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m16:17:52.479435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '486a987e-f127-4dbe-8f27-156f4e95d471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B5AD98E00>]}
[0m16:17:52.480435 [info ] [MainThread]: Found 8 models, 6 data tests, 5 sources, 479 macros
[0m16:17:52.480435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '486a987e-f127-4dbe-8f27-156f4e95d471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B5AD79EE0>]}
[0m16:17:52.482858 [info ] [MainThread]: 
[0m16:17:52.482858 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:17:52.482858 [info ] [MainThread]: 
[0m16:17:52.484242 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:17:52.489310 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m16:17:52.570109 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m16:17:52.571110 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m16:17:52.571110 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:53.827051 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.256 seconds
[0m16:17:53.831051 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m16:17:53.842351 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m16:17:53.842351 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m16:17:53.842855 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:17:54.792646 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.950 seconds
[0m16:17:54.796657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '486a987e-f127-4dbe-8f27-156f4e95d471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B5AD33E00>]}
[0m16:17:54.800765 [debug] [Thread-1 (]: Began running node model.Marketing.stg_campaigns
[0m16:17:54.801877 [info ] [Thread-1 (]: 1 of 5 START sql table model marketing.stg_campaigns ........................... [RUN]
[0m16:17:54.801877 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.stg_campaigns'
[0m16:17:54.803370 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_campaigns
[0m16:17:54.812440 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_campaigns"
[0m16:17:54.812440 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_campaigns
[0m16:17:54.842857 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_campaigns"
[0m16:17:54.843863 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_campaigns"
[0m16:17:54.844858 [debug] [Thread-1 (]: On model.Marketing.stg_campaigns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_campaigns"} */
create or replace transient table MARKETING.marketing.stg_campaigns
         as
        (with source as (
    select  * from MARKETING.raw.raw_campaigns
),

cleaned as (
    select
        campaign_id,
        
    lower(trim(nullif(campaign_name, '')))
 as campaign_name,
        upper(
    lower(trim(nullif(channel_id, '')))
) as channel_id,
        
    try_to_date(start_date, 'DD/MM/YYYY')
 as start_date,
        
    try_to_date(end_date, 'DD-MM-YYYY')
 as end_date,
        initcap(trim(nullif(status, ''))) as status,
        
    lower(trim(nullif(owner, '')))
 as owner,
        split(tags, ',') as tag_list
    from source
)

select DISTINCT * from cleaned
        );
[0m16:17:54.844858 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:17:56.304615 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.459 seconds
[0m16:17:56.330780 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '486a987e-f127-4dbe-8f27-156f4e95d471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B57EDFE00>]}
[0m16:17:56.331788 [info ] [Thread-1 (]: 1 of 5 OK created sql table model marketing.stg_campaigns ...................... [[32mSUCCESS 1[0m in 1.53s]
[0m16:17:56.331788 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_campaigns
[0m16:17:56.332791 [debug] [Thread-1 (]: Began running node model.Marketing.stg_channels
[0m16:17:56.332791 [info ] [Thread-1 (]: 2 of 5 START sql table model marketing.stg_channels ............................ [RUN]
[0m16:17:56.333785 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_campaigns, now model.Marketing.stg_channels)
[0m16:17:56.333785 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_channels
[0m16:17:56.337785 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_channels"
[0m16:17:56.338785 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_channels
[0m16:17:56.341966 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_channels"
[0m16:17:56.343975 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_channels"
[0m16:17:56.343975 [debug] [Thread-1 (]: On model.Marketing.stg_channels: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_channels"} */
create or replace transient table MARKETING.marketing.stg_channels
         as
        (with source as (
    select  * from MARKETING.raw.raw_channels
),

cleaned as (
    select
        channel_id,
        lower(trim(nullif(channel_name, ''))) as channel_name,
        lower(trim(nullif(channel_type, ''))) as channel_type,
        initcap(trim(nullif(region, ''))) as region,
        
    nullif(
        case 
            when lower(description) in ('', 'n/a', 'none', 'null', '-') then null 
            else description
        end,
        ''
    )
 as description
    from source
)

select DISTINCT * from cleaned
        );
[0m16:17:56.967115 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.623 seconds
[0m16:17:56.970125 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '486a987e-f127-4dbe-8f27-156f4e95d471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B5B21D8B0>]}
[0m16:17:56.971125 [info ] [Thread-1 (]: 2 of 5 OK created sql table model marketing.stg_channels ....................... [[32mSUCCESS 1[0m in 0.64s]
[0m16:17:56.972126 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_channels
[0m16:17:56.973126 [debug] [Thread-1 (]: Began running node model.Marketing.stg_leads
[0m16:17:56.973126 [info ] [Thread-1 (]: 3 of 5 START sql table model marketing.stg_leads ............................... [RUN]
[0m16:17:56.974125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_channels, now model.Marketing.stg_leads)
[0m16:17:56.975126 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_leads
[0m16:17:56.978715 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_leads"
[0m16:17:56.979721 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_leads
[0m16:17:56.982655 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_leads"
[0m16:17:56.983655 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_leads"
[0m16:17:56.984896 [debug] [Thread-1 (]: On model.Marketing.stg_leads: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_leads"} */
create or replace transient table MARKETING.marketing.stg_leads
         as
        (with source as (
    select  * from MARKETING.raw.raw_leads
),

cleaned as (
    select
        lead_id,
        campaign_id,
        lower(trim(nullif(lead_source, ''))) as lead_source,
        
    case 
        when lower(converted) in ('1', 'true', 'yes') then true
        when lower(converted) in ('0', 'false', 'no') then false
        else null
    end
 as is_converted,
        initcap(trim(nullif(name, ''))) as name,
        lower(trim(nullif(email, ''))) as email,
        converted_date
    from source
)

select DISTINCT * from cleaned
        );
[0m16:17:57.598360 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.613 seconds
[0m16:17:57.601360 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '486a987e-f127-4dbe-8f27-156f4e95d471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B5B1FE6F0>]}
[0m16:17:57.602360 [info ] [Thread-1 (]: 3 of 5 OK created sql table model marketing.stg_leads .......................... [[32mSUCCESS 1[0m in 0.63s]
[0m16:17:57.603430 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_leads
[0m16:17:57.604017 [debug] [Thread-1 (]: Began running node model.Marketing.stg_revenue
[0m16:17:57.604017 [info ] [Thread-1 (]: 4 of 5 START sql table model marketing.stg_revenue ............................. [RUN]
[0m16:17:57.605028 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_leads, now model.Marketing.stg_revenue)
[0m16:17:57.606243 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_revenue
[0m16:17:57.609893 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_revenue"
[0m16:17:57.609893 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_revenue
[0m16:17:57.613267 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_revenue"
[0m16:17:57.614778 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_revenue"
[0m16:17:57.614778 [debug] [Thread-1 (]: On model.Marketing.stg_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_revenue"} */
create or replace transient table MARKETING.marketing.stg_revenue
         as
        (with source as (
    select  * from MARKETING.raw.raw_revenue
),

cleaned as (
    select
        lead_id,
        campaign_id,
        lower(trim(nullif(lead_source, ''))) as lead_source,
        
    case 
        when lower(converted) in ('1', 'true', 'yes') then true
        when lower(converted) in ('0', 'false', 'no') then false
        else null
    end
 as is_converted,
        revenue,
        cast(revenue_date as date) as revenue_date
    from source
)

select DISTINCT * from cleaned
        );
[0m16:17:58.182727 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.567 seconds
[0m16:17:58.184751 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '486a987e-f127-4dbe-8f27-156f4e95d471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B5B175610>]}
[0m16:17:58.185742 [info ] [Thread-1 (]: 4 of 5 OK created sql table model marketing.stg_revenue ........................ [[32mSUCCESS 1[0m in 0.58s]
[0m16:17:58.186753 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_revenue
[0m16:17:58.187739 [debug] [Thread-1 (]: Began running node model.Marketing.stg_spend
[0m16:17:58.187739 [info ] [Thread-1 (]: 5 of 5 START sql table model marketing.stg_spend ............................... [RUN]
[0m16:17:58.188734 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_revenue, now model.Marketing.stg_spend)
[0m16:17:58.189741 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_spend
[0m16:17:58.192739 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_spend"
[0m16:17:58.193741 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_spend
[0m16:17:58.196739 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_spend"
[0m16:17:58.197741 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_spend"
[0m16:17:58.198740 [debug] [Thread-1 (]: On model.Marketing.stg_spend: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_spend"} */
create or replace transient table MARKETING.marketing.stg_spend
         as
        (with source as (
    select  * from MARKETING.raw.raw_spend
),

cleaned as (
    select
        spend_id,
        campaign_id,
        
    try_to_date(spend_date, 'DD/MM/YYYY')
 as spend_date,
        try_to_number(replace(spend_amount, '$', '')) as spend_amount,
        lower(currency) as currency,
        
    nullif(
        case 
            when lower(notes) in ('', 'n/a', 'none', 'null', '-') then null 
            else notes
        end,
        ''
    )
 as notes
    from source
)

select  DISTINCT * from cleaned
        );
[0m16:17:58.713804 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.515 seconds
[0m16:17:58.715803 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '486a987e-f127-4dbe-8f27-156f4e95d471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B5B21E300>]}
[0m16:17:58.716803 [info ] [Thread-1 (]: 5 of 5 OK created sql table model marketing.stg_spend .......................... [[32mSUCCESS 1[0m in 0.53s]
[0m16:17:58.718800 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_spend
[0m16:17:58.719803 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:17:58.720786 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m16:17:58.720786 [debug] [MainThread]: On list_MARKETING: Close
[0m16:17:58.919085 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m16:17:58.920328 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m16:17:59.160722 [debug] [MainThread]: Connection 'model.Marketing.stg_spend' was left open.
[0m16:17:59.161765 [debug] [MainThread]: On model.Marketing.stg_spend: Close
[0m16:17:59.348623 [info ] [MainThread]: 
[0m16:17:59.349628 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 6.86 seconds (6.86s).
[0m16:17:59.350628 [debug] [MainThread]: Command end result
[0m16:17:59.373392 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m16:17:59.375406 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m16:17:59.381692 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\run_results.json
[0m16:17:59.382692 [info ] [MainThread]: 
[0m16:17:59.383198 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:17:59.383198 [info ] [MainThread]: 
[0m16:17:59.384208 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:17:59.385205 [debug] [MainThread]: Command `dbt run` succeeded at 16:17:59.385205 after 8.56 seconds
[0m16:17:59.385205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B58A06BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B5855B590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014B58558350>]}
[0m16:17:59.386392 [debug] [MainThread]: Flushing usage events
[0m16:18:03.126224 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:23:30.334195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E50D7F3A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E510693500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E50CDC6270>]}


============================== 16:23:30.339208 | 0218708d-52b2-4502-aa1b-4ce8586f4fe9 ==============================
[0m16:23:30.339208 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:23:30.340203 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\RAJGOKUL R M\\Documents\\DE_FINAL\\marketing\\logs', 'profiles_dir': 'C:\\Users\\RAJGOKUL R M\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:23:30.829030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0218708d-52b2-4502-aa1b-4ce8586f4fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5125256A0>]}
[0m16:23:30.888776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0218708d-52b2-4502-aa1b-4ce8586f4fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E510AB08C0>]}
[0m16:23:30.889783 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:23:31.154043 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:23:31.349272 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m16:23:31.350272 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_revenue.sql
[0m16:23:31.350272 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_campaigns.sql
[0m16:23:31.351271 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_leads.sql
[0m16:23:31.351271 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_spend.sql
[0m16:23:31.352271 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_channels.sql
[0m16:23:31.891553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0218708d-52b2-4502-aa1b-4ce8586f4fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E512A725D0>]}
[0m16:23:32.017362 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m16:23:32.021932 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m16:23:32.047783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0218708d-52b2-4502-aa1b-4ce8586f4fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E512969820>]}
[0m16:23:32.048784 [info ] [MainThread]: Found 8 models, 6 data tests, 5 sources, 479 macros
[0m16:23:32.049872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0218708d-52b2-4502-aa1b-4ce8586f4fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E512A90B90>]}
[0m16:23:32.050880 [info ] [MainThread]: 
[0m16:23:32.052042 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:23:32.052042 [info ] [MainThread]: 
[0m16:23:32.053046 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:23:32.058046 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m16:23:32.137066 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m16:23:32.137066 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m16:23:32.138065 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:36.798947 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 4.661 seconds
[0m16:23:36.802948 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m16:23:36.813471 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m16:23:36.814472 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m16:23:36.814472 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:23:37.963985 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.149 seconds
[0m16:23:37.967987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0218708d-52b2-4502-aa1b-4ce8586f4fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E512A7FAA0>]}
[0m16:23:37.972220 [debug] [Thread-1 (]: Began running node model.Marketing.stg_campaigns
[0m16:23:37.972220 [info ] [Thread-1 (]: 1 of 5 START sql table model marketing.stg_campaigns ........................... [RUN]
[0m16:23:37.973218 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.stg_campaigns'
[0m16:23:37.974222 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_campaigns
[0m16:23:37.983232 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_campaigns"
[0m16:23:37.984239 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_campaigns
[0m16:23:38.013279 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_campaigns"
[0m16:23:38.014283 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_campaigns"
[0m16:23:38.015775 [debug] [Thread-1 (]: On model.Marketing.stg_campaigns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_campaigns"} */
create or replace transient table MARKETING.marketing.stg_campaigns
         as
        (with source as (
    select  * from MARKETING.raw.raw_campaigns
),

cleaned as (
    select
        campaign_id,
        
    lower(trim(nullif(campaign_name, '')))
 as campaign_name,
        upper(
    lower(trim(nullif(channel_id, '')))
) as channel_id,
        
    try_to_date(start_date, 'DD/MM/YYYY')
 as start_date,
        
    try_to_date(end_date, 'DD-MM-YYYY')
 as end_date,
        initcap(trim(nullif(status, ''))) as status,
        
    lower(trim(nullif(owner, '')))
 as owner,
        split(tags, ',') as tag_list,
        row_number() over (partition by campaign_id order by campaign_id) as rn
    from source
)

select * from cleaned where rn = 1;
[0m16:23:38.015775 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:23:39.002770 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbae8d-3201-8a6f-0000-000cd70aa509
[0m16:23:39.003770 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 31 at position 34 unexpected ';'.
[0m16:23:39.008662 [debug] [Thread-1 (]: Database Error in model stg_campaigns (models\staging\stg_campaigns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 31 at position 34 unexpected ';'.
  compiled code at target\run\Marketing\models\staging\stg_campaigns.sql
[0m16:23:39.010662 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0218708d-52b2-4502-aa1b-4ce8586f4fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E512A786B0>]}
[0m16:23:39.011662 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model marketing.stg_campaigns .................. [[31mERROR[0m in 1.04s]
[0m16:23:39.012935 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_campaigns
[0m16:23:39.013441 [debug] [Thread-1 (]: Began running node model.Marketing.stg_channels
[0m16:23:39.013441 [debug] [Thread-4 (]: Marking all children of 'model.Marketing.stg_campaigns' to be skipped because of status 'error'.  Reason: Database Error in model stg_campaigns (models\staging\stg_campaigns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 31 at position 34 unexpected ';'.
  compiled code at target\run\Marketing\models\staging\stg_campaigns.sql.
[0m16:23:39.014626 [info ] [Thread-1 (]: 2 of 5 START sql table model marketing.stg_channels ............................ [RUN]
[0m16:23:39.016136 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_campaigns, now model.Marketing.stg_channels)
[0m16:23:39.016136 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_channels
[0m16:23:39.020158 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_channels"
[0m16:23:39.021163 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_channels
[0m16:23:39.022640 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_channels"
[0m16:23:39.025065 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_channels"
[0m16:23:39.025065 [debug] [Thread-1 (]: On model.Marketing.stg_channels: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_channels"} */
create or replace transient table MARKETING.marketing.stg_channels
         as
        (with source as (
    select  * from MARKETING.raw.raw_channels
),

cleaned as (
    select
        channel_id,
        lower(trim(nullif(channel_name, ''))) as channel_name,
        lower(trim(nullif(channel_type, ''))) as channel_type,
        initcap(trim(nullif(region, ''))) as region,
        
    nullif(
        case 
            when lower(description) in ('', 'n/a', 'none', 'null', '-') then null 
            else description
        end,
        ''
    )
 as description,
        row_number() over (partition by channel_id order by channel_id) as rn
    from source
)

select * from cleaned where rn = 1;
[0m16:23:39.145659 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbae8d-3201-8af3-0000-000cd70a9479
[0m16:23:39.145659 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 26 at position 34 unexpected ';'.
[0m16:23:39.149659 [debug] [Thread-1 (]: Database Error in model stg_channels (models\staging\stg_channels.sql)
  001003 (42000): SQL compilation error:
  syntax error line 26 at position 34 unexpected ';'.
  compiled code at target\run\Marketing\models\staging\stg_channels.sql
[0m16:23:39.150659 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0218708d-52b2-4502-aa1b-4ce8586f4fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E513126090>]}
[0m16:23:39.151658 [error] [Thread-1 (]: 2 of 5 ERROR creating sql table model marketing.stg_channels ................... [[31mERROR[0m in 0.13s]
[0m16:23:39.152670 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_channels
[0m16:23:39.153657 [debug] [Thread-1 (]: Began running node model.Marketing.stg_leads
[0m16:23:39.153657 [debug] [Thread-4 (]: Marking all children of 'model.Marketing.stg_channels' to be skipped because of status 'error'.  Reason: Database Error in model stg_channels (models\staging\stg_channels.sql)
  001003 (42000): SQL compilation error:
  syntax error line 26 at position 34 unexpected ';'.
  compiled code at target\run\Marketing\models\staging\stg_channels.sql.
[0m16:23:39.155125 [info ] [Thread-1 (]: 3 of 5 START sql table model marketing.stg_leads ............................... [RUN]
[0m16:23:39.155125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_channels, now model.Marketing.stg_leads)
[0m16:23:39.156563 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_leads
[0m16:23:39.161582 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_leads"
[0m16:23:39.162612 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_leads
[0m16:23:39.165975 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_leads"
[0m16:23:39.166976 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_leads"
[0m16:23:39.166976 [debug] [Thread-1 (]: On model.Marketing.stg_leads: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_leads"} */
create or replace transient table MARKETING.marketing.stg_leads
         as
        (with source as (
    select  * from MARKETING.raw.raw_leads
),

cleaned as (
    select
        lead_id,
        campaign_id,
        lower(trim(nullif(lead_source, ''))) as lead_source,
        
    case 
        when lower(converted) in ('1', 'true', 'yes') then true
        when lower(converted) in ('0', 'false', 'no') then false
        else null
    end
 as is_converted,
        initcap(trim(nullif(name, ''))) as name,
        lower(trim(nullif(email, ''))) as email,
        converted_date,
        row_number() over (partition by lead_id order by lead_id) as rn
    from source
)

select * from cleaned where rn = 1;
[0m16:23:39.287935 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbae8d-3201-8ade-0000-000cd70a84ed
[0m16:23:39.287935 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 26 at position 34 unexpected ';'.
[0m16:23:39.291935 [debug] [Thread-1 (]: Database Error in model stg_leads (models\staging\stg_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 26 at position 34 unexpected ';'.
  compiled code at target\run\Marketing\models\staging\stg_leads.sql
[0m16:23:39.292936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0218708d-52b2-4502-aa1b-4ce8586f4fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E512F60B00>]}
[0m16:23:39.292936 [error] [Thread-1 (]: 3 of 5 ERROR creating sql table model marketing.stg_leads ...................... [[31mERROR[0m in 0.14s]
[0m16:23:39.294228 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_leads
[0m16:23:39.295239 [debug] [Thread-1 (]: Began running node model.Marketing.stg_revenue
[0m16:23:39.296253 [debug] [Thread-4 (]: Marking all children of 'model.Marketing.stg_leads' to be skipped because of status 'error'.  Reason: Database Error in model stg_leads (models\staging\stg_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 26 at position 34 unexpected ';'.
  compiled code at target\run\Marketing\models\staging\stg_leads.sql.
[0m16:23:39.296253 [info ] [Thread-1 (]: 4 of 5 START sql table model marketing.stg_revenue ............................. [RUN]
[0m16:23:39.297239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_leads, now model.Marketing.stg_revenue)
[0m16:23:39.298526 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_revenue
[0m16:23:39.301534 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_revenue"
[0m16:23:39.302534 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_revenue
[0m16:23:39.305536 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_revenue"
[0m16:23:39.306534 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_revenue"
[0m16:23:39.307535 [debug] [Thread-1 (]: On model.Marketing.stg_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_revenue"} */
create or replace transient table MARKETING.marketing.stg_revenue
         as
        (with source as (
    select  * from MARKETING.raw.raw_revenue
),

cleaned as (
    select
        lead_id,
        campaign_id,
        lower(trim(nullif(lead_source, ''))) as lead_source,
        
    case 
        when lower(converted) in ('1', 'true', 'yes') then true
        when lower(converted) in ('0', 'false', 'no') then false
        else null
    end
 as is_converted,
        revenue,
        cast(revenue_date as date) as revenue_date,
        row_number() over (partition by lead_id, campaign_id order by revenue_date) as rn
    from source
)

select * from cleaned where rn = 1;
[0m16:23:39.441097 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbae8d-3201-8b94-0000-000cd70ae225
[0m16:23:39.442096 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 25 at position 34 unexpected ';'.
[0m16:23:39.445599 [debug] [Thread-1 (]: Database Error in model stg_revenue (models\staging\stg_revenue.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 34 unexpected ';'.
  compiled code at target\run\Marketing\models\staging\stg_revenue.sql
[0m16:23:39.446605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0218708d-52b2-4502-aa1b-4ce8586f4fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E512EC1160>]}
[0m16:23:39.447609 [error] [Thread-1 (]: 4 of 5 ERROR creating sql table model marketing.stg_revenue .................... [[31mERROR[0m in 0.15s]
[0m16:23:39.448670 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_revenue
[0m16:23:39.449221 [debug] [Thread-1 (]: Began running node model.Marketing.stg_spend
[0m16:23:39.449221 [debug] [Thread-4 (]: Marking all children of 'model.Marketing.stg_revenue' to be skipped because of status 'error'.  Reason: Database Error in model stg_revenue (models\staging\stg_revenue.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 34 unexpected ';'.
  compiled code at target\run\Marketing\models\staging\stg_revenue.sql.
[0m16:23:39.450242 [info ] [Thread-1 (]: 5 of 5 START sql table model marketing.stg_spend ............................... [RUN]
[0m16:23:39.451237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_revenue, now model.Marketing.stg_spend)
[0m16:23:39.452563 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_spend
[0m16:23:39.456087 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_spend"
[0m16:23:39.457092 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_spend
[0m16:23:39.459491 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_spend"
[0m16:23:39.461009 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_spend"
[0m16:23:39.462012 [debug] [Thread-1 (]: On model.Marketing.stg_spend: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_spend"} */
create or replace transient table MARKETING.marketing.stg_spend
         as
        (with source as (
    select  * from MARKETING.raw.raw_spend
),

cleaned as (
    select
        spend_id,
        campaign_id,
        
    try_to_date(spend_date, 'DD/MM/YYYY')
 as spend_date,
        try_to_number(replace(spend_amount, '$', '')) as spend_amount,
        lower(currency) as currency,
        
    nullif(
        case 
            when lower(notes) in ('', 'n/a', 'none', 'null', '-') then null 
            else notes
        end,
        ''
    )
 as notes,
        row_number() over (partition by spend_id order by spend_date) as rn
    from source
)

select * from cleaned where rn = 1;
[0m16:23:39.573450 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbae8d-3201-8a6f-0000-000cd70aa50d
[0m16:23:39.574451 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 29 at position 34 unexpected ';'.
[0m16:23:39.578230 [debug] [Thread-1 (]: Database Error in model stg_spend (models\staging\stg_spend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 34 unexpected ';'.
  compiled code at target\run\Marketing\models\staging\stg_spend.sql
[0m16:23:39.579230 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0218708d-52b2-4502-aa1b-4ce8586f4fe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E513135C40>]}
[0m16:23:39.580215 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model marketing.stg_spend ...................... [[31mERROR[0m in 0.13s]
[0m16:23:39.581214 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_spend
[0m16:23:39.582216 [debug] [Thread-4 (]: Marking all children of 'model.Marketing.stg_spend' to be skipped because of status 'error'.  Reason: Database Error in model stg_spend (models\staging\stg_spend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 34 unexpected ';'.
  compiled code at target\run\Marketing\models\staging\stg_spend.sql.
[0m16:23:39.583213 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:23:39.583213 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m16:23:39.584721 [debug] [MainThread]: On list_MARKETING: Close
[0m16:23:39.817495 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m16:23:39.817495 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m16:23:40.023766 [debug] [MainThread]: Connection 'model.Marketing.stg_spend' was left open.
[0m16:23:40.023766 [debug] [MainThread]: On model.Marketing.stg_spend: Close
[0m16:23:40.313057 [info ] [MainThread]: 
[0m16:23:40.314058 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 8.26 seconds (8.26s).
[0m16:23:40.316249 [debug] [MainThread]: Command end result
[0m16:23:40.340674 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m16:23:40.342762 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m16:23:40.349058 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\run_results.json
[0m16:23:40.349579 [info ] [MainThread]: 
[0m16:23:40.350118 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m16:23:40.350639 [info ] [MainThread]: 
[0m16:23:40.351683 [error] [MainThread]:   Database Error in model stg_campaigns (models\staging\stg_campaigns.sql)
  001003 (42000): SQL compilation error:
  syntax error line 31 at position 34 unexpected ';'.
  compiled code at target\run\Marketing\models\staging\stg_campaigns.sql
[0m16:23:40.352204 [info ] [MainThread]: 
[0m16:23:40.352729 [error] [MainThread]:   Database Error in model stg_channels (models\staging\stg_channels.sql)
  001003 (42000): SQL compilation error:
  syntax error line 26 at position 34 unexpected ';'.
  compiled code at target\run\Marketing\models\staging\stg_channels.sql
[0m16:23:40.353244 [info ] [MainThread]: 
[0m16:23:40.353757 [error] [MainThread]:   Database Error in model stg_leads (models\staging\stg_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 26 at position 34 unexpected ';'.
  compiled code at target\run\Marketing\models\staging\stg_leads.sql
[0m16:23:40.354281 [info ] [MainThread]: 
[0m16:23:40.354805 [error] [MainThread]:   Database Error in model stg_revenue (models\staging\stg_revenue.sql)
  001003 (42000): SQL compilation error:
  syntax error line 25 at position 34 unexpected ';'.
  compiled code at target\run\Marketing\models\staging\stg_revenue.sql
[0m16:23:40.355330 [info ] [MainThread]: 
[0m16:23:40.355852 [error] [MainThread]:   Database Error in model stg_spend (models\staging\stg_spend.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 34 unexpected ';'.
  compiled code at target\run\Marketing\models\staging\stg_spend.sql
[0m16:23:40.356900 [info ] [MainThread]: 
[0m16:23:40.357424 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=0 TOTAL=5
[0m16:23:40.358483 [debug] [MainThread]: Command `dbt run` failed at 16:23:40.358483 after 10.14 seconds
[0m16:23:40.359003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E510817C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5129BC290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E50FCA4110>]}
[0m16:23:40.359531 [debug] [MainThread]: Flushing usage events
[0m16:23:43.530985 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:25:00.320880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE4116AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE3ECECC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE3ECDA00>]}


============================== 16:25:00.325218 | 7955131e-215a-4c9c-8c86-39e1b56dd00a ==============================
[0m16:25:00.325218 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:25:00.325218 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RAJGOKUL R M\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\RAJGOKUL R M\\Documents\\DE_FINAL\\marketing\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:25:00.740662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7955131e-215a-4c9c-8c86-39e1b56dd00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE475D8E0>]}
[0m16:25:00.796662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7955131e-215a-4c9c-8c86-39e1b56dd00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE3F3DBE0>]}
[0m16:25:00.798360 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:25:01.034172 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:25:01.228716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m16:25:01.228716 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_leads.sql
[0m16:25:01.229874 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_channels.sql
[0m16:25:01.229874 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_campaigns.sql
[0m16:25:01.231049 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_spend.sql
[0m16:25:01.231049 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_revenue.sql
[0m16:25:01.745758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7955131e-215a-4c9c-8c86-39e1b56dd00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE687F800>]}
[0m16:25:01.823144 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m16:25:01.826147 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m16:25:01.850945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7955131e-215a-4c9c-8c86-39e1b56dd00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE6843620>]}
[0m16:25:01.850945 [info ] [MainThread]: Found 8 models, 6 data tests, 5 sources, 479 macros
[0m16:25:01.851946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7955131e-215a-4c9c-8c86-39e1b56dd00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE685D3A0>]}
[0m16:25:01.853943 [info ] [MainThread]: 
[0m16:25:01.853943 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:25:01.854945 [info ] [MainThread]: 
[0m16:25:01.855946 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:25:01.860172 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m16:25:01.933680 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m16:25:01.934682 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m16:25:01.934682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:02.994479 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.060 seconds
[0m16:25:02.998478 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m16:25:03.010027 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m16:25:03.010027 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m16:25:03.011027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:25:04.012260 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.001 seconds
[0m16:25:04.015378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7955131e-215a-4c9c-8c86-39e1b56dd00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE6171220>]}
[0m16:25:04.017735 [debug] [Thread-1 (]: Began running node model.Marketing.stg_campaigns
[0m16:25:04.018937 [info ] [Thread-1 (]: 1 of 5 START sql table model marketing.stg_campaigns ........................... [RUN]
[0m16:25:04.019960 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.stg_campaigns'
[0m16:25:04.019960 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_campaigns
[0m16:25:04.027958 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_campaigns"
[0m16:25:04.028959 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_campaigns
[0m16:25:04.058812 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_campaigns"
[0m16:25:04.060811 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_campaigns"
[0m16:25:04.061811 [debug] [Thread-1 (]: On model.Marketing.stg_campaigns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_campaigns"} */
create or replace transient table MARKETING.marketing.stg_campaigns
         as
        (with source as (
    select  * from MARKETING.raw.raw_campaigns
),

cleaned as (
    select
        campaign_id,
        
    lower(trim(nullif(campaign_name, '')))
 as campaign_name,
        upper(
    lower(trim(nullif(channel_id, '')))
) as channel_id,
        
    try_to_date(start_date, 'DD/MM/YYYY')
 as start_date,
        
    try_to_date(end_date, 'DD-MM-YYYY')
 as end_date,
        initcap(trim(nullif(status, ''))) as status,
        
    lower(trim(nullif(owner, '')))
 as owner,
        split(tags, ',') as tag_list,
        row_number() over (partition by campaign_id order by campaign_id) as rn
    from source
)

select * from cleaned where rn = 1
        );
[0m16:25:04.061811 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:25:06.990225 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.928 seconds
[0m16:25:07.016224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7955131e-215a-4c9c-8c86-39e1b56dd00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE165BBC0>]}
[0m16:25:07.017225 [info ] [Thread-1 (]: 1 of 5 OK created sql table model marketing.stg_campaigns ...................... [[32mSUCCESS 1[0m in 3.00s]
[0m16:25:07.018224 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_campaigns
[0m16:25:07.019224 [debug] [Thread-1 (]: Began running node model.Marketing.stg_channels
[0m16:25:07.019224 [info ] [Thread-1 (]: 2 of 5 START sql table model marketing.stg_channels ............................ [RUN]
[0m16:25:07.020224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_campaigns, now model.Marketing.stg_channels)
[0m16:25:07.020224 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_channels
[0m16:25:07.024224 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_channels"
[0m16:25:07.025224 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_channels
[0m16:25:07.028227 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_channels"
[0m16:25:07.030226 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_channels"
[0m16:25:07.031226 [debug] [Thread-1 (]: On model.Marketing.stg_channels: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_channels"} */
create or replace transient table MARKETING.marketing.stg_channels
         as
        (with source as (
    select  * from MARKETING.raw.raw_channels
),

cleaned as (
    select
        channel_id,
        lower(trim(nullif(channel_name, ''))) as channel_name,
        lower(trim(nullif(channel_type, ''))) as channel_type,
        initcap(trim(nullif(region, ''))) as region,
        
    nullif(
        case 
            when lower(description) in ('', 'n/a', 'none', 'null', '-') then null 
            else description
        end,
        ''
    )
 as description,
        row_number() over (partition by channel_id order by channel_id) as rn
    from source
)

select * from cleaned where rn = 1
        );
[0m16:25:07.638860 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.607 seconds
[0m16:25:07.640985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7955131e-215a-4c9c-8c86-39e1b56dd00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE6B10980>]}
[0m16:25:07.642036 [info ] [Thread-1 (]: 2 of 5 OK created sql table model marketing.stg_channels ....................... [[32mSUCCESS 1[0m in 0.62s]
[0m16:25:07.643103 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_channels
[0m16:25:07.643639 [debug] [Thread-1 (]: Began running node model.Marketing.stg_leads
[0m16:25:07.644173 [info ] [Thread-1 (]: 3 of 5 START sql table model marketing.stg_leads ............................... [RUN]
[0m16:25:07.644705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_channels, now model.Marketing.stg_leads)
[0m16:25:07.645237 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_leads
[0m16:25:07.648882 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_leads"
[0m16:25:07.649933 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_leads
[0m16:25:07.652031 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_leads"
[0m16:25:07.653616 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_leads"
[0m16:25:07.654142 [debug] [Thread-1 (]: On model.Marketing.stg_leads: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_leads"} */
create or replace transient table MARKETING.marketing.stg_leads
         as
        (with source as (
    select  * from MARKETING.raw.raw_leads
),

cleaned as (
    select
        lead_id,
        campaign_id,
        lower(trim(nullif(lead_source, ''))) as lead_source,
        
    case 
        when lower(converted) in ('1', 'true', 'yes') then true
        when lower(converted) in ('0', 'false', 'no') then false
        else null
    end
 as is_converted,
        initcap(trim(nullif(name, ''))) as name,
        lower(trim(nullif(email, ''))) as email,
        converted_date,
        row_number() over (partition by lead_id order by lead_id) as rn
    from source
)

select * from cleaned where rn = 1
        );
[0m16:25:08.289726 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.635 seconds
[0m16:25:08.292375 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7955131e-215a-4c9c-8c86-39e1b56dd00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE6D0B590>]}
[0m16:25:08.293362 [info ] [Thread-1 (]: 3 of 5 OK created sql table model marketing.stg_leads .......................... [[32mSUCCESS 1[0m in 0.65s]
[0m16:25:08.294358 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_leads
[0m16:25:08.294865 [debug] [Thread-1 (]: Began running node model.Marketing.stg_revenue
[0m16:25:08.295874 [info ] [Thread-1 (]: 4 of 5 START sql table model marketing.stg_revenue ............................. [RUN]
[0m16:25:08.295874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_leads, now model.Marketing.stg_revenue)
[0m16:25:08.297364 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_revenue
[0m16:25:08.300373 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_revenue"
[0m16:25:08.301374 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_revenue
[0m16:25:08.304374 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_revenue"
[0m16:25:08.306374 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_revenue"
[0m16:25:08.306374 [debug] [Thread-1 (]: On model.Marketing.stg_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_revenue"} */
create or replace transient table MARKETING.marketing.stg_revenue
         as
        (with source as (
    select  * from MARKETING.raw.raw_revenue
),

cleaned as (
    select
        lead_id,
        campaign_id,
        lower(trim(nullif(lead_source, ''))) as lead_source,
        
    case 
        when lower(converted) in ('1', 'true', 'yes') then true
        when lower(converted) in ('0', 'false', 'no') then false
        else null
    end
 as is_converted,
        revenue,
        cast(revenue_date as date) as revenue_date,
        row_number() over (partition by lead_id, campaign_id order by revenue_date) as rn
    from source
)

select * from cleaned where rn = 1
        );
[0m16:25:08.951571 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.645 seconds
[0m16:25:08.954568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7955131e-215a-4c9c-8c86-39e1b56dd00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE6C7A4E0>]}
[0m16:25:08.955571 [info ] [Thread-1 (]: 4 of 5 OK created sql table model marketing.stg_revenue ........................ [[32mSUCCESS 1[0m in 0.66s]
[0m16:25:08.956556 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_revenue
[0m16:25:08.957555 [debug] [Thread-1 (]: Began running node model.Marketing.stg_spend
[0m16:25:08.957555 [info ] [Thread-1 (]: 5 of 5 START sql table model marketing.stg_spend ............................... [RUN]
[0m16:25:08.958559 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_revenue, now model.Marketing.stg_spend)
[0m16:25:08.959571 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_spend
[0m16:25:08.963557 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_spend"
[0m16:25:08.964555 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_spend
[0m16:25:08.966556 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_spend"
[0m16:25:08.968556 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_spend"
[0m16:25:08.968556 [debug] [Thread-1 (]: On model.Marketing.stg_spend: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_spend"} */
create or replace transient table MARKETING.marketing.stg_spend
         as
        (with source as (
    select  * from MARKETING.raw.raw_spend
),

cleaned as (
    select
        spend_id,
        campaign_id,
        
    try_to_date(spend_date, 'DD/MM/YYYY')
 as spend_date,
        try_to_number(replace(spend_amount, '$', '')) as spend_amount,
        lower(currency) as currency,
        
    nullif(
        case 
            when lower(notes) in ('', 'n/a', 'none', 'null', '-') then null 
            else notes
        end,
        ''
    )
 as notes,
        row_number() over (partition by spend_id order by spend_date) as rn
    from source
)

select * from cleaned where rn = 1
        );
[0m16:25:09.545864 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.576 seconds
[0m16:25:09.547863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7955131e-215a-4c9c-8c86-39e1b56dd00a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE687F8C0>]}
[0m16:25:09.548864 [info ] [Thread-1 (]: 5 of 5 OK created sql table model marketing.stg_spend .......................... [[32mSUCCESS 1[0m in 0.59s]
[0m16:25:09.549884 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_spend
[0m16:25:09.551934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:25:09.552935 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m16:25:09.552935 [debug] [MainThread]: On list_MARKETING: Close
[0m16:25:09.714819 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m16:25:09.714819 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m16:25:09.877236 [debug] [MainThread]: Connection 'model.Marketing.stg_spend' was left open.
[0m16:25:09.877236 [debug] [MainThread]: On model.Marketing.stg_spend: Close
[0m16:25:10.081742 [info ] [MainThread]: 
[0m16:25:10.082748 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 8.23 seconds (8.23s).
[0m16:25:10.084747 [debug] [MainThread]: Command end result
[0m16:25:10.105842 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m16:25:10.107845 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m16:25:10.114844 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\run_results.json
[0m16:25:10.114844 [info ] [MainThread]: 
[0m16:25:10.115845 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:25:10.116845 [info ] [MainThread]: 
[0m16:25:10.116845 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:25:10.117846 [debug] [MainThread]: Command `dbt run` succeeded at 16:25:10.117846 after 9.90 seconds
[0m16:25:10.118844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE4116AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE152BC20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CE4562ED0>]}
[0m16:25:10.118844 [debug] [MainThread]: Flushing usage events
[0m16:25:14.345090 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:43:48.636065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD01C33AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD03BB9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD01F94CE0>]}


============================== 16:43:48.642067 | ab379f37-f3e5-4500-86c2-958d75d88dce ==============================
[0m16:43:48.642067 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:43:48.642067 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\RAJGOKUL R M\\Documents\\DE_FINAL\\marketing\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\RAJGOKUL R M\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:43:49.096857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab379f37-f3e5-4500-86c2-958d75d88dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD057B8F20>]}
[0m16:43:49.152858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab379f37-f3e5-4500-86c2-958d75d88dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD068B7770>]}
[0m16:43:49.154738 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:43:49.389743 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:43:49.571327 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:43:49.572328 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_campaigns.sql
[0m16:43:49.573328 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_channels.sql
[0m16:43:50.066268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab379f37-f3e5-4500-86c2-958d75d88dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD06ED5C40>]}
[0m16:43:50.143970 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m16:43:50.147759 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m16:43:50.171765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab379f37-f3e5-4500-86c2-958d75d88dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD06EB6900>]}
[0m16:43:50.172767 [info ] [MainThread]: Found 8 models, 6 data tests, 5 sources, 479 macros
[0m16:43:50.172767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab379f37-f3e5-4500-86c2-958d75d88dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD06ED24B0>]}
[0m16:43:50.175403 [info ] [MainThread]: 
[0m16:43:50.175907 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:43:50.175907 [info ] [MainThread]: 
[0m16:43:50.177159 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:43:50.181164 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m16:43:50.256605 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m16:43:50.257609 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m16:43:50.257609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:53.409437 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.151 seconds
[0m16:43:53.413422 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m16:43:53.424421 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m16:43:53.425421 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m16:43:53.425421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:54.704349 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.279 seconds
[0m16:43:54.708345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab379f37-f3e5-4500-86c2-958d75d88dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD06EAE7B0>]}
[0m16:43:54.710975 [debug] [Thread-1 (]: Began running node model.Marketing.stg_campaigns
[0m16:43:54.712431 [info ] [Thread-1 (]: 1 of 5 START sql table model marketing.stg_campaigns ........................... [RUN]
[0m16:43:54.713442 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.stg_campaigns'
[0m16:43:54.714441 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_campaigns
[0m16:43:54.723509 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_campaigns"
[0m16:43:54.724508 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_campaigns
[0m16:43:54.754418 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_campaigns"
[0m16:43:54.756418 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_campaigns"
[0m16:43:54.756418 [debug] [Thread-1 (]: On model.Marketing.stg_campaigns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_campaigns"} */
create or replace transient table MARKETING.marketing.stg_campaigns
         as
        (with source as (
    select * from MARKETING.raw.raw_campaigns
),

deduped as (
    select *,
        row_number() over (
            partition by campaign_id
            order by end_date desc
        ) as rn
    from source
),

cleaned as (
    select
        campaign_id,
        
    lower(trim(nullif(campaign_name, '')))
 as campaign_name,
        upper(
    lower(trim(nullif(channel_id, '')))
) as channel_id,
        
    try_to_date(start_date, 'DD/MM/YYYY')
 as start_date,
        
    try_to_date(end_date, 'DD-MM-YYYY')
 as end_date,
        initcap(trim(nullif(status, ''))) as status,
        
    lower(trim(nullif(owner, '')))
 as owner,
        split(tags, ',') as tag_list
    from deduped
    where rn = 1
)

select * from cleaned
        );
[0m16:43:54.757418 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:43:56.536361 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.779 seconds
[0m16:43:56.561885 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab379f37-f3e5-4500-86c2-958d75d88dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD01D2BB30>]}
[0m16:43:56.562885 [info ] [Thread-1 (]: 1 of 5 OK created sql table model marketing.stg_campaigns ...................... [[32mSUCCESS 1[0m in 1.85s]
[0m16:43:56.564062 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_campaigns
[0m16:43:56.564571 [debug] [Thread-1 (]: Began running node model.Marketing.stg_channels
[0m16:43:56.564571 [info ] [Thread-1 (]: 2 of 5 START sql table model marketing.stg_channels ............................ [RUN]
[0m16:43:56.565858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_campaigns, now model.Marketing.stg_channels)
[0m16:43:56.565858 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_channels
[0m16:43:56.570622 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_channels"
[0m16:43:56.570862 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_channels
[0m16:43:56.573380 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_channels"
[0m16:43:56.575210 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_channels"
[0m16:43:56.576220 [debug] [Thread-1 (]: On model.Marketing.stg_channels: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_channels"} */
create or replace transient table MARKETING.marketing.stg_channels
         as
        (with source as (
    select * from MARKETING.raw.raw_channels
),

deduped as (
    select *,
        row_number() over (
            partition by channel_id
            order by channel_id  -- can add other tie-breakers if needed
        ) as rn
    from source
),

cleaned as (
    select
        upper(trim(nullif(channel_name, ''))) as channel_id,
        lower(trim(nullif(channel_name, ''))) as channel_name,
        lower(trim(nullif(channel_type, ''))) as channel_type,
        initcap(trim(nullif(region, ''))) as region,
        
    nullif(
        case 
            when lower(description) in ('', 'n/a', 'none', 'null', '-') then null 
            else description
        end,
        ''
    )
 as description
    from deduped
    where rn = 1
)

select * from cleaned
        );
[0m16:43:57.126137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.549 seconds
[0m16:43:57.128137 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab379f37-f3e5-4500-86c2-958d75d88dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD073B1310>]}
[0m16:43:57.129137 [info ] [Thread-1 (]: 2 of 5 OK created sql table model marketing.stg_channels ....................... [[32mSUCCESS 1[0m in 0.56s]
[0m16:43:57.131128 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_channels
[0m16:43:57.131128 [debug] [Thread-1 (]: Began running node model.Marketing.stg_leads
[0m16:43:57.132122 [info ] [Thread-1 (]: 3 of 5 START sql table model marketing.stg_leads ............................... [RUN]
[0m16:43:57.133121 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_channels, now model.Marketing.stg_leads)
[0m16:43:57.133121 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_leads
[0m16:43:57.138747 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_leads"
[0m16:43:57.139754 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_leads
[0m16:43:57.142747 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_leads"
[0m16:43:57.143749 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_leads"
[0m16:43:57.143749 [debug] [Thread-1 (]: On model.Marketing.stg_leads: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_leads"} */
create or replace transient table MARKETING.marketing.stg_leads
         as
        (with source as (
    select  * from MARKETING.raw.raw_leads
),

cleaned as (
    select
        lead_id,
        campaign_id,
        lower(trim(nullif(lead_source, ''))) as lead_source,
        
    case 
        when lower(converted) in ('1', 'true', 'yes') then true
        when lower(converted) in ('0', 'false', 'no') then false
        else null
    end
 as is_converted,
        initcap(trim(nullif(name, ''))) as name,
        lower(trim(nullif(email, ''))) as email,
        converted_date,
        row_number() over (partition by lead_id order by lead_id) as rn
    from source
)

select * from cleaned where rn = 1
        );
[0m16:43:57.653087 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.508 seconds
[0m16:43:57.655085 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab379f37-f3e5-4500-86c2-958d75d88dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD0749FD70>]}
[0m16:43:57.656085 [info ] [Thread-1 (]: 3 of 5 OK created sql table model marketing.stg_leads .......................... [[32mSUCCESS 1[0m in 0.52s]
[0m16:43:57.657101 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_leads
[0m16:43:57.658091 [debug] [Thread-1 (]: Began running node model.Marketing.stg_revenue
[0m16:43:57.658091 [info ] [Thread-1 (]: 4 of 5 START sql table model marketing.stg_revenue ............................. [RUN]
[0m16:43:57.659086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_leads, now model.Marketing.stg_revenue)
[0m16:43:57.659086 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_revenue
[0m16:43:57.662085 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_revenue"
[0m16:43:57.663084 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_revenue
[0m16:43:57.666319 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_revenue"
[0m16:43:57.668319 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_revenue"
[0m16:43:57.668319 [debug] [Thread-1 (]: On model.Marketing.stg_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_revenue"} */
create or replace transient table MARKETING.marketing.stg_revenue
         as
        (with source as (
    select  * from MARKETING.raw.raw_revenue
),

cleaned as (
    select
        lead_id,
        campaign_id,
        lower(trim(nullif(lead_source, ''))) as lead_source,
        
    case 
        when lower(converted) in ('1', 'true', 'yes') then true
        when lower(converted) in ('0', 'false', 'no') then false
        else null
    end
 as is_converted,
        revenue,
        cast(revenue_date as date) as revenue_date,
        row_number() over (partition by lead_id, campaign_id order by revenue_date) as rn
    from source
)

select * from cleaned where rn = 1
        );
[0m16:43:58.295359 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.626 seconds
[0m16:43:58.298355 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab379f37-f3e5-4500-86c2-958d75d88dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD074BCCE0>]}
[0m16:43:58.299355 [info ] [Thread-1 (]: 4 of 5 OK created sql table model marketing.stg_revenue ........................ [[32mSUCCESS 1[0m in 0.64s]
[0m16:43:58.301356 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_revenue
[0m16:43:58.302352 [debug] [Thread-1 (]: Began running node model.Marketing.stg_spend
[0m16:43:58.302352 [info ] [Thread-1 (]: 5 of 5 START sql table model marketing.stg_spend ............................... [RUN]
[0m16:43:58.303355 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_revenue, now model.Marketing.stg_spend)
[0m16:43:58.304352 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_spend
[0m16:43:58.307861 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_spend"
[0m16:43:58.308862 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_spend
[0m16:43:58.310863 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_spend"
[0m16:43:58.312863 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_spend"
[0m16:43:58.312863 [debug] [Thread-1 (]: On model.Marketing.stg_spend: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_spend"} */
create or replace transient table MARKETING.marketing.stg_spend
         as
        (with source as (
    select  * from MARKETING.raw.raw_spend
),

cleaned as (
    select
        spend_id,
        campaign_id,
        
    try_to_date(spend_date, 'DD/MM/YYYY')
 as spend_date,
        try_to_number(replace(spend_amount, '$', '')) as spend_amount,
        lower(currency) as currency,
        
    nullif(
        case 
            when lower(notes) in ('', 'n/a', 'none', 'null', '-') then null 
            else notes
        end,
        ''
    )
 as notes,
        row_number() over (partition by spend_id order by spend_date) as rn
    from source
)

select * from cleaned where rn = 1
        );
[0m16:43:59.415985 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.103 seconds
[0m16:43:59.418984 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ab379f37-f3e5-4500-86c2-958d75d88dce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD074BC4A0>]}
[0m16:43:59.419985 [info ] [Thread-1 (]: 5 of 5 OK created sql table model marketing.stg_spend .......................... [[32mSUCCESS 1[0m in 1.11s]
[0m16:43:59.420983 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_spend
[0m16:43:59.421984 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:59.422984 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m16:43:59.422984 [debug] [MainThread]: On list_MARKETING: Close
[0m16:43:59.628917 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m16:43:59.629980 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m16:43:59.799548 [debug] [MainThread]: Connection 'model.Marketing.stg_spend' was left open.
[0m16:43:59.800549 [debug] [MainThread]: On model.Marketing.stg_spend: Close
[0m16:43:59.966961 [info ] [MainThread]: 
[0m16:43:59.967946 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 9.79 seconds (9.79s).
[0m16:43:59.968956 [debug] [MainThread]: Command end result
[0m16:43:59.995212 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m16:43:59.997213 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m16:44:00.004213 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\run_results.json
[0m16:44:00.004213 [info ] [MainThread]: 
[0m16:44:00.005400 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:44:00.006413 [info ] [MainThread]: 
[0m16:44:00.006413 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:44:00.007408 [debug] [MainThread]: Command `dbt run` succeeded at 16:44:00.007408 after 11.48 seconds
[0m16:44:00.008430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD01C33AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD06F4F6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD04114C20>]}
[0m16:44:00.008937 [debug] [MainThread]: Flushing usage events
[0m16:44:04.395332 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:46:00.428008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002052DD72630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002052BB9DF10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002052E288980>]}


============================== 16:46:00.435395 | fbea7dc2-4f1f-4b3a-bed6-72923dad50dd ==============================
[0m16:46:00.435395 [info ] [MainThread]: Running with dbt=1.9.4
[0m16:46:00.436394 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\RAJGOKUL R M\\Documents\\DE_FINAL\\marketing\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\RAJGOKUL R M\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select staging', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:46:00.880177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbea7dc2-4f1f-4b3a-bed6-72923dad50dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002052DD1E9C0>]}
[0m16:46:00.938177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbea7dc2-4f1f-4b3a-bed6-72923dad50dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002052F2154C0>]}
[0m16:46:00.940177 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m16:46:01.170797 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m16:46:01.348973 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:46:01.349974 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_channels.sql
[0m16:46:01.699476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbea7dc2-4f1f-4b3a-bed6-72923dad50dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020530A9B380>]}
[0m16:46:01.831475 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m16:46:01.834476 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m16:46:01.858669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbea7dc2-4f1f-4b3a-bed6-72923dad50dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020530A74830>]}
[0m16:46:01.858669 [info ] [MainThread]: Found 8 models, 6 data tests, 5 sources, 479 macros
[0m16:46:01.859697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbea7dc2-4f1f-4b3a-bed6-72923dad50dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020530A9B3E0>]}
[0m16:46:01.861703 [info ] [MainThread]: 
[0m16:46:01.861703 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:46:01.862711 [info ] [MainThread]: 
[0m16:46:01.863704 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:46:01.867702 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m16:46:01.942097 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m16:46:01.943098 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m16:46:01.943098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:03.323063 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.379 seconds
[0m16:46:03.326797 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m16:46:03.337449 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m16:46:03.338450 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m16:46:03.338450 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:04.283184 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.945 seconds
[0m16:46:04.287199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbea7dc2-4f1f-4b3a-bed6-72923dad50dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002052E37BCB0>]}
[0m16:46:04.291041 [debug] [Thread-1 (]: Began running node model.Marketing.stg_campaigns
[0m16:46:04.292056 [info ] [Thread-1 (]: 1 of 5 START sql table model marketing.stg_campaigns ........................... [RUN]
[0m16:46:04.293055 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.stg_campaigns'
[0m16:46:04.293055 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_campaigns
[0m16:46:04.304049 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_campaigns"
[0m16:46:04.305048 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_campaigns
[0m16:46:04.335048 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_campaigns"
[0m16:46:04.337048 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_campaigns"
[0m16:46:04.337048 [debug] [Thread-1 (]: On model.Marketing.stg_campaigns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_campaigns"} */
create or replace transient table MARKETING.marketing.stg_campaigns
         as
        (with source as (
    select * from MARKETING.raw.raw_campaigns
),

deduped as (
    select *,
        row_number() over (
            partition by campaign_id
            order by end_date desc
        ) as rn
    from source
),

cleaned as (
    select
        campaign_id,
        
    lower(trim(nullif(campaign_name, '')))
 as campaign_name,
        upper(
    lower(trim(nullif(channel_id, '')))
) as channel_id,
        
    try_to_date(start_date, 'DD/MM/YYYY')
 as start_date,
        
    try_to_date(end_date, 'DD-MM-YYYY')
 as end_date,
        initcap(trim(nullif(status, ''))) as status,
        
    lower(trim(nullif(owner, '')))
 as owner,
        split(tags, ',') as tag_list
    from deduped
    where rn = 1
)

select * from cleaned
        );
[0m16:46:04.338053 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:46:05.644171 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.306 seconds
[0m16:46:05.668700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbea7dc2-4f1f-4b3a-bed6-72923dad50dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002052B91B830>]}
[0m16:46:05.669714 [info ] [Thread-1 (]: 1 of 5 OK created sql table model marketing.stg_campaigns ...................... [[32mSUCCESS 1[0m in 1.37s]
[0m16:46:05.670727 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_campaigns
[0m16:46:05.670727 [debug] [Thread-1 (]: Began running node model.Marketing.stg_channels
[0m16:46:05.671730 [info ] [Thread-1 (]: 2 of 5 START sql table model marketing.stg_channels ............................ [RUN]
[0m16:46:05.672722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_campaigns, now model.Marketing.stg_channels)
[0m16:46:05.672722 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_channels
[0m16:46:05.676412 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_channels"
[0m16:46:05.677494 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_channels
[0m16:46:05.680008 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_channels"
[0m16:46:05.681446 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_channels"
[0m16:46:05.681955 [debug] [Thread-1 (]: On model.Marketing.stg_channels: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_channels"} */
create or replace transient table MARKETING.marketing.stg_channels
         as
        (with source as (
    select * from MARKETING.raw.raw_channels
),

deduped as (
    select *,
        row_number() over (
            partition by channel_id
            order by channel_id  -- can add other tie-breakers if needed
        ) as rn
    from source
),

cleaned as (
    select
        upper(trim(nullif(channel_id, ''))) as channel_id,
        lower(trim(nullif(channel_name, ''))) as channel_name,
        lower(trim(nullif(channel_type, ''))) as channel_type,
        initcap(trim(nullif(region, ''))) as region,
        
    nullif(
        case 
            when lower(description) in ('', 'n/a', 'none', 'null', '-') then null 
            else description
        end,
        ''
    )
 as description
    from deduped
    where rn = 1
)

select * from cleaned
        );
[0m16:46:06.306407 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m16:46:06.310302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbea7dc2-4f1f-4b3a-bed6-72923dad50dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020530FCAB70>]}
[0m16:46:06.310302 [info ] [Thread-1 (]: 2 of 5 OK created sql table model marketing.stg_channels ....................... [[32mSUCCESS 1[0m in 0.64s]
[0m16:46:06.311309 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_channels
[0m16:46:06.312456 [debug] [Thread-1 (]: Began running node model.Marketing.stg_leads
[0m16:46:06.312960 [info ] [Thread-1 (]: 3 of 5 START sql table model marketing.stg_leads ............................... [RUN]
[0m16:46:06.312960 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_channels, now model.Marketing.stg_leads)
[0m16:46:06.314445 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_leads
[0m16:46:06.320047 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_leads"
[0m16:46:06.321046 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_leads
[0m16:46:06.324046 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_leads"
[0m16:46:06.326491 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_leads"
[0m16:46:06.326491 [debug] [Thread-1 (]: On model.Marketing.stg_leads: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_leads"} */
create or replace transient table MARKETING.marketing.stg_leads
         as
        (with source as (
    select  * from MARKETING.raw.raw_leads
),

cleaned as (
    select
        lead_id,
        campaign_id,
        lower(trim(nullif(lead_source, ''))) as lead_source,
        
    case 
        when lower(converted) in ('1', 'true', 'yes') then true
        when lower(converted) in ('0', 'false', 'no') then false
        else null
    end
 as is_converted,
        initcap(trim(nullif(name, ''))) as name,
        lower(trim(nullif(email, ''))) as email,
        converted_date,
        row_number() over (partition by lead_id order by lead_id) as rn
    from source
)

select * from cleaned where rn = 1
        );
[0m16:46:06.942254 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.615 seconds
[0m16:46:06.945256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbea7dc2-4f1f-4b3a-bed6-72923dad50dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020530FE3980>]}
[0m16:46:06.945256 [info ] [Thread-1 (]: 3 of 5 OK created sql table model marketing.stg_leads .......................... [[32mSUCCESS 1[0m in 0.63s]
[0m16:46:06.946685 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_leads
[0m16:46:06.947870 [debug] [Thread-1 (]: Began running node model.Marketing.stg_revenue
[0m16:46:06.947870 [info ] [Thread-1 (]: 4 of 5 START sql table model marketing.stg_revenue ............................. [RUN]
[0m16:46:06.949049 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_leads, now model.Marketing.stg_revenue)
[0m16:46:06.950119 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_revenue
[0m16:46:06.953128 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_revenue"
[0m16:46:06.954129 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_revenue
[0m16:46:06.957128 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_revenue"
[0m16:46:06.958128 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_revenue"
[0m16:46:06.959128 [debug] [Thread-1 (]: On model.Marketing.stg_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_revenue"} */
create or replace transient table MARKETING.marketing.stg_revenue
         as
        (with source as (
    select  * from MARKETING.raw.raw_revenue
),

cleaned as (
    select
        lead_id,
        campaign_id,
        lower(trim(nullif(lead_source, ''))) as lead_source,
        
    case 
        when lower(converted) in ('1', 'true', 'yes') then true
        when lower(converted) in ('0', 'false', 'no') then false
        else null
    end
 as is_converted,
        revenue,
        cast(revenue_date as date) as revenue_date,
        row_number() over (partition by lead_id, campaign_id order by revenue_date) as rn
    from source
)

select * from cleaned where rn = 1
        );
[0m16:46:07.525911 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.566 seconds
[0m16:46:07.528910 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbea7dc2-4f1f-4b3a-bed6-72923dad50dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020530FE2300>]}
[0m16:46:07.528910 [info ] [Thread-1 (]: 4 of 5 OK created sql table model marketing.stg_revenue ........................ [[32mSUCCESS 1[0m in 0.58s]
[0m16:46:07.530925 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_revenue
[0m16:46:07.530925 [debug] [Thread-1 (]: Began running node model.Marketing.stg_spend
[0m16:46:07.531909 [info ] [Thread-1 (]: 5 of 5 START sql table model marketing.stg_spend ............................... [RUN]
[0m16:46:07.532912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_revenue, now model.Marketing.stg_spend)
[0m16:46:07.533914 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_spend
[0m16:46:07.537912 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_spend"
[0m16:46:07.538913 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_spend
[0m16:46:07.542218 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_spend"
[0m16:46:07.543219 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_spend"
[0m16:46:07.544219 [debug] [Thread-1 (]: On model.Marketing.stg_spend: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_spend"} */
create or replace transient table MARKETING.marketing.stg_spend
         as
        (with source as (
    select  * from MARKETING.raw.raw_spend
),

cleaned as (
    select
        spend_id,
        campaign_id,
        
    try_to_date(spend_date, 'DD/MM/YYYY')
 as spend_date,
        try_to_number(replace(spend_amount, '$', '')) as spend_amount,
        lower(currency) as currency,
        
    nullif(
        case 
            when lower(notes) in ('', 'n/a', 'none', 'null', '-') then null 
            else notes
        end,
        ''
    )
 as notes,
        row_number() over (partition by spend_id order by spend_date) as rn
    from source
)

select * from cleaned where rn = 1
        );
[0m16:46:08.251532 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.707 seconds
[0m16:46:08.254531 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fbea7dc2-4f1f-4b3a-bed6-72923dad50dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020530E725A0>]}
[0m16:46:08.255531 [info ] [Thread-1 (]: 5 of 5 OK created sql table model marketing.stg_spend .......................... [[32mSUCCESS 1[0m in 0.72s]
[0m16:46:08.255531 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_spend
[0m16:46:08.258479 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:46:08.258479 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m16:46:08.259478 [debug] [MainThread]: On list_MARKETING: Close
[0m16:46:08.573891 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m16:46:08.573891 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m16:46:08.785277 [debug] [MainThread]: Connection 'model.Marketing.stg_spend' was left open.
[0m16:46:08.786277 [debug] [MainThread]: On model.Marketing.stg_spend: Close
[0m16:46:09.023733 [info ] [MainThread]: 
[0m16:46:09.024735 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 7.16 seconds (7.16s).
[0m16:46:09.026733 [debug] [MainThread]: Command end result
[0m16:46:09.055435 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m16:46:09.058434 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m16:46:09.070164 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\run_results.json
[0m16:46:09.070164 [info ] [MainThread]: 
[0m16:46:09.071159 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:46:09.071159 [info ] [MainThread]: 
[0m16:46:09.072559 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m16:46:09.073567 [debug] [MainThread]: Command `dbt run` succeeded at 16:46:09.073567 after 8.76 seconds
[0m16:46:09.074832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002052B9448C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002052B944200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002052E0D4380>]}
[0m16:46:09.075844 [debug] [MainThread]: Flushing usage events
[0m16:46:13.698850 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:18:31.564371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B091719490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B090CADA00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B090CACB00>]}


============================== 17:18:31.575235 | dd566a21-53c7-4688-b96a-48bf30532df1 ==============================
[0m17:18:31.575235 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:18:31.576255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RAJGOKUL R M\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\RAJGOKUL R M\\Documents\\DE_FINAL\\marketing\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:18:32.516888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd566a21-53c7-4688-b96a-48bf30532df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B090CD43E0>]}
[0m17:18:32.625570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd566a21-53c7-4688-b96a-48bf30532df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0923CFBF0>]}
[0m17:18:32.627907 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:18:33.051807 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:18:33.375849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:18:33.376848 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:18:33.450332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd566a21-53c7-4688-b96a-48bf30532df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0936461B0>]}
[0m17:18:33.587566 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m17:18:33.595161 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m17:18:33.658704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd566a21-53c7-4688-b96a-48bf30532df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0939EAFC0>]}
[0m17:18:33.659718 [info ] [MainThread]: Found 8 models, 6 data tests, 5 sources, 479 macros
[0m17:18:33.660736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd566a21-53c7-4688-b96a-48bf30532df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B093836C90>]}
[0m17:18:33.664201 [info ] [MainThread]: 
[0m17:18:33.665201 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:18:33.666562 [info ] [MainThread]: 
[0m17:18:33.667924 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:18:33.676436 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m17:18:33.911395 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m17:18:33.912396 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m17:18:33.912396 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:38.231697 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 4.319 seconds
[0m17:18:38.237619 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m17:18:38.253742 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m17:18:38.254742 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m17:18:38.255721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:39.422253 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.167 seconds
[0m17:18:39.428911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd566a21-53c7-4688-b96a-48bf30532df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B091820050>]}
[0m17:18:39.439710 [debug] [Thread-1 (]: Began running node model.Marketing.stg_campaigns
[0m17:18:39.440711 [info ] [Thread-1 (]: 1 of 5 START sql table model marketing.stg_campaigns ........................... [RUN]
[0m17:18:39.442711 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.stg_campaigns'
[0m17:18:39.442711 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_campaigns
[0m17:18:39.470130 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_campaigns"
[0m17:18:39.473320 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_campaigns
[0m17:18:39.537826 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_campaigns"
[0m17:18:39.541907 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_campaigns"
[0m17:18:39.543544 [debug] [Thread-1 (]: On model.Marketing.stg_campaigns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_campaigns"} */
create or replace transient table MARKETING.marketing.stg_campaigns
         as
        (with source as (
    select * from MARKETING.raw.raw_campaigns
),

deduped as (
    select *,
        row_number() over (
            partition by campaign_id
            order by end_date desc
        ) as rn
    from source
),

cleaned as (
    select
        campaign_id,
        
    lower(trim(nullif(campaign_name, '')))
 as campaign_name,
        upper(
    lower(trim(nullif(channel_id, '')))
) as channel_id,
        
    try_to_date(start_date, 'DD/MM/YYYY')
 as start_date,
        
    try_to_date(end_date, 'DD-MM-YYYY')
 as end_date,
        initcap(trim(nullif(status, ''))) as status,
        
    lower(trim(nullif(owner, '')))
 as owner,
        split(tags, ',') as tag_list
    from deduped
    where rn = 1
)

select * from cleaned
        );
[0m17:18:39.543544 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:18:40.891751 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.347 seconds
[0m17:18:41.100277 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd566a21-53c7-4688-b96a-48bf30532df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0938EE840>]}
[0m17:18:41.102265 [info ] [Thread-1 (]: 1 of 5 OK created sql table model marketing.stg_campaigns ...................... [[32mSUCCESS 1[0m in 1.65s]
[0m17:18:41.104651 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_campaigns
[0m17:18:41.105177 [debug] [Thread-1 (]: Began running node model.Marketing.stg_channels
[0m17:18:41.106701 [info ] [Thread-1 (]: 2 of 5 START sql table model marketing.stg_channels ............................ [RUN]
[0m17:18:41.107725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_campaigns, now model.Marketing.stg_channels)
[0m17:18:41.109256 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_channels
[0m17:18:41.120305 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_channels"
[0m17:18:41.123121 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_channels
[0m17:18:41.127533 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_channels"
[0m17:18:41.134511 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_channels"
[0m17:18:41.136520 [debug] [Thread-1 (]: On model.Marketing.stg_channels: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_channels"} */
create or replace transient table MARKETING.marketing.stg_channels
         as
        (with source as (
    select * from MARKETING.raw.raw_channels
),

deduped as (
    select *,
        row_number() over (
            partition by channel_id
            order by channel_id  -- can add other tie-breakers if needed
        ) as rn
    from source
),

cleaned as (
    select
        upper(trim(nullif(channel_id, ''))) as channel_id,
        lower(trim(nullif(channel_name, ''))) as channel_name,
        lower(trim(nullif(channel_type, ''))) as channel_type,
        initcap(trim(nullif(region, ''))) as region,
        
    nullif(
        case 
            when lower(description) in ('', 'n/a', 'none', 'null', '-') then null 
            else description
        end,
        ''
    )
 as description
    from deduped
    where rn = 1
)

select * from cleaned
        );
[0m17:18:41.874982 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.738 seconds
[0m17:18:41.880537 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd566a21-53c7-4688-b96a-48bf30532df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B093EE34D0>]}
[0m17:18:41.881537 [info ] [Thread-1 (]: 2 of 5 OK created sql table model marketing.stg_channels ....................... [[32mSUCCESS 1[0m in 0.77s]
[0m17:18:41.882618 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_channels
[0m17:18:41.884595 [debug] [Thread-1 (]: Began running node model.Marketing.stg_leads
[0m17:18:41.885607 [info ] [Thread-1 (]: 3 of 5 START sql table model marketing.stg_leads ............................... [RUN]
[0m17:18:41.886606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_channels, now model.Marketing.stg_leads)
[0m17:18:41.887607 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_leads
[0m17:18:41.895606 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_leads"
[0m17:18:41.897609 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_leads
[0m17:18:41.903592 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_leads"
[0m17:18:41.908450 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_leads"
[0m17:18:41.909450 [debug] [Thread-1 (]: On model.Marketing.stg_leads: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_leads"} */
create or replace transient table MARKETING.marketing.stg_leads
         as
        (with source as (
    select  * from MARKETING.raw.raw_leads
),

cleaned as (
    select
        lead_id,
        campaign_id,
        lower(trim(nullif(lead_source, ''))) as lead_source,
        
    case 
        when lower(converted) in ('1', 'true', 'yes') then true
        when lower(converted) in ('0', 'false', 'no') then false
        else null
    end
 as is_converted,
        initcap(trim(nullif(name, ''))) as name,
        lower(trim(nullif(email, ''))) as email,
        converted_date,
        row_number() over (partition by lead_id order by lead_id) as rn
    from source
)

select * from cleaned where rn = 1
        );
[0m17:18:42.704830 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.794 seconds
[0m17:18:42.708830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd566a21-53c7-4688-b96a-48bf30532df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B093A63BF0>]}
[0m17:18:42.709829 [info ] [Thread-1 (]: 3 of 5 OK created sql table model marketing.stg_leads .......................... [[32mSUCCESS 1[0m in 0.82s]
[0m17:18:42.711834 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_leads
[0m17:18:42.712830 [debug] [Thread-1 (]: Began running node model.Marketing.stg_revenue
[0m17:18:42.714189 [info ] [Thread-1 (]: 4 of 5 START sql table model marketing.stg_revenue ............................. [RUN]
[0m17:18:42.714716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_leads, now model.Marketing.stg_revenue)
[0m17:18:42.716053 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_revenue
[0m17:18:42.724608 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_revenue"
[0m17:18:42.726609 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_revenue
[0m17:18:42.730607 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_revenue"
[0m17:18:42.733608 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_revenue"
[0m17:18:42.735611 [debug] [Thread-1 (]: On model.Marketing.stg_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_revenue"} */
create or replace transient table MARKETING.marketing.stg_revenue
         as
        (with source as (
    select  * from MARKETING.raw.raw_revenue
),

cleaned as (
    select
        lead_id,
        campaign_id,
        lower(trim(nullif(lead_source, ''))) as lead_source,
        
    case 
        when lower(converted) in ('1', 'true', 'yes') then true
        when lower(converted) in ('0', 'false', 'no') then false
        else null
    end
 as is_converted,
        revenue,
        cast(revenue_date as date) as revenue_date,
        row_number() over (partition by lead_id, campaign_id order by revenue_date) as rn
    from source
)

select * from cleaned where rn = 1
        );
[0m17:18:43.402749 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.666 seconds
[0m17:18:43.406750 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd566a21-53c7-4688-b96a-48bf30532df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B093F8E510>]}
[0m17:18:43.407750 [info ] [Thread-1 (]: 4 of 5 OK created sql table model marketing.stg_revenue ........................ [[32mSUCCESS 1[0m in 0.69s]
[0m17:18:43.409988 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_revenue
[0m17:18:43.411423 [debug] [Thread-1 (]: Began running node model.Marketing.stg_spend
[0m17:18:43.411949 [info ] [Thread-1 (]: 5 of 5 START sql table model marketing.stg_spend ............................... [RUN]
[0m17:18:43.413219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_revenue, now model.Marketing.stg_spend)
[0m17:18:43.414384 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_spend
[0m17:18:43.422073 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_spend"
[0m17:18:43.424071 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_spend
[0m17:18:43.428071 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_spend"
[0m17:18:43.432073 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_spend"
[0m17:18:43.433071 [debug] [Thread-1 (]: On model.Marketing.stg_spend: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_spend"} */
create or replace transient table MARKETING.marketing.stg_spend
         as
        (with source as (
    select  * from MARKETING.raw.raw_spend
),

cleaned as (
    select
        spend_id,
        campaign_id,
        
    try_to_date(spend_date, 'DD/MM/YYYY')
 as spend_date,
        try_to_number(replace(spend_amount, '$', '')) as spend_amount,
        lower(currency) as currency,
        
    nullif(
        case 
            when lower(notes) in ('', 'n/a', 'none', 'null', '-') then null 
            else notes
        end,
        ''
    )
 as notes,
        row_number() over (partition by spend_id order by spend_date) as rn
    from source
)

select * from cleaned where rn = 1
        );
[0m17:18:44.475156 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.042 seconds
[0m17:18:44.479156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd566a21-53c7-4688-b96a-48bf30532df1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B093F8F260>]}
[0m17:18:44.480155 [info ] [Thread-1 (]: 5 of 5 OK created sql table model marketing.stg_spend .......................... [[32mSUCCESS 1[0m in 1.06s]
[0m17:18:44.482157 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_spend
[0m17:18:44.484324 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:44.484851 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m17:18:44.485866 [debug] [MainThread]: On list_MARKETING: Close
[0m17:18:44.887121 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m17:18:44.888102 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m17:18:45.296844 [debug] [MainThread]: Connection 'model.Marketing.stg_spend' was left open.
[0m17:18:45.297843 [debug] [MainThread]: On model.Marketing.stg_spend: Close
[0m17:18:45.808134 [info ] [MainThread]: 
[0m17:18:45.810137 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 12.14 seconds (12.14s).
[0m17:18:45.812156 [debug] [MainThread]: Command end result
[0m17:18:45.863779 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m17:18:45.868625 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m17:18:45.880694 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\run_results.json
[0m17:18:45.881817 [info ] [MainThread]: 
[0m17:18:45.883275 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:18:45.883275 [info ] [MainThread]: 
[0m17:18:45.885762 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:18:45.887698 [debug] [MainThread]: Command `dbt run` succeeded at 17:18:45.886373 after 14.51 seconds
[0m17:18:45.887698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B0912A8860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B08E93B7D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B093F77050>]}
[0m17:18:45.888722 [debug] [MainThread]: Flushing usage events
[0m17:18:48.902352 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:27:19.606630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4D01DBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4D48EE10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4D48F800>]}


============================== 17:27:19.616105 | 0b744309-7647-4287-a949-c29dd09c56c1 ==============================
[0m17:27:19.616105 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:27:19.618260 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\RAJGOKUL R M\\Documents\\DE_FINAL\\marketing\\logs', 'profiles_dir': 'C:\\Users\\RAJGOKUL R M\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select staging', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:27:20.499382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b744309-7647-4287-a949-c29dd09c56c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4DDE88F0>]}
[0m17:27:20.607041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b744309-7647-4287-a949-c29dd09c56c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4AB13140>]}
[0m17:27:20.609022 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:27:21.021716 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:27:21.328716 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 5 files changed.
[0m17:27:21.330716 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_campaigns.sql
[0m17:27:21.331716 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_spend.sql
[0m17:27:21.332716 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_channels.sql
[0m17:27:21.333716 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_leads.sql
[0m17:27:21.334716 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_revenue.sql
[0m17:27:22.185377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b744309-7647-4287-a949-c29dd09c56c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4FE61430>]}
[0m17:27:22.335659 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m17:27:22.342999 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m17:27:22.404340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b744309-7647-4287-a949-c29dd09c56c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4B5DAFC0>]}
[0m17:27:22.405432 [info ] [MainThread]: Found 8 models, 6 data tests, 5 sources, 479 macros
[0m17:27:22.406525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b744309-7647-4287-a949-c29dd09c56c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4FBD5A00>]}
[0m17:27:22.410322 [info ] [MainThread]: 
[0m17:27:22.411387 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:27:22.412473 [info ] [MainThread]: 
[0m17:27:22.414199 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:27:22.424636 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m17:27:22.573019 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m17:27:22.574019 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m17:27:22.574019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:27.678713 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 5.104 seconds
[0m17:27:27.684726 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m17:27:27.710862 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m17:27:27.711869 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m17:27:27.712854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:28.905281 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.192 seconds
[0m17:27:28.912253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b744309-7647-4287-a949-c29dd09c56c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4FDDCF50>]}
[0m17:27:28.920252 [debug] [Thread-1 (]: Began running node model.Marketing.stg_campaigns
[0m17:27:28.921273 [info ] [Thread-1 (]: 1 of 5 START sql table model marketing.stg_campaigns ........................... [RUN]
[0m17:27:28.922252 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.stg_campaigns'
[0m17:27:28.923252 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_campaigns
[0m17:27:28.942865 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_campaigns"
[0m17:27:28.944864 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_campaigns
[0m17:27:29.024333 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_campaigns"
[0m17:27:29.029395 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_campaigns"
[0m17:27:29.030372 [debug] [Thread-1 (]: On model.Marketing.stg_campaigns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_campaigns"} */
create or replace transient table MARKETING.marketing.stg_campaigns
         as
        (with source as (
    select * from MARKETING.raw.raw_campaigns
),


cleaned as (
    select
        campaign_id,
        
    lower(trim(nullif(campaign_name, '')))
 as campaign_name,
        upper(
    lower(trim(nullif(channel_id, '')))
) as channel_id,
        
    try_to_date(start_date, 'DD/MM/YYYY')
 as start_date,
        
    try_to_date(end_date, 'DD-MM-YYYY')
 as end_date,
        initcap(trim(nullif(status, ''))) as status,
        
    lower(trim(nullif(owner, '')))
 as owner,
        split(tags, ',') as tag_list
    from source
)

select * from cleaned
        );
[0m17:27:29.031394 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:27:30.749035 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.717 seconds
[0m17:27:30.792708 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b744309-7647-4287-a949-c29dd09c56c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4CF73F20>]}
[0m17:27:30.795004 [info ] [Thread-1 (]: 1 of 5 OK created sql table model marketing.stg_campaigns ...................... [[32mSUCCESS 1[0m in 1.87s]
[0m17:27:30.797005 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_campaigns
[0m17:27:30.798000 [debug] [Thread-1 (]: Began running node model.Marketing.stg_channels
[0m17:27:30.799211 [info ] [Thread-1 (]: 2 of 5 START sql table model marketing.stg_channels ............................ [RUN]
[0m17:27:30.800243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_campaigns, now model.Marketing.stg_channels)
[0m17:27:30.801400 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_channels
[0m17:27:30.810418 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_channels"
[0m17:27:30.812950 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_channels
[0m17:27:30.821924 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_channels"
[0m17:27:30.825434 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_channels"
[0m17:27:30.825959 [debug] [Thread-1 (]: On model.Marketing.stg_channels: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_channels"} */
create or replace transient table MARKETING.marketing.stg_channels
         as
        (with source as (
    select * from MARKETING.raw.raw_channels
),



cleaned as (
    select
        upper(trim(nullif(channel_id, ''))) as channel_id,
        lower(trim(nullif(channel_name, ''))) as channel_name,
        lower(trim(nullif(channel_type, ''))) as channel_type,
        initcap(trim(nullif(region, ''))) as region,
        
    nullif(
        case 
            when lower(description) in ('', 'n/a', 'none', 'null', '-') then null 
            else description
        end,
        ''
    )
 as description
    from source
)

select * from cleaned
        );
[0m17:27:31.733371 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.907 seconds
[0m17:27:31.738200 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b744309-7647-4287-a949-c29dd09c56c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4F968D10>]}
[0m17:27:31.739204 [info ] [Thread-1 (]: 2 of 5 OK created sql table model marketing.stg_channels ....................... [[32mSUCCESS 1[0m in 0.94s]
[0m17:27:31.741183 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_channels
[0m17:27:31.741183 [debug] [Thread-1 (]: Began running node model.Marketing.stg_leads
[0m17:27:31.742286 [info ] [Thread-1 (]: 3 of 5 START sql table model marketing.stg_leads ............................... [RUN]
[0m17:27:31.743666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_channels, now model.Marketing.stg_leads)
[0m17:27:31.744927 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_leads
[0m17:27:31.750832 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_leads"
[0m17:27:31.752821 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_leads
[0m17:27:31.757809 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_leads"
[0m17:27:31.760812 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_leads"
[0m17:27:31.761812 [debug] [Thread-1 (]: On model.Marketing.stg_leads: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_leads"} */
create or replace transient table MARKETING.marketing.stg_leads
         as
        (with source as (
    select  * from MARKETING.raw.raw_leads
),

cleaned as (
    select
        lead_id,
        campaign_id,
        lower(trim(nullif(lead_source, ''))) as lead_source,
        
    case 
        when lower(converted) in ('1', 'true', 'yes') then true
        when lower(converted) in ('0', 'false', 'no') then false
        else null
    end
 as is_converted,
        initcap(trim(nullif(name, ''))) as name,
        lower(trim(nullif(email, ''))) as email,
        converted_date,
    from source
)

select * from cleaned
        );
[0m17:27:32.478210 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.715 seconds
[0m17:27:32.482206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b744309-7647-4287-a949-c29dd09c56c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF502DEED0>]}
[0m17:27:32.483189 [info ] [Thread-1 (]: 3 of 5 OK created sql table model marketing.stg_leads .......................... [[32mSUCCESS 1[0m in 0.74s]
[0m17:27:32.485397 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_leads
[0m17:27:32.486702 [debug] [Thread-1 (]: Began running node model.Marketing.stg_revenue
[0m17:27:32.486702 [info ] [Thread-1 (]: 4 of 5 START sql table model marketing.stg_revenue ............................. [RUN]
[0m17:27:32.488151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_leads, now model.Marketing.stg_revenue)
[0m17:27:32.489655 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_revenue
[0m17:27:32.496221 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_revenue"
[0m17:27:32.497206 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_revenue
[0m17:27:32.503018 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_revenue"
[0m17:27:32.508020 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_revenue"
[0m17:27:32.509019 [debug] [Thread-1 (]: On model.Marketing.stg_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_revenue"} */
create or replace transient table MARKETING.marketing.stg_revenue
         as
        (with source as (
    select  * from MARKETING.raw.raw_revenue
),

cleaned as (
    select
        lead_id,
        campaign_id,
        lower(trim(nullif(lead_source, ''))) as lead_source,
        
    case 
        when lower(converted) in ('1', 'true', 'yes') then true
        when lower(converted) in ('0', 'false', 'no') then false
        else null
    end
 as is_converted,
        revenue,
        cast(revenue_date as date) as revenue_date,
    from source
)

select * from cleaned
        );
[0m17:27:33.091977 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.581 seconds
[0m17:27:33.094975 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b744309-7647-4287-a949-c29dd09c56c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF5024A420>]}
[0m17:27:33.096976 [info ] [Thread-1 (]: 4 of 5 OK created sql table model marketing.stg_revenue ........................ [[32mSUCCESS 1[0m in 0.61s]
[0m17:27:33.097976 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_revenue
[0m17:27:33.098977 [debug] [Thread-1 (]: Began running node model.Marketing.stg_spend
[0m17:27:33.099976 [info ] [Thread-1 (]: 5 of 5 START sql table model marketing.stg_spend ............................... [RUN]
[0m17:27:33.100979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_revenue, now model.Marketing.stg_spend)
[0m17:27:33.102036 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_spend
[0m17:27:33.107980 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_spend"
[0m17:27:33.108982 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_spend
[0m17:27:33.115334 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_spend"
[0m17:27:33.118541 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_spend"
[0m17:27:33.119575 [debug] [Thread-1 (]: On model.Marketing.stg_spend: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_spend"} */
create or replace transient table MARKETING.marketing.stg_spend
         as
        (with source as (
    select  * from MARKETING.raw.raw_spend
),

cleaned as (
    select
        spend_id,
        campaign_id,
        
    try_to_date(spend_date, 'DD/MM/YYYY')
 as spend_date,
        try_to_number(replace(spend_amount, '$', '')) as spend_amount,
        lower(currency) as currency,
        
    nullif(
        case 
            when lower(notes) in ('', 'n/a', 'none', 'null', '-') then null 
            else notes
        end,
        ''
    )
 as notes,
    from source
)

select * from cleaned
        );
[0m17:27:33.696207 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.576 seconds
[0m17:27:33.700195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b744309-7647-4287-a949-c29dd09c56c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF50232BA0>]}
[0m17:27:33.701907 [info ] [Thread-1 (]: 5 of 5 OK created sql table model marketing.stg_spend .......................... [[32mSUCCESS 1[0m in 0.60s]
[0m17:27:33.703624 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_spend
[0m17:27:33.705887 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:27:33.707064 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m17:27:33.708080 [debug] [MainThread]: On list_MARKETING: Close
[0m17:27:34.017146 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m17:27:34.017672 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m17:27:34.315652 [debug] [MainThread]: Connection 'model.Marketing.stg_spend' was left open.
[0m17:27:34.316656 [debug] [MainThread]: On model.Marketing.stg_spend: Close
[0m17:27:34.639893 [info ] [MainThread]: 
[0m17:27:34.640899 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 12.23 seconds (12.23s).
[0m17:27:34.643507 [debug] [MainThread]: Command end result
[0m17:27:34.699929 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m17:27:34.706277 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m17:27:34.723772 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\run_results.json
[0m17:27:34.724779 [info ] [MainThread]: 
[0m17:27:34.725774 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:27:34.726780 [info ] [MainThread]: 
[0m17:27:34.727776 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:27:34.731125 [debug] [MainThread]: Command `dbt run` succeeded at 17:27:34.729774 after 15.32 seconds
[0m17:27:34.732134 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4D5C0200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4FDF5B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DF4E45DB20>]}
[0m17:27:34.733353 [debug] [MainThread]: Flushing usage events
[0m17:27:38.974973 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:51:19.052459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002258E568C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002258ED38C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002258ED3BEC0>]}


============================== 17:51:19.065275 | f6ceb33b-418e-45fd-9d91-7901eaa9bec6 ==============================
[0m17:51:19.065275 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:51:19.066350 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RAJGOKUL R M\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\RAJGOKUL R M\\Documents\\DE_FINAL\\marketing\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select int', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:51:19.957683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6ceb33b-418e-45fd-9d91-7901eaa9bec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022590DC7D70>]}
[0m17:51:20.054315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6ceb33b-418e-45fd-9d91-7901eaa9bec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002258F105130>]}
[0m17:51:20.057315 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:51:20.496825 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:51:20.814456 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 0 files changed.
[0m17:51:20.815455 [debug] [MainThread]: Partial parsing: added file: Marketing://models\int\int_lead_lifecycle.sql
[0m17:51:20.817455 [debug] [MainThread]: Partial parsing: added file: Marketing://models\int\int_channel_spend.sql
[0m17:51:20.817455 [debug] [MainThread]: Partial parsing: added file: Marketing://models\int\int_campaign_performance.sql
[0m17:51:20.819456 [debug] [MainThread]: Partial parsing: added file: Marketing://models\int\int_lead_conversion.sql
[0m17:51:21.282343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f6ceb33b-418e-45fd-9d91-7901eaa9bec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002259130E300>]}
[0m17:51:21.410343 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m17:51:21.416343 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m17:51:21.464780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f6ceb33b-418e-45fd-9d91-7901eaa9bec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022590FD1B50>]}
[0m17:51:21.465344 [info ] [MainThread]: Found 12 models, 6 data tests, 5 sources, 479 macros
[0m17:51:21.466343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f6ceb33b-418e-45fd-9d91-7901eaa9bec6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022591241070>]}
[0m17:51:21.469343 [info ] [MainThread]: 
[0m17:51:21.471343 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:51:21.472343 [info ] [MainThread]: 
[0m17:51:21.473343 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:51:21.481412 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m17:51:21.680944 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m17:51:21.681944 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m17:51:21.682933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:51:22.885391 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m17:51:22.886514 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:51:22.887526 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m17:51:22.888544 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:51:22.890487 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:51:22.890487 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m17:51:22.891515 [debug] [MainThread]: On list_MARKETING: No close available on handle
[0m17:51:22.893268 [info ] [MainThread]: 
[0m17:51:22.894284 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.42 seconds (1.42s).
[0m17:51:22.898285 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "MARKETING"
  Database Error
    250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting
[0m17:51:22.901280 [debug] [MainThread]: Command `dbt run` failed at 17:51:22.901280 after 4.04 seconds
[0m17:51:22.903492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002258EFDD340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225913A2E10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000225913CB3E0>]}
[0m17:51:22.904506 [debug] [MainThread]: Flushing usage events
[0m17:51:24.410874 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:52:45.680737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B882EE3710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B882EE1EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B882EE2F60>]}


============================== 17:52:45.689216 | ab5350f8-ac5b-4f7e-ad6f-7aa843858ecd ==============================
[0m17:52:45.689216 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:52:45.691205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RAJGOKUL R M\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\RAJGOKUL R M\\Documents\\DE_FINAL\\marketing\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select int', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:52:46.667282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab5350f8-ac5b-4f7e-ad6f-7aa843858ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B882A8D6A0>]}
[0m17:52:46.767202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab5350f8-ac5b-4f7e-ad6f-7aa843858ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8823FEA20>]}
[0m17:52:46.769199 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:52:47.185973 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:52:47.484542 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:52:47.485542 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:52:47.559111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab5350f8-ac5b-4f7e-ad6f-7aa843858ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B884CFDD00>]}
[0m17:52:47.782060 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m17:52:47.790700 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m17:52:47.848602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab5350f8-ac5b-4f7e-ad6f-7aa843858ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B885073E00>]}
[0m17:52:47.849631 [info ] [MainThread]: Found 12 models, 6 data tests, 5 sources, 479 macros
[0m17:52:47.851618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab5350f8-ac5b-4f7e-ad6f-7aa843858ecd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B884EA0D70>]}
[0m17:52:47.854635 [info ] [MainThread]: 
[0m17:52:47.856620 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:52:47.857615 [info ] [MainThread]: 
[0m17:52:47.858615 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:52:47.867791 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m17:52:48.039812 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m17:52:48.040816 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m17:52:48.041809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:49.279898 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m17:52:49.280885 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:52:49.280885 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m17:52:49.282164 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:52:49.283707 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:52:49.283707 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m17:52:49.285217 [debug] [MainThread]: On list_MARKETING: No close available on handle
[0m17:52:49.286245 [info ] [MainThread]: 
[0m17:52:49.287231 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.43 seconds (1.43s).
[0m17:52:49.288235 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "MARKETING"
  Database Error
    250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting
[0m17:52:49.290545 [debug] [MainThread]: Command `dbt run` failed at 17:52:49.290545 after 3.84 seconds
[0m17:52:49.291053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B882EE1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8850F5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B8850F5430>]}
[0m17:52:49.292082 [debug] [MainThread]: Flushing usage events
[0m17:52:51.261508 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:57:11.205562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611613AA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261134F4D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611613AAE0>]}


============================== 17:57:11.211965 | 7de167ae-e099-4c22-ba4e-7bd0d1948634 ==============================
[0m17:57:11.211965 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:57:11.213484 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\RAJGOKUL R M\\Documents\\DE_FINAL\\marketing\\logs', 'profiles_dir': 'C:\\Users\\RAJGOKUL R M\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select int', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:57:11.971207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7de167ae-e099-4c22-ba4e-7bd0d1948634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261182F56A0>]}
[0m17:57:12.067362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7de167ae-e099-4c22-ba4e-7bd0d1948634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026112B948C0>]}
[0m17:57:12.070268 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m17:57:12.510945 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:57:12.666789 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:57:12.668772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7de167ae-e099-4c22-ba4e-7bd0d1948634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611613A3F0>]}
[0m17:57:14.998547 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.Marketing.intermediate
[0m17:57:15.020827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7de167ae-e099-4c22-ba4e-7bd0d1948634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026118879250>]}
[0m17:57:15.204428 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m17:57:15.210407 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m17:57:15.257478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7de167ae-e099-4c22-ba4e-7bd0d1948634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026118A138C0>]}
[0m17:57:15.258479 [info ] [MainThread]: Found 12 models, 6 data tests, 5 sources, 479 macros
[0m17:57:15.259698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7de167ae-e099-4c22-ba4e-7bd0d1948634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026118773DD0>]}
[0m17:57:15.262256 [info ] [MainThread]: 
[0m17:57:15.263243 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:57:15.264577 [info ] [MainThread]: 
[0m17:57:15.266088 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:57:15.275550 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m17:57:15.411852 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m17:57:15.412930 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m17:57:15.413487 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:17.301726 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.888 seconds
[0m17:57:17.307994 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m17:57:17.327115 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m17:57:17.329114 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m17:57:17.329114 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:18.324436 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.994 seconds
[0m17:57:18.329429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7de167ae-e099-4c22-ba4e-7bd0d1948634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026118851DF0>]}
[0m17:57:18.336501 [debug] [Thread-1 (]: Began running node model.Marketing.int_campaign_performance
[0m17:57:18.337788 [info ] [Thread-1 (]: 1 of 4 START sql view model marketing.int_campaign_performance ................. [RUN]
[0m17:57:18.339170 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.int_campaign_performance'
[0m17:57:18.340198 [debug] [Thread-1 (]: Began compiling node model.Marketing.int_campaign_performance
[0m17:57:18.353213 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.int_campaign_performance"
[0m17:57:18.356211 [debug] [Thread-1 (]: Began executing node model.Marketing.int_campaign_performance
[0m17:57:18.408528 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.int_campaign_performance"
[0m17:57:18.411525 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.int_campaign_performance"
[0m17:57:18.413530 [debug] [Thread-1 (]: On model.Marketing.int_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.int_campaign_performance"} */
create or replace   view MARKETING.marketing.int_campaign_performance
  
   as (
    with campaigns as (
    select * from MARKETING.marketing.stg_campaigns
),
spend as (
    select * from MARKETING.marketing.stg_spend
),
revenue as (
    select * from MARKETING.marketing.stg_revenue
)

select 
    c.campaign_id,
    c.campaign_name,
    c.start_date,
    c.end_date,
    s.total_spend,
    r.total_revenue,
    (r.total_revenue - s.total_spend) / nullif(s.total_spend, 0) as roi
from campaigns c
left join spend s using (campaign_id)
left join revenue r using (campaign_id)
  );
[0m17:57:18.413530 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:57:19.405069 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbaeeb-3201-8a6f-0000-000cd70aa811
[0m17:57:19.406069 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 19 at position 4
invalid identifier 'S.TOTAL_SPEND'
[0m17:57:19.414061 [debug] [Thread-1 (]: Database Error in model int_campaign_performance (models\int\int_campaign_performance.sql)
  000904 (42000): SQL compilation error: error line 19 at position 4
  invalid identifier 'S.TOTAL_SPEND'
  compiled code at target\run\Marketing\models\int\int_campaign_performance.sql
[0m17:57:19.418208 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de167ae-e099-4c22-ba4e-7bd0d1948634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026118927230>]}
[0m17:57:19.419231 [error] [Thread-1 (]: 1 of 4 ERROR creating sql view model marketing.int_campaign_performance ........ [[31mERROR[0m in 1.08s]
[0m17:57:19.420947 [debug] [Thread-1 (]: Finished running node model.Marketing.int_campaign_performance
[0m17:57:19.422269 [debug] [Thread-1 (]: Began running node model.Marketing.int_channel_spend
[0m17:57:19.423287 [debug] [Thread-4 (]: Marking all children of 'model.Marketing.int_campaign_performance' to be skipped because of status 'error'.  Reason: Database Error in model int_campaign_performance (models\int\int_campaign_performance.sql)
  000904 (42000): SQL compilation error: error line 19 at position 4
  invalid identifier 'S.TOTAL_SPEND'
  compiled code at target\run\Marketing\models\int\int_campaign_performance.sql.
[0m17:57:19.424310 [info ] [Thread-1 (]: 2 of 4 START sql view model marketing.int_channel_spend ........................ [RUN]
[0m17:57:19.426893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.int_campaign_performance, now model.Marketing.int_channel_spend)
[0m17:57:19.427917 [debug] [Thread-1 (]: Began compiling node model.Marketing.int_channel_spend
[0m17:57:19.435918 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.int_channel_spend"
[0m17:57:19.438917 [debug] [Thread-1 (]: Began executing node model.Marketing.int_channel_spend
[0m17:57:19.444919 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.int_channel_spend"
[0m17:57:19.447918 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.int_channel_spend"
[0m17:57:19.449053 [debug] [Thread-1 (]: On model.Marketing.int_channel_spend: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.int_channel_spend"} */
create or replace   view MARKETING.marketing.int_channel_spend
  
   as (
    with spend as (
    select * from MARKETING.marketing.stg_spend
),
channels as (
    select * from MARKETING.marketing.stg_channels
)

select 
    s.channel_id,
    c.channel_name,
    s.spend_date,
    s.amount
from spend s
left join channels c on s.channel_id = c.channel_id
  );
[0m17:57:19.656704 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbaeeb-3201-8b94-0000-000cd70ae41d
[0m17:57:19.657705 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 12 at position 4
invalid identifier 'S.CHANNEL_ID'
[0m17:57:19.664295 [debug] [Thread-1 (]: Database Error in model int_channel_spend (models\int\int_channel_spend.sql)
  000904 (42000): SQL compilation error: error line 12 at position 4
  invalid identifier 'S.CHANNEL_ID'
  compiled code at target\run\Marketing\models\int\int_channel_spend.sql
[0m17:57:19.665299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de167ae-e099-4c22-ba4e-7bd0d1948634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261190B2EA0>]}
[0m17:57:19.666293 [error] [Thread-1 (]: 2 of 4 ERROR creating sql view model marketing.int_channel_spend ............... [[31mERROR[0m in 0.24s]
[0m17:57:19.667539 [debug] [Thread-1 (]: Finished running node model.Marketing.int_channel_spend
[0m17:57:19.668730 [debug] [Thread-1 (]: Began running node model.Marketing.int_lead_conversion
[0m17:57:19.670106 [debug] [Thread-4 (]: Marking all children of 'model.Marketing.int_channel_spend' to be skipped because of status 'error'.  Reason: Database Error in model int_channel_spend (models\int\int_channel_spend.sql)
  000904 (42000): SQL compilation error: error line 12 at position 4
  invalid identifier 'S.CHANNEL_ID'
  compiled code at target\run\Marketing\models\int\int_channel_spend.sql.
[0m17:57:19.671134 [info ] [Thread-1 (]: 3 of 4 START sql view model marketing.int_lead_conversion ...................... [RUN]
[0m17:57:19.673134 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.int_channel_spend, now model.Marketing.int_lead_conversion)
[0m17:57:19.673134 [debug] [Thread-1 (]: Began compiling node model.Marketing.int_lead_conversion
[0m17:57:19.681029 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.int_lead_conversion"
[0m17:57:19.683889 [debug] [Thread-1 (]: Began executing node model.Marketing.int_lead_conversion
[0m17:57:19.688902 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.int_lead_conversion"
[0m17:57:19.691904 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.int_lead_conversion"
[0m17:57:19.693902 [debug] [Thread-1 (]: On model.Marketing.int_lead_conversion: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.int_lead_conversion"} */
create or replace   view MARKETING.marketing.int_lead_conversion
  
   as (
    with leads as (
    select * from MARKETING.marketing.stg_leads
),
campaigns as (
    select * from MARKETING.marketing.stg_campaigns
),
channels as (
    select * from MARKETING.marketing.stg_channels
)

select 
    l.lead_id,
    l.campaign_id,
    l.channel_id,
    c.campaign_name,
    ch.channel_name,
    l.lead_status,
    case when l.lead_status = 'Converted' then 1 else 0 end as is_converted
from leads l
left join campaigns c on l.campaign_id = c.campaign_id
left join channels ch on l.channel_id = ch.channel_id
  );
[0m17:57:19.965228 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbaeeb-3201-8a6f-0000-000cd70aa815
[0m17:57:19.966324 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 17 at position 4
invalid identifier 'L.CHANNEL_ID'
[0m17:57:19.974763 [debug] [Thread-1 (]: Database Error in model int_lead_conversion (models\int\int_lead_conversion.sql)
  000904 (42000): SQL compilation error: error line 17 at position 4
  invalid identifier 'L.CHANNEL_ID'
  compiled code at target\run\Marketing\models\int\int_lead_conversion.sql
[0m17:57:19.976939 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de167ae-e099-4c22-ba4e-7bd0d1948634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026118EE7770>]}
[0m17:57:19.978020 [error] [Thread-1 (]: 3 of 4 ERROR creating sql view model marketing.int_lead_conversion ............. [[31mERROR[0m in 0.30s]
[0m17:57:19.980648 [debug] [Thread-1 (]: Finished running node model.Marketing.int_lead_conversion
[0m17:57:19.981731 [debug] [Thread-1 (]: Began running node model.Marketing.int_lead_lifecycle
[0m17:57:19.982875 [debug] [Thread-4 (]: Marking all children of 'model.Marketing.int_lead_conversion' to be skipped because of status 'error'.  Reason: Database Error in model int_lead_conversion (models\int\int_lead_conversion.sql)
  000904 (42000): SQL compilation error: error line 17 at position 4
  invalid identifier 'L.CHANNEL_ID'
  compiled code at target\run\Marketing\models\int\int_lead_conversion.sql.
[0m17:57:19.984524 [info ] [Thread-1 (]: 4 of 4 START sql view model marketing.int_lead_lifecycle ....................... [RUN]
[0m17:57:19.985777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.int_lead_conversion, now model.Marketing.int_lead_lifecycle)
[0m17:57:19.987477 [debug] [Thread-1 (]: Began compiling node model.Marketing.int_lead_lifecycle
[0m17:57:19.996240 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.int_lead_lifecycle"
[0m17:57:19.998785 [debug] [Thread-1 (]: Began executing node model.Marketing.int_lead_lifecycle
[0m17:57:20.006149 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.int_lead_lifecycle"
[0m17:57:20.009874 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.int_lead_lifecycle"
[0m17:57:20.010992 [debug] [Thread-1 (]: On model.Marketing.int_lead_lifecycle: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.int_lead_lifecycle"} */
create or replace   view MARKETING.marketing.int_lead_lifecycle
  
   as (
    with leads as (
    select * from MARKETING.marketing.stg_leads
)

select
    lead_id,
    campaign_id,
    channel_id,
    lead_date,
    conversion_date,
    datediff('day', lead_date, conversion_date) as days_to_convert
from leads
where conversion_date is not null
  );
[0m17:57:20.270685 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbaeeb-3201-8af3-0000-000cd70a979d
[0m17:57:20.271685 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 11 at position 4
invalid identifier 'CHANNEL_ID'
[0m17:57:20.277685 [debug] [Thread-1 (]: Database Error in model int_lead_lifecycle (models\int\int_lead_lifecycle.sql)
  000904 (42000): SQL compilation error: error line 11 at position 4
  invalid identifier 'CHANNEL_ID'
  compiled code at target\run\Marketing\models\int\int_lead_lifecycle.sql
[0m17:57:20.278685 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7de167ae-e099-4c22-ba4e-7bd0d1948634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261188BD730>]}
[0m17:57:20.279666 [error] [Thread-1 (]: 4 of 4 ERROR creating sql view model marketing.int_lead_lifecycle .............. [[31mERROR[0m in 0.29s]
[0m17:57:20.280668 [debug] [Thread-1 (]: Finished running node model.Marketing.int_lead_lifecycle
[0m17:57:20.282669 [debug] [Thread-4 (]: Marking all children of 'model.Marketing.int_lead_lifecycle' to be skipped because of status 'error'.  Reason: Database Error in model int_lead_lifecycle (models\int\int_lead_lifecycle.sql)
  000904 (42000): SQL compilation error: error line 11 at position 4
  invalid identifier 'CHANNEL_ID'
  compiled code at target\run\Marketing\models\int\int_lead_lifecycle.sql.
[0m17:57:20.283670 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:20.285602 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m17:57:20.286618 [debug] [MainThread]: On list_MARKETING: Close
[0m17:57:20.483786 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m17:57:20.484786 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m17:57:20.669993 [debug] [MainThread]: Connection 'model.Marketing.int_lead_lifecycle' was left open.
[0m17:57:20.670993 [debug] [MainThread]: On model.Marketing.int_lead_lifecycle: Close
[0m17:57:20.892712 [info ] [MainThread]: 
[0m17:57:20.894716 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 5.63 seconds (5.63s).
[0m17:57:20.897034 [debug] [MainThread]: Command end result
[0m17:57:20.942188 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m17:57:20.947551 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m17:57:20.959225 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\run_results.json
[0m17:57:20.959225 [info ] [MainThread]: 
[0m17:57:20.961729 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m17:57:20.962730 [info ] [MainThread]: 
[0m17:57:20.963794 [error] [MainThread]:   Database Error in model int_campaign_performance (models\int\int_campaign_performance.sql)
  000904 (42000): SQL compilation error: error line 19 at position 4
  invalid identifier 'S.TOTAL_SPEND'
  compiled code at target\run\Marketing\models\int\int_campaign_performance.sql
[0m17:57:20.965000 [info ] [MainThread]: 
[0m17:57:20.967012 [error] [MainThread]:   Database Error in model int_channel_spend (models\int\int_channel_spend.sql)
  000904 (42000): SQL compilation error: error line 12 at position 4
  invalid identifier 'S.CHANNEL_ID'
  compiled code at target\run\Marketing\models\int\int_channel_spend.sql
[0m17:57:20.968014 [info ] [MainThread]: 
[0m17:57:20.969016 [error] [MainThread]:   Database Error in model int_lead_conversion (models\int\int_lead_conversion.sql)
  000904 (42000): SQL compilation error: error line 17 at position 4
  invalid identifier 'L.CHANNEL_ID'
  compiled code at target\run\Marketing\models\int\int_lead_conversion.sql
[0m17:57:20.970286 [info ] [MainThread]: 
[0m17:57:20.972755 [error] [MainThread]:   Database Error in model int_lead_lifecycle (models\int\int_lead_lifecycle.sql)
  000904 (42000): SQL compilation error: error line 11 at position 4
  invalid identifier 'CHANNEL_ID'
  compiled code at target\run\Marketing\models\int\int_lead_lifecycle.sql
[0m17:57:20.975021 [info ] [MainThread]: 
[0m17:57:20.976020 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m17:57:20.980022 [debug] [MainThread]: Command `dbt run` failed at 17:57:20.979019 after 9.98 seconds
[0m17:57:20.981021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261164BEB40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261181F8140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002611866F800>]}
[0m17:57:20.983020 [debug] [MainThread]: Flushing usage events
[0m17:57:23.956025 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:20:28.426721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C033B56930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C033B56AE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C033B54A40>]}


============================== 00:20:28.435781 | 2eb0b375-0a0e-4a45-8c38-b25ca9307f24 ==============================
[0m00:20:28.435781 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:20:28.436772 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\RAJGOKUL R M\\Documents\\DE_FINAL\\marketing\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\RAJGOKUL R M\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select intermediate', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:20:29.405412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2eb0b375-0a0e-4a45-8c38-b25ca9307f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C035AFDB20>]}
[0m00:20:29.502321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2eb0b375-0a0e-4a45-8c38-b25ca9307f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C035CF5EE0>]}
[0m00:20:29.504324 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m00:20:30.035944 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:20:30.450968 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 4 files added, 0 files changed.
[0m00:20:30.451970 [debug] [MainThread]: Partial parsing: added file: Marketing://models\intermediate\int_campaign_performance.sql
[0m00:20:30.452971 [debug] [MainThread]: Partial parsing: added file: Marketing://models\intermediate\int_lead_lifecycle.sql
[0m00:20:30.454971 [debug] [MainThread]: Partial parsing: added file: Marketing://models\intermediate\int_channel_spend.sql
[0m00:20:30.455971 [debug] [MainThread]: Partial parsing: added file: Marketing://models\intermediate\int_lead_conversion.sql
[0m00:20:30.456990 [debug] [MainThread]: Partial parsing: deleted file: Marketing://models\int\int_lead_lifecycle.sql
[0m00:20:30.457974 [debug] [MainThread]: Partial parsing: deleted file: Marketing://models\int\int_campaign_performance.sql
[0m00:20:30.458972 [debug] [MainThread]: Partial parsing: deleted file: Marketing://models\int\int_channel_spend.sql
[0m00:20:30.458972 [debug] [MainThread]: Partial parsing: deleted file: Marketing://models\int\int_lead_conversion.sql
[0m00:20:30.972297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2eb0b375-0a0e-4a45-8c38-b25ca9307f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0361C3440>]}
[0m00:20:31.101512 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m00:20:31.109313 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m00:20:31.169096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2eb0b375-0a0e-4a45-8c38-b25ca9307f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C035F622D0>]}
[0m00:20:31.171607 [info ] [MainThread]: Found 12 models, 6 data tests, 5 sources, 479 macros
[0m00:20:31.172604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2eb0b375-0a0e-4a45-8c38-b25ca9307f24', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C03628E1E0>]}
[0m00:20:31.175605 [info ] [MainThread]: 
[0m00:20:31.176605 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:20:31.177605 [info ] [MainThread]: 
[0m00:20:31.179606 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:20:31.188902 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m00:20:31.444003 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m00:20:31.444999 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m00:20:31.444999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:20:32.903910 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m00:20:32.903910 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:20:32.905092 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m00:20:32.906161 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:20:32.908174 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:20:32.909176 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m00:20:32.910177 [debug] [MainThread]: On list_MARKETING: No close available on handle
[0m00:20:32.911177 [info ] [MainThread]: 
[0m00:20:32.912177 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.73 seconds (1.73s).
[0m00:20:32.914176 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "MARKETING"
  Database Error
    250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting
[0m00:20:32.917572 [debug] [MainThread]: Command `dbt run` failed at 00:20:32.917572 after 4.67 seconds
[0m00:20:32.918747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C03324D8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0362AC500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C0362729F0>]}
[0m00:20:32.919850 [debug] [MainThread]: Flushing usage events
[0m00:20:34.833986 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:20:49.228641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213BB6C3650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213BDD65580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213BE16DE80>]}


============================== 00:20:49.238032 | 81def01a-4d48-43cf-914d-318601a15d06 ==============================
[0m00:20:49.238032 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:20:49.240033 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\RAJGOKUL R M\\Documents\\DE_FINAL\\marketing\\logs', 'profiles_dir': 'C:\\Users\\RAJGOKUL R M\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select intermediate', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:20:49.992753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81def01a-4d48-43cf-914d-318601a15d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213BE7CF080>]}
[0m00:20:50.090843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81def01a-4d48-43cf-914d-318601a15d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213C01CD700>]}
[0m00:20:50.092822 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m00:20:50.530576 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:20:50.807639 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:20:50.808621 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:20:50.878909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '81def01a-4d48-43cf-914d-318601a15d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213BE6C7740>]}
[0m00:20:51.019791 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m00:20:51.024372 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m00:20:51.069481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '81def01a-4d48-43cf-914d-318601a15d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213C0856000>]}
[0m00:20:51.070477 [info ] [MainThread]: Found 12 models, 6 data tests, 5 sources, 479 macros
[0m00:20:51.071478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '81def01a-4d48-43cf-914d-318601a15d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213C03F7B00>]}
[0m00:20:51.073957 [info ] [MainThread]: 
[0m00:20:51.074949 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:20:51.075939 [info ] [MainThread]: 
[0m00:20:51.078159 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:20:51.089197 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m00:20:51.216372 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m00:20:51.217372 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m00:20:51.218372 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:20:52.355699 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m00:20:52.356711 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:20:52.357805 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m00:20:52.357805 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m00:20:52.360109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:20:52.360109 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m00:20:52.361129 [debug] [MainThread]: On list_MARKETING: No close available on handle
[0m00:20:52.361129 [info ] [MainThread]: 
[0m00:20:52.362558 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m00:20:52.364960 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "MARKETING"
  Database Error
    250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting
[0m00:20:52.368959 [debug] [MainThread]: Command `dbt run` failed at 00:20:52.367960 after 3.32 seconds
[0m00:20:52.370962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213BE6AA780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213C0AA9040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213C062F6E0>]}
[0m00:20:52.371959 [debug] [MainThread]: Flushing usage events
[0m00:20:53.886114 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:23:27.488215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024879867440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002487C3DB830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002487C3D9E50>]}


============================== 00:23:27.496112 | dae18c42-da24-49bd-9f7c-1b27639d60f5 ==============================
[0m00:23:27.496112 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:23:27.498509 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\RAJGOKUL R M\\Documents\\DE_FINAL\\marketing\\logs', 'profiles_dir': 'C:\\Users\\RAJGOKUL R M\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m00:23:27.547133 [info ] [MainThread]: dbt version: 1.9.4
[0m00:23:27.549220 [info ] [MainThread]: python version: 3.12.4
[0m00:23:27.549220 [info ] [MainThread]: python path: C:\Users\RAJGOKUL R M\Documents\DE_FINAL\env\Scripts\python.exe
[0m00:23:27.551688 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m00:23:28.243295 [info ] [MainThread]: Using profiles dir at C:\Users\RAJGOKUL R M\.dbt
[0m00:23:28.244303 [info ] [MainThread]: Using profiles.yml file at C:\Users\RAJGOKUL R M\.dbt\profiles.yml
[0m00:23:28.245308 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\dbt_project.yml
[0m00:23:28.248447 [info ] [MainThread]: adapter type: snowflake
[0m00:23:28.249515 [info ] [MainThread]: adapter version: 1.9.2
[0m00:23:28.507467 [info ] [MainThread]: Configuration:
[0m00:23:28.508498 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:23:28.509496 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:23:28.510482 [info ] [MainThread]: Required dependencies:
[0m00:23:28.511671 [debug] [MainThread]: Executing "git --help"
[0m00:23:28.595294 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:23:28.597289 [debug] [MainThread]: STDERR: "b''"
[0m00:23:28.597289 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:23:28.598462 [info ] [MainThread]: Connection:
[0m00:23:28.599474 [info ] [MainThread]:   account: DHNDYRQ-CH36585
[0m00:23:28.600793 [info ] [MainThread]:   user: RAJGOKUL9903
[0m00:23:28.602245 [info ] [MainThread]:   database: MARKETING
[0m00:23:28.603313 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m00:23:28.605956 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m00:23:28.607965 [info ] [MainThread]:   schema: marketing
[0m00:23:28.608965 [info ] [MainThread]:   authenticator: None
[0m00:23:28.609964 [info ] [MainThread]:   oauth_client_id: None
[0m00:23:28.610964 [info ] [MainThread]:   query_tag: None
[0m00:23:28.611964 [info ] [MainThread]:   client_session_keep_alive: False
[0m00:23:28.612967 [info ] [MainThread]:   host: None
[0m00:23:28.613967 [info ] [MainThread]:   port: None
[0m00:23:28.613967 [info ] [MainThread]:   proxy_host: None
[0m00:23:28.614968 [info ] [MainThread]:   proxy_port: None
[0m00:23:28.615967 [info ] [MainThread]:   protocol: None
[0m00:23:28.616972 [info ] [MainThread]:   connect_retries: 1
[0m00:23:28.618458 [info ] [MainThread]:   connect_timeout: None
[0m00:23:28.620474 [info ] [MainThread]:   retry_on_database_errors: False
[0m00:23:28.621469 [info ] [MainThread]:   retry_all: False
[0m00:23:28.623471 [info ] [MainThread]:   insecure_mode: False
[0m00:23:28.625470 [info ] [MainThread]:   reuse_connections: True
[0m00:23:28.628471 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m00:23:29.065142 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m00:23:29.168655 [debug] [MainThread]: Using snowflake connection "debug"
[0m00:23:29.168655 [debug] [MainThread]: On debug: select 1 as id
[0m00:23:29.169675 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:23:30.789097 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m00:23:30.790199 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m00:23:30.791218 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m00:23:30.792676 [info ] [MainThread]: [31m1 check failed:[0m
[0m00:23:30.793690 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001: Could not connect to Snowflake backend after 2 attempt(s).Aborting

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m00:23:30.796232 [debug] [MainThread]: Command `dbt debug` failed at 00:23:30.795153 after 3.50 seconds
[0m00:23:30.796748 [debug] [MainThread]: Connection 'debug' was left open.
[0m00:23:30.797763 [debug] [MainThread]: On debug: No close available on handle
[0m00:23:30.797763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002487C4BBF80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002487C3DADE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002487C533620>]}
[0m00:23:30.799028 [debug] [MainThread]: Flushing usage events
[0m00:23:32.340084 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:32:14.837147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AC272E120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AC252EA50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AC0990860>]}


============================== 00:32:14.845272 | ac0439f4-07ef-4521-9160-0cc3b224f595 ==============================
[0m00:32:14.845272 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:32:14.846886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\RAJGOKUL R M\\.dbt', 'log_path': 'C:\\Users\\RAJGOKUL R M\\Documents\\DE_FINAL\\marketing\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m00:32:14.891342 [info ] [MainThread]: dbt version: 1.9.4
[0m00:32:14.892840 [info ] [MainThread]: python version: 3.12.4
[0m00:32:14.894855 [info ] [MainThread]: python path: C:\Users\RAJGOKUL R M\Documents\DE_FINAL\env\Scripts\python.exe
[0m00:32:14.896365 [info ] [MainThread]: os info: Windows-11-10.0.22631-SP0
[0m00:32:15.450923 [info ] [MainThread]: Using profiles dir at C:\Users\RAJGOKUL R M\.dbt
[0m00:32:15.452917 [info ] [MainThread]: Using profiles.yml file at C:\Users\RAJGOKUL R M\.dbt\profiles.yml
[0m00:32:15.453916 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\dbt_project.yml
[0m00:32:15.455905 [info ] [MainThread]: adapter type: snowflake
[0m00:32:15.456917 [info ] [MainThread]: adapter version: 1.9.2
[0m00:32:15.625044 [info ] [MainThread]: Configuration:
[0m00:32:15.626057 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m00:32:15.627060 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m00:32:15.628476 [info ] [MainThread]: Required dependencies:
[0m00:32:15.629516 [debug] [MainThread]: Executing "git --help"
[0m00:32:15.689731 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m00:32:15.690732 [debug] [MainThread]: STDERR: "b''"
[0m00:32:15.690732 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m00:32:15.691731 [info ] [MainThread]: Connection:
[0m00:32:15.694141 [info ] [MainThread]:   account: DHNDYRQ-CH36585
[0m00:32:15.694141 [info ] [MainThread]:   user: RAJGOKUL9903
[0m00:32:15.696143 [info ] [MainThread]:   database: MARKETING
[0m00:32:15.697141 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m00:32:15.698141 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m00:32:15.699142 [info ] [MainThread]:   schema: marketing
[0m00:32:15.700144 [info ] [MainThread]:   authenticator: None
[0m00:32:15.702143 [info ] [MainThread]:   oauth_client_id: None
[0m00:32:15.703143 [info ] [MainThread]:   query_tag: None
[0m00:32:15.704144 [info ] [MainThread]:   client_session_keep_alive: False
[0m00:32:15.705146 [info ] [MainThread]:   host: None
[0m00:32:15.706381 [info ] [MainThread]:   port: None
[0m00:32:15.707778 [info ] [MainThread]:   proxy_host: None
[0m00:32:15.708790 [info ] [MainThread]:   proxy_port: None
[0m00:32:15.709794 [info ] [MainThread]:   protocol: None
[0m00:32:15.710790 [info ] [MainThread]:   connect_retries: 1
[0m00:32:15.712792 [info ] [MainThread]:   connect_timeout: None
[0m00:32:15.713790 [info ] [MainThread]:   retry_on_database_errors: False
[0m00:32:15.715793 [info ] [MainThread]:   retry_all: False
[0m00:32:15.716793 [info ] [MainThread]:   insecure_mode: False
[0m00:32:15.718792 [info ] [MainThread]:   reuse_connections: True
[0m00:32:15.721794 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m00:32:16.150773 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m00:32:16.254613 [debug] [MainThread]: Using snowflake connection "debug"
[0m00:32:16.255613 [debug] [MainThread]: On debug: select 1 as id
[0m00:32:16.255613 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:32:17.905510 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.648 seconds
[0m00:32:17.906033 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m00:32:17.908048 [info ] [MainThread]: [32mAll checks passed![0m
[0m00:32:17.909458 [debug] [MainThread]: Command `dbt debug` succeeded at 00:32:17.909458 after 3.29 seconds
[0m00:32:17.910482 [debug] [MainThread]: Connection 'debug' was left open.
[0m00:32:17.910482 [debug] [MainThread]: On debug: Close
[0m00:32:18.066589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AC2A5DDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AC365FB00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023AC5165880>]}
[0m00:32:18.067593 [debug] [MainThread]: Flushing usage events
[0m00:32:20.672070 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:32:27.577696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002420B369D60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002420B368AA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002420ACB3A70>]}


============================== 00:32:27.585009 | 37e27aaa-0f1e-4485-a29b-5f5b71640d3c ==============================
[0m00:32:27.585009 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:32:27.587373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\RAJGOKUL R M\\.dbt', 'log_path': 'C:\\Users\\RAJGOKUL R M\\Documents\\DE_FINAL\\marketing\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select intermediate', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:32:28.382094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37e27aaa-0f1e-4485-a29b-5f5b71640d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002420B8556A0>]}
[0m00:32:28.480430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37e27aaa-0f1e-4485-a29b-5f5b71640d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002420D3E6B70>]}
[0m00:32:28.483909 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m00:32:28.886933 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:32:29.161868 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:32:29.162868 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:32:29.237375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37e27aaa-0f1e-4485-a29b-5f5b71640d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002420D4A48F0>]}
[0m00:32:29.392682 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m00:32:29.398899 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m00:32:29.443561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37e27aaa-0f1e-4485-a29b-5f5b71640d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002420D9ACB60>]}
[0m00:32:29.445000 [info ] [MainThread]: Found 12 models, 6 data tests, 5 sources, 479 macros
[0m00:32:29.446019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37e27aaa-0f1e-4485-a29b-5f5b71640d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002420D63A8D0>]}
[0m00:32:29.448315 [info ] [MainThread]: 
[0m00:32:29.450344 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:32:29.451329 [info ] [MainThread]: 
[0m00:32:29.452328 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:32:29.460885 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m00:32:29.588591 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m00:32:29.589592 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m00:32:29.590594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:32:30.440831 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.849 seconds
[0m00:32:30.447538 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m00:32:30.468665 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m00:32:30.470292 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m00:32:30.471012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:32:31.484172 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.013 seconds
[0m00:32:31.490110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37e27aaa-0f1e-4485-a29b-5f5b71640d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002420B23E7E0>]}
[0m00:32:31.500203 [debug] [Thread-1 (]: Began running node model.Marketing.int_campaign_performance
[0m00:32:31.501712 [info ] [Thread-1 (]: 1 of 4 START sql table model marketing.int_campaign_performance ................ [RUN]
[0m00:32:31.503222 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.int_campaign_performance'
[0m00:32:31.504302 [debug] [Thread-1 (]: Began compiling node model.Marketing.int_campaign_performance
[0m00:32:31.517875 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.int_campaign_performance"
[0m00:32:31.519875 [debug] [Thread-1 (]: Began executing node model.Marketing.int_campaign_performance
[0m00:32:31.607255 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.int_campaign_performance"
[0m00:32:31.611787 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.int_campaign_performance"
[0m00:32:31.613788 [debug] [Thread-1 (]: On model.Marketing.int_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.int_campaign_performance"} */
create or replace transient table MARKETING.marketing.int_campaign_performance
         as
        (with spend as (
    select
        campaign_id,
        sum(spend_amount) as total_spend
    from MARKETING.marketing.stg_spend
    group by campaign_id
),

leads as (
    select
        campaign_id,
        count(*) as total_leads,
        count_if(is_converted) as converted_leads
    from MARKETING.marketing.stg_leads
    group by campaign_id
)

select
    c.campaign_id,
    c.campaign_name,
    c.channel_id,
    c.start_date,
    c.end_date,
    s.total_spend,
    l.total_leads,
    l.converted_leads
from MARKETING.marketing.stg_campaigns c
left join spend s on c.campaign_id = s.campaign_id
left join leads l on c.campaign_id = l.campaign_id
        );
[0m00:32:31.614788 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m00:32:33.919748 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.305 seconds
[0m00:32:33.964611 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37e27aaa-0f1e-4485-a29b-5f5b71640d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002420ACB3E60>]}
[0m00:32:33.966526 [info ] [Thread-1 (]: 1 of 4 OK created sql table model marketing.int_campaign_performance ........... [[32mSUCCESS 1[0m in 2.46s]
[0m00:32:33.968732 [debug] [Thread-1 (]: Finished running node model.Marketing.int_campaign_performance
[0m00:32:33.969745 [debug] [Thread-1 (]: Began running node model.Marketing.int_channel_spend
[0m00:32:33.970747 [info ] [Thread-1 (]: 2 of 4 START sql table model marketing.int_channel_spend ....................... [RUN]
[0m00:32:33.972269 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.int_campaign_performance, now model.Marketing.int_channel_spend)
[0m00:32:33.973544 [debug] [Thread-1 (]: Began compiling node model.Marketing.int_channel_spend
[0m00:32:34.126368 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.int_channel_spend"
[0m00:32:34.129368 [debug] [Thread-1 (]: Began executing node model.Marketing.int_channel_spend
[0m00:32:34.133373 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.int_channel_spend"
[0m00:32:34.136569 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.int_channel_spend"
[0m00:32:34.137601 [debug] [Thread-1 (]: On model.Marketing.int_channel_spend: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.int_channel_spend"} */
create or replace transient table MARKETING.marketing.int_channel_spend
         as
        (with spend_with_channel as (
    select
        s.spend_id,
        c.channel_id,
        s.spend_amount
    from MARKETING.marketing.stg_spend s
    left join MARKETING.marketing.stg_campaigns c
        on s.campaign_id = c.campaign_id
)

select
    channel_id,
    sum(spend_amount) as total_channel_spend
from spend_with_channel
group by channel_id
        );
[0m00:32:35.216326 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.078 seconds
[0m00:32:35.220603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37e27aaa-0f1e-4485-a29b-5f5b71640d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002420D556D50>]}
[0m00:32:35.221616 [info ] [Thread-1 (]: 2 of 4 OK created sql table model marketing.int_channel_spend .................. [[32mSUCCESS 1[0m in 1.25s]
[0m00:32:35.224496 [debug] [Thread-1 (]: Finished running node model.Marketing.int_channel_spend
[0m00:32:35.225727 [debug] [Thread-1 (]: Began running node model.Marketing.int_lead_conversion
[0m00:32:35.227149 [info ] [Thread-1 (]: 3 of 4 START sql table model marketing.int_lead_conversion ..................... [RUN]
[0m00:32:35.228247 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.int_channel_spend, now model.Marketing.int_lead_conversion)
[0m00:32:35.229257 [debug] [Thread-1 (]: Began compiling node model.Marketing.int_lead_conversion
[0m00:32:35.235259 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.int_lead_conversion"
[0m00:32:35.239533 [debug] [Thread-1 (]: Began executing node model.Marketing.int_lead_conversion
[0m00:32:35.245093 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.int_lead_conversion"
[0m00:32:35.250365 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.int_lead_conversion"
[0m00:32:35.253366 [debug] [Thread-1 (]: On model.Marketing.int_lead_conversion: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.int_lead_conversion"} */
create or replace transient table MARKETING.marketing.int_lead_conversion
         as
        (with leads_with_channel as (
    select
        l.lead_id,
        l.is_converted,
        c.channel_id
    from MARKETING.marketing.stg_leads l
    left join MARKETING.marketing.stg_campaigns c
        on l.campaign_id = c.campaign_id
)

select
    channel_id,
    count(*) as total_leads,
    count_if(is_converted) as converted_leads
from leads_with_channel
group by channel_id
        );
[0m00:32:36.650869 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.396 seconds
[0m00:32:36.654869 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37e27aaa-0f1e-4485-a29b-5f5b71640d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002420DE23EC0>]}
[0m00:32:36.655869 [info ] [Thread-1 (]: 3 of 4 OK created sql table model marketing.int_lead_conversion ................ [[32mSUCCESS 1[0m in 1.43s]
[0m00:32:36.657871 [debug] [Thread-1 (]: Finished running node model.Marketing.int_lead_conversion
[0m00:32:36.658869 [debug] [Thread-1 (]: Began running node model.Marketing.int_lead_lifecycle
[0m00:32:36.659874 [info ] [Thread-1 (]: 4 of 4 START sql table model marketing.int_lead_lifecycle ...................... [RUN]
[0m00:32:36.659874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.int_lead_conversion, now model.Marketing.int_lead_lifecycle)
[0m00:32:36.661371 [debug] [Thread-1 (]: Began compiling node model.Marketing.int_lead_lifecycle
[0m00:32:36.666637 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.int_lead_lifecycle"
[0m00:32:36.668634 [debug] [Thread-1 (]: Began executing node model.Marketing.int_lead_lifecycle
[0m00:32:36.673637 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.int_lead_lifecycle"
[0m00:32:36.676639 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.int_lead_lifecycle"
[0m00:32:36.677633 [debug] [Thread-1 (]: On model.Marketing.int_lead_lifecycle: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.int_lead_lifecycle"} */
create or replace transient table MARKETING.marketing.int_lead_lifecycle
         as
        (with leads_extended as (
    select
        l.lead_id,
        l.name,
        l.email,
        l.is_converted,
        l.converted_date,
        c.channel_id
    from MARKETING.marketing.stg_leads l
    left join MARKETING.marketing.stg_campaigns c
        on l.campaign_id = c.campaign_id
)

select *
from leads_extended
        );
[0m00:32:37.470452 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.791 seconds
[0m00:32:37.473453 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37e27aaa-0f1e-4485-a29b-5f5b71640d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002420DE580E0>]}
[0m00:32:37.474448 [info ] [Thread-1 (]: 4 of 4 OK created sql table model marketing.int_lead_lifecycle ................. [[32mSUCCESS 1[0m in 0.81s]
[0m00:32:37.476941 [debug] [Thread-1 (]: Finished running node model.Marketing.int_lead_lifecycle
[0m00:32:37.478464 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:32:37.479658 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m00:32:37.480674 [debug] [MainThread]: On list_MARKETING: Close
[0m00:32:37.643914 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m00:32:37.644914 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m00:32:37.881947 [debug] [MainThread]: Connection 'model.Marketing.int_lead_lifecycle' was left open.
[0m00:32:37.882948 [debug] [MainThread]: On model.Marketing.int_lead_lifecycle: Close
[0m00:32:38.072340 [info ] [MainThread]: 
[0m00:32:38.073545 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 8.62 seconds (8.62s).
[0m00:32:38.076712 [debug] [MainThread]: Command end result
[0m00:32:38.124137 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\manifest.json
[0m00:32:38.128568 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m00:32:38.141437 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RAJGOKUL R M\Documents\DE_FINAL\marketing\target\run_results.json
[0m00:32:38.142434 [info ] [MainThread]: 
[0m00:32:38.143429 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:32:38.144726 [info ] [MainThread]: 
[0m00:32:38.145740 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m00:32:38.147754 [debug] [MainThread]: Command `dbt run` succeeded at 00:32:38.147754 after 10.75 seconds
[0m00:32:38.149110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002420AC7EF60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002420A3BF5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002420D9893A0>]}
[0m00:32:38.150423 [debug] [MainThread]: Flushing usage events
[0m00:32:41.002448 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:12:14.452344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A01379700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A01378EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A010C7CB0>]}


============================== 10:12:14.470441 | b17ed72e-7c10-435b-ab32-a209c7e60614 ==============================
[0m10:12:14.470441 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:12:14.470441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\Marketing\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m10:12:14.493811 [info ] [MainThread]: dbt version: 1.9.4
[0m10:12:14.493811 [info ] [MainThread]: python version: 3.12.0
[0m10:12:14.493811 [info ] [MainThread]: python path: C:\Users\RajgokulRM\AppData\Local\Programs\Python\Python312\python.exe
[0m10:12:14.493811 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m10:12:15.511880 [info ] [MainThread]: Using profiles dir at C:\Users\RajgokulRM\.dbt
[0m10:12:15.512848 [info ] [MainThread]: Using profiles.yml file at C:\Users\RajgokulRM\.dbt\profiles.yml
[0m10:12:15.512848 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\RajgokulRM\Documents\DE_FINAL\Marketing\dbt_project.yml
[0m10:12:15.514849 [info ] [MainThread]: adapter type: snowflake
[0m10:12:15.514849 [info ] [MainThread]: adapter version: 1.9.2
[0m10:12:15.661950 [info ] [MainThread]: Configuration:
[0m10:12:15.662917 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:12:15.662917 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:12:15.663962 [info ] [MainThread]: Required dependencies:
[0m10:12:15.664864 [debug] [MainThread]: Executing "git --help"
[0m10:12:15.781449 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:12:15.781449 [debug] [MainThread]: STDERR: "b''"
[0m10:12:15.782482 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:12:15.782482 [info ] [MainThread]: Connection:
[0m10:12:15.783486 [info ] [MainThread]:   account: DHNDYRQ-CH36585
[0m10:12:15.784449 [info ] [MainThread]:   user: RAJGOKUL9903
[0m10:12:15.784449 [info ] [MainThread]:   database: MARKETING
[0m10:12:15.785482 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m10:12:15.786454 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m10:12:15.786454 [info ] [MainThread]:   schema: marketing
[0m10:12:15.787449 [info ] [MainThread]:   authenticator: None
[0m10:12:15.788490 [info ] [MainThread]:   oauth_client_id: None
[0m10:12:15.788490 [info ] [MainThread]:   query_tag: None
[0m10:12:15.789473 [info ] [MainThread]:   client_session_keep_alive: False
[0m10:12:15.790481 [info ] [MainThread]:   host: None
[0m10:12:15.790481 [info ] [MainThread]:   port: None
[0m10:12:15.791460 [info ] [MainThread]:   proxy_host: None
[0m10:12:15.791460 [info ] [MainThread]:   proxy_port: None
[0m10:12:15.792473 [info ] [MainThread]:   protocol: None
[0m10:12:15.793450 [info ] [MainThread]:   connect_retries: 1
[0m10:12:15.794450 [info ] [MainThread]:   connect_timeout: None
[0m10:12:15.795450 [info ] [MainThread]:   retry_on_database_errors: False
[0m10:12:15.796455 [info ] [MainThread]:   retry_all: False
[0m10:12:15.797455 [info ] [MainThread]:   insecure_mode: False
[0m10:12:15.798450 [info ] [MainThread]:   reuse_connections: True
[0m10:12:15.798450 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:12:16.401144 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m10:12:21.756219 [debug] [MainThread]: Using snowflake connection "debug"
[0m10:12:21.756219 [debug] [MainThread]: On debug: select 1 as id
[0m10:12:21.758230 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:12:23.636279 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.879 seconds
[0m10:12:23.636279 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:12:23.636279 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:12:23.636279 [debug] [MainThread]: Command `dbt debug` succeeded at 10:12:23.636279 after 9.53 seconds
[0m10:12:23.636279 [debug] [MainThread]: Connection 'debug' was left open.
[0m10:12:23.636279 [debug] [MainThread]: On debug: Close
[0m10:12:23.980032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A01378EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A0D1B5CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022A0E8679E0>]}
[0m10:12:23.980032 [debug] [MainThread]: Flushing usage events
[0m10:12:24.935073 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:31:23.520722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001837997EB10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001837B021F40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001837B022510>]}


============================== 10:31:23.590670 | bb857e04-c8dd-4c12-ab36-18bcbfe1a698 ==============================
[0m10:31:23.590670 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:31:23.590670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:31:23.621556 [info ] [MainThread]: dbt version: 1.9.4
[0m10:31:23.621556 [info ] [MainThread]: python version: 3.12.0
[0m10:31:23.621556 [info ] [MainThread]: python path: C:\Users\RajgokulRM\Documents\DE_FINAL\env\Scripts\python.exe
[0m10:31:23.621556 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m10:31:24.722243 [info ] [MainThread]: Using profiles dir at C:\Users\RajgokulRM\.dbt
[0m10:31:24.722243 [info ] [MainThread]: Using profiles.yml file at C:\Users\RajgokulRM\.dbt\profiles.yml
[0m10:31:24.722243 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\dbt_project.yml
[0m10:31:24.722243 [info ] [MainThread]: adapter type: snowflake
[0m10:31:24.722243 [info ] [MainThread]: adapter version: 1.9.2
[0m10:31:24.870371 [info ] [MainThread]: Configuration:
[0m10:31:24.870371 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:31:24.870371 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:31:24.870371 [info ] [MainThread]: Required dependencies:
[0m10:31:24.870371 [debug] [MainThread]: Executing "git --help"
[0m10:31:24.987773 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:31:24.987773 [debug] [MainThread]: STDERR: "b''"
[0m10:31:24.987773 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:31:24.987773 [info ] [MainThread]: Connection:
[0m10:31:24.987773 [info ] [MainThread]:   account: DHNDYRQ-CH36585
[0m10:31:24.987773 [info ] [MainThread]:   user: RAJGOKUL9903
[0m10:31:24.987773 [info ] [MainThread]:   database: MARKETING
[0m10:31:24.987773 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m10:31:24.987773 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m10:31:24.987773 [info ] [MainThread]:   schema: marketing
[0m10:31:24.987773 [info ] [MainThread]:   authenticator: None
[0m10:31:24.987773 [info ] [MainThread]:   oauth_client_id: None
[0m10:31:25.003625 [info ] [MainThread]:   query_tag: None
[0m10:31:25.004782 [info ] [MainThread]:   client_session_keep_alive: False
[0m10:31:25.005791 [info ] [MainThread]:   host: None
[0m10:31:25.006194 [info ] [MainThread]:   port: None
[0m10:31:25.006864 [info ] [MainThread]:   proxy_host: None
[0m10:31:25.007916 [info ] [MainThread]:   proxy_port: None
[0m10:31:25.008997 [info ] [MainThread]:   protocol: None
[0m10:31:25.009400 [info ] [MainThread]:   connect_retries: 1
[0m10:31:25.009400 [info ] [MainThread]:   connect_timeout: None
[0m10:31:25.011411 [info ] [MainThread]:   retry_on_database_errors: False
[0m10:31:25.023508 [info ] [MainThread]:   retry_all: False
[0m10:31:25.024507 [info ] [MainThread]:   insecure_mode: False
[0m10:31:25.024507 [info ] [MainThread]:   reuse_connections: True
[0m10:31:25.040405 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:31:25.989864 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m10:31:29.561481 [debug] [MainThread]: Using snowflake connection "debug"
[0m10:31:29.562472 [debug] [MainThread]: On debug: select 1 as id
[0m10:31:29.562472 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:31:31.027675 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.471 seconds
[0m10:31:31.035427 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:31:31.035427 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:31:31.035427 [debug] [MainThread]: Command `dbt debug` succeeded at 10:31:31.035427 after 7.76 seconds
[0m10:31:31.035427 [debug] [MainThread]: Connection 'debug' was left open.
[0m10:31:31.035427 [debug] [MainThread]: On debug: Close
[0m10:31:31.369307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001837D026480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001837D9DD730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001837F24D1C0>]}
[0m10:31:31.369307 [debug] [MainThread]: Flushing usage events
[0m10:31:32.313941 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:31:44.300240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5963F7890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E592EED550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E595E58470>]}


============================== 10:31:44.305856 | bd55fd19-d420-4f0d-8f35-0a7fa9fbe147 ==============================
[0m10:31:44.305856 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:31:44.305856 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:31:44.338079 [info ] [MainThread]: dbt version: 1.9.4
[0m10:31:44.339056 [info ] [MainThread]: python version: 3.12.0
[0m10:31:44.340059 [info ] [MainThread]: python path: C:\Users\RajgokulRM\Documents\DE_FINAL\env\Scripts\python.exe
[0m10:31:44.341055 [info ] [MainThread]: os info: Windows-11-10.0.26100-SP0
[0m10:31:44.705595 [info ] [MainThread]: Using profiles dir at C:\Users\RajgokulRM\.dbt
[0m10:31:44.705595 [info ] [MainThread]: Using profiles.yml file at C:\Users\RajgokulRM\.dbt\profiles.yml
[0m10:31:44.705595 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\dbt_project.yml
[0m10:31:44.705595 [info ] [MainThread]: adapter type: snowflake
[0m10:31:44.705595 [info ] [MainThread]: adapter version: 1.9.2
[0m10:31:44.838376 [info ] [MainThread]: Configuration:
[0m10:31:44.838376 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:31:44.839344 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:31:44.840343 [info ] [MainThread]: Required dependencies:
[0m10:31:44.841343 [debug] [MainThread]: Executing "git --help"
[0m10:31:44.943260 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone      Clone a repository into a new directory\n   init       Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add        Add file contents to the index\n   mv         Move or rename a file, a directory, or a symlink\n   restore    Restore working tree files\n   rm         Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect     Use binary search to find the commit that introduced a bug\n   diff       Show changes between commits, commit and working tree, etc\n   grep       Print lines matching a pattern\n   log        Show commit logs\n   show       Show various types of objects\n   status     Show the working tree status\n\ngrow, mark and tweak your common history\n   backfill   Download missing objects in a partial clone\n   branch     List, create, or delete branches\n   commit     Record changes to the repository\n   merge      Join two or more development histories together\n   rebase     Reapply commits on top of another base tip\n   reset      Reset current HEAD to the specified state\n   switch     Switch branches\n   tag        Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch      Download objects and refs from another repository\n   pull       Fetch from and integrate with another repository or a local branch\n   push       Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:31:44.943260 [debug] [MainThread]: STDERR: "b''"
[0m10:31:44.944228 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:31:44.945025 [info ] [MainThread]: Connection:
[0m10:31:44.945734 [info ] [MainThread]:   account: DHNDYRQ-CH36585
[0m10:31:44.945734 [info ] [MainThread]:   user: RAJGOKUL9903
[0m10:31:44.946780 [info ] [MainThread]:   database: MARKETING
[0m10:31:44.947743 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m10:31:44.947743 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m10:31:44.948851 [info ] [MainThread]:   schema: marketing
[0m10:31:44.948851 [info ] [MainThread]:   authenticator: None
[0m10:31:44.949861 [info ] [MainThread]:   oauth_client_id: None
[0m10:31:44.950860 [info ] [MainThread]:   query_tag: None
[0m10:31:44.951860 [info ] [MainThread]:   client_session_keep_alive: False
[0m10:31:44.951860 [info ] [MainThread]:   host: None
[0m10:31:44.952860 [info ] [MainThread]:   port: None
[0m10:31:44.953861 [info ] [MainThread]:   proxy_host: None
[0m10:31:44.954868 [info ] [MainThread]:   proxy_port: None
[0m10:31:44.955861 [info ] [MainThread]:   protocol: None
[0m10:31:44.955861 [info ] [MainThread]:   connect_retries: 1
[0m10:31:44.956860 [info ] [MainThread]:   connect_timeout: None
[0m10:31:44.957861 [info ] [MainThread]:   retry_on_database_errors: False
[0m10:31:44.958874 [info ] [MainThread]:   retry_all: False
[0m10:31:44.959867 [info ] [MainThread]:   insecure_mode: False
[0m10:31:44.960861 [info ] [MainThread]:   reuse_connections: True
[0m10:31:44.961876 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:31:45.366517 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m10:31:45.449840 [debug] [MainThread]: Using snowflake connection "debug"
[0m10:31:45.450840 [debug] [MainThread]: On debug: select 1 as id
[0m10:31:45.450840 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:31:46.674800 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.223 seconds
[0m10:31:46.678838 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:31:46.680854 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:31:46.684884 [debug] [MainThread]: Command `dbt debug` succeeded at 10:31:46.684884 after 2.55 seconds
[0m10:31:46.686898 [debug] [MainThread]: Connection 'debug' was left open.
[0m10:31:46.688912 [debug] [MainThread]: On debug: Close
[0m10:31:47.021558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E5965BA4B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E59875FB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E596161280>]}
[0m10:31:47.022486 [debug] [MainThread]: Flushing usage events
[0m10:31:47.921782 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:58:37.980127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226AC097DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226AB950D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226ABE52900>]}


============================== 10:58:38.030147 | d006c571-a19f-44b5-8226-7aee1ccf3aff ==============================
[0m10:58:38.030147 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:58:38.032448 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select final', 'send_anonymous_usage_stats': 'True'}
[0m10:58:40.186616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd006c571-a19f-44b5-8226-7aee1ccf3aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226A930C260>]}
[0m10:58:40.261734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd006c571-a19f-44b5-8226-7aee1ccf3aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226A9B26ED0>]}
[0m10:58:40.263734 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:58:41.536761 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:58:47.290124 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 2 files added, 0 files changed.
[0m10:58:47.291128 [debug] [MainThread]: Partial parsing: added file: Marketing://models\final\schema.yml
[0m10:58:47.291128 [debug] [MainThread]: Partial parsing: added file: Marketing://models\final\fct_campaign_roi.sql
[0m10:58:47.292156 [debug] [MainThread]: Partial parsing: deleted file: Marketing://models\marts\channel_analysis.sql
[0m10:58:47.292156 [debug] [MainThread]: Partial parsing: deleted file: Marketing://models\marts\campaign_analysis.sql
[0m10:58:47.293156 [debug] [MainThread]: Partial parsing: deleted file: Marketing://models\marts\final_campaign_metrics.sql
[0m10:58:48.005010 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.Marketing.marts
[0m10:58:48.032549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd006c571-a19f-44b5-8226-7aee1ccf3aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226AE3F4D40>]}
[0m10:58:48.191489 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m10:58:48.245673 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m10:58:48.309435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd006c571-a19f-44b5-8226-7aee1ccf3aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226AE597740>]}
[0m10:58:48.309435 [info ] [MainThread]: Found 10 models, 7 data tests, 5 sources, 479 macros
[0m10:58:48.309435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd006c571-a19f-44b5-8226-7aee1ccf3aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226A93FAE70>]}
[0m10:58:48.309435 [info ] [MainThread]: 
[0m10:58:48.309435 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:58:48.309435 [info ] [MainThread]: 
[0m10:58:48.309435 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:58:48.309435 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m10:59:01.639195 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m10:59:01.639195 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m10:59:01.639195 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:03.739878 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.102 seconds
[0m10:59:03.759775 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m10:59:03.771654 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m10:59:03.771654 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m10:59:03.771654 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:59:05.132855 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.365 seconds
[0m10:59:05.132855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd006c571-a19f-44b5-8226-7aee1ccf3aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226AE3A1790>]}
[0m10:59:05.165363 [debug] [Thread-1 (]: Began running node model.Marketing.fct_campaign_roi
[0m10:59:05.165363 [info ] [Thread-1 (]: 1 of 1 START sql view model marketing.fct_campaign_roi ......................... [RUN]
[0m10:59:05.165363 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.fct_campaign_roi'
[0m10:59:05.165363 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_campaign_roi
[0m10:59:05.181046 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_campaign_roi"
[0m10:59:05.181046 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_campaign_roi
[0m10:59:05.225156 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_campaign_roi"
[0m10:59:05.260111 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_campaign_roi"
[0m10:59:05.260601 [debug] [Thread-1 (]: On model.Marketing.fct_campaign_roi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_campaign_roi"} */
create or replace   view MARKETING.marketing.fct_campaign_roi
  
   as (
    -- models/final/fct_campaign_roi.sql

with revenue as (
    select
        campaign_id,
        sum(revenue_amount) as total_revenue
    from MARKETING.marketing.stg_revenue
    group by campaign_id
),

performance as (
    select *
    from MARKETING.marketing.int_campaign_performance
)

select
    p.campaign_id,
    p.campaign_name,
    p.total_spend,
    r.total_revenue,
    (r.total_revenue - p.total_spend) / nullif(p.total_spend, 0) as roi
from performance p
left join revenue r on p.campaign_id = r.campaign_id
  );
[0m10:59:05.261648 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:59:07.314250 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbb2ea-3201-8ade-0000-000cd70a8969
[0m10:59:07.314250 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 12
invalid identifier 'REVENUE_AMOUNT'
[0m10:59:07.400949 [debug] [Thread-1 (]: Database Error in model fct_campaign_roi (models\final\fct_campaign_roi.sql)
  000904 (42000): SQL compilation error: error line 9 at position 12
  invalid identifier 'REVENUE_AMOUNT'
  compiled code at target\run\Marketing\models\final\fct_campaign_roi.sql
[0m10:59:07.400949 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd006c571-a19f-44b5-8226-7aee1ccf3aff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226AE8DAC60>]}
[0m10:59:07.400949 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model marketing.fct_campaign_roi ................ [[31mERROR[0m in 2.24s]
[0m10:59:07.400949 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_campaign_roi
[0m10:59:07.408728 [debug] [Thread-4 (]: Marking all children of 'model.Marketing.fct_campaign_roi' to be skipped because of status 'error'.  Reason: Database Error in model fct_campaign_roi (models\final\fct_campaign_roi.sql)
  000904 (42000): SQL compilation error: error line 9 at position 12
  invalid identifier 'REVENUE_AMOUNT'
  compiled code at target\run\Marketing\models\final\fct_campaign_roi.sql.
[0m10:59:07.410895 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:59:07.410895 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m10:59:07.411943 [debug] [MainThread]: On list_MARKETING: Close
[0m10:59:07.724776 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m10:59:07.724776 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m10:59:08.074175 [debug] [MainThread]: Connection 'model.Marketing.fct_campaign_roi' was left open.
[0m10:59:08.074175 [debug] [MainThread]: On model.Marketing.fct_campaign_roi: Close
[0m10:59:08.397427 [info ] [MainThread]: 
[0m10:59:08.397427 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 20.09 seconds (20.09s).
[0m10:59:08.397427 [debug] [MainThread]: Command end result
[0m10:59:08.450021 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m10:59:08.453021 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m10:59:08.459021 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\run_results.json
[0m10:59:08.459989 [info ] [MainThread]: 
[0m10:59:08.460657 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m10:59:08.461787 [info ] [MainThread]: 
[0m10:59:08.462789 [error] [MainThread]:   Database Error in model fct_campaign_roi (models\final\fct_campaign_roi.sql)
  000904 (42000): SQL compilation error: error line 9 at position 12
  invalid identifier 'REVENUE_AMOUNT'
  compiled code at target\run\Marketing\models\final\fct_campaign_roi.sql
[0m10:59:08.462789 [info ] [MainThread]: 
[0m10:59:08.463872 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m10:59:08.464512 [debug] [MainThread]: Command `dbt run` failed at 10:59:08.464512 after 30.95 seconds
[0m10:59:08.465520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226ABDC5100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226ABD42F90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226ABD406E0>]}
[0m10:59:08.465520 [debug] [MainThread]: Flushing usage events
[0m10:59:09.740862 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:02:30.023015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E839820980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8392692B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8392BE780>]}


============================== 11:02:30.023015 | 1a901781-1f44-473d-ba97-8f445262a480 ==============================
[0m11:02:30.023015 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:02:30.023015 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select stg_revenue', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:02:30.753303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a901781-1f44-473d-ba97-8f445262a480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E83BA94F20>]}
[0m11:02:30.821801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a901781-1f44-473d-ba97-8f445262a480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E83920D4F0>]}
[0m11:02:30.821801 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:02:31.380294 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:02:33.145863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:02:33.145863 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\staging\stg_revenue.sql
[0m11:02:33.526936 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.Marketing.marts
[0m11:02:33.542983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a901781-1f44-473d-ba97-8f445262a480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E83C0134A0>]}
[0m11:02:33.703065 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m11:02:33.711691 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m11:02:33.761767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a901781-1f44-473d-ba97-8f445262a480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E83BF3B4D0>]}
[0m11:02:33.761767 [info ] [MainThread]: Found 10 models, 7 data tests, 5 sources, 479 macros
[0m11:02:33.761767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a901781-1f44-473d-ba97-8f445262a480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E83C006780>]}
[0m11:02:33.761767 [info ] [MainThread]: 
[0m11:02:33.761767 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:02:33.761767 [info ] [MainThread]: 
[0m11:02:33.761767 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:02:33.761767 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m11:02:47.805522 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m11:02:47.805522 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m11:02:47.805522 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:49.210030 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.414 seconds
[0m11:02:49.223927 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m11:02:49.239748 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m11:02:49.239748 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m11:02:49.239748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:02:50.310740 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.069 seconds
[0m11:02:50.310740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a901781-1f44-473d-ba97-8f445262a480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E83C3957C0>]}
[0m11:02:50.310740 [debug] [Thread-1 (]: Began running node model.Marketing.stg_revenue
[0m11:02:50.310740 [info ] [Thread-1 (]: 1 of 1 START sql table model marketing.stg_revenue ............................. [RUN]
[0m11:02:50.310740 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.stg_revenue'
[0m11:02:50.310740 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_revenue
[0m11:02:50.330669 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_revenue"
[0m11:02:50.375751 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_revenue
[0m11:02:50.412974 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_revenue"
[0m11:02:50.473587 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_revenue"
[0m11:02:50.473587 [debug] [Thread-1 (]: On model.Marketing.stg_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_revenue"} */
create or replace transient table MARKETING.marketing.stg_revenue
         as
        (with source as (
    select  * from MARKETING.raw.raw_revenue
),

cleaned as (
    select
        lead_id,
        campaign_id,
        lower(trim(nullif(lead_source, ''))) as lead_source,
        
    case 
        when lower(converted) in ('1', 'true', 'yes') then true
        when lower(converted) in ('0', 'false', 'no') then false
        else null
    end
 as is_converted,
        revenue as revenue_amount, 
        cast(revenue_date as date) as revenue_date,
    from source
)

select * from cleaned
        );
[0m11:02:50.474754 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:02:52.643622 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.180 seconds
[0m11:02:52.685037 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a901781-1f44-473d-ba97-8f445262a480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E836ED92B0>]}
[0m11:02:52.686047 [info ] [Thread-1 (]: 1 of 1 OK created sql table model marketing.stg_revenue ........................ [[32mSUCCESS 1[0m in 2.37s]
[0m11:02:52.686940 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_revenue
[0m11:02:52.688947 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:02:52.688947 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m11:02:52.689980 [debug] [MainThread]: On list_MARKETING: Close
[0m11:02:53.084412 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m11:02:53.085533 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m11:02:53.443691 [debug] [MainThread]: Connection 'model.Marketing.stg_revenue' was left open.
[0m11:02:53.443691 [debug] [MainThread]: On model.Marketing.stg_revenue: Close
[0m11:02:53.831854 [info ] [MainThread]: 
[0m11:02:53.831854 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 20.07 seconds (20.07s).
[0m11:02:53.831854 [debug] [MainThread]: Command end result
[0m11:02:53.878981 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m11:02:53.878981 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m11:02:53.887994 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\run_results.json
[0m11:02:53.887994 [info ] [MainThread]: 
[0m11:02:53.887994 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:02:53.887994 [info ] [MainThread]: 
[0m11:02:53.887994 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:02:53.894631 [debug] [MainThread]: Command `dbt run` succeeded at 11:02:53.894631 after 24.09 seconds
[0m11:02:53.894631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8360D89B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8393E96D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8393EB230>]}
[0m11:02:53.894631 [debug] [MainThread]: Flushing usage events
[0m11:02:55.087899 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:03:17.592227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272A77589B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272AAC04740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272A7A98530>]}


============================== 11:03:17.597662 | 07da2f7e-b743-4db9-b2c1-e9c2756af7f8 ==============================
[0m11:03:17.597662 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:03:17.598663 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fct_campaign_roi', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:03:18.128010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07da2f7e-b743-4db9-b2c1-e9c2756af7f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272ABE0C8C0>]}
[0m11:03:18.191006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07da2f7e-b743-4db9-b2c1-e9c2756af7f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272AB559F10>]}
[0m11:03:18.191006 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:03:18.597750 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:03:18.807905 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:03:18.807905 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:03:18.807905 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.Marketing.marts
[0m11:03:18.860529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07da2f7e-b743-4db9-b2c1-e9c2756af7f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272AD1BEC90>]}
[0m11:03:18.973809 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m11:03:18.973809 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m11:03:19.011217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07da2f7e-b743-4db9-b2c1-e9c2756af7f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272AD551F40>]}
[0m11:03:19.012215 [info ] [MainThread]: Found 10 models, 7 data tests, 5 sources, 479 macros
[0m11:03:19.013216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07da2f7e-b743-4db9-b2c1-e9c2756af7f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272AD1ED610>]}
[0m11:03:19.015217 [info ] [MainThread]: 
[0m11:03:19.015217 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:03:19.016214 [info ] [MainThread]: 
[0m11:03:19.017216 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:03:19.018215 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m11:03:19.126557 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m11:03:19.126557 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m11:03:19.127558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:20.363621 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.243 seconds
[0m11:03:20.385540 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m11:03:20.392782 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m11:03:20.392782 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m11:03:20.392782 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:03:21.346221 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 0.952 seconds
[0m11:03:21.346221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07da2f7e-b743-4db9-b2c1-e9c2756af7f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272AD389040>]}
[0m11:03:21.367911 [debug] [Thread-1 (]: Began running node model.Marketing.fct_campaign_roi
[0m11:03:21.367911 [info ] [Thread-1 (]: 1 of 1 START sql view model marketing.fct_campaign_roi ......................... [RUN]
[0m11:03:21.367911 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.fct_campaign_roi'
[0m11:03:21.367911 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_campaign_roi
[0m11:03:21.384060 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_campaign_roi"
[0m11:03:21.386969 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_campaign_roi
[0m11:03:21.421432 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_campaign_roi"
[0m11:03:21.423400 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_campaign_roi"
[0m11:03:21.424432 [debug] [Thread-1 (]: On model.Marketing.fct_campaign_roi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_campaign_roi"} */
create or replace   view MARKETING.marketing.fct_campaign_roi
  
   as (
    -- models/final/fct_campaign_roi.sql

with revenue as (
    select
        campaign_id,
        sum(revenue_amount) as total_revenue
    from MARKETING.marketing.stg_revenue
    group by campaign_id
),

performance as (
    select *
    from MARKETING.marketing.int_campaign_performance
)

select
    p.campaign_id,
    p.campaign_name,
    p.total_spend,
    r.total_revenue,
    (r.total_revenue - p.total_spend) / nullif(p.total_spend, 0) as roi
from performance p
left join revenue r on p.campaign_id = r.campaign_id
  );
[0m11:03:21.424432 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:03:22.541235 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.116 seconds
[0m11:03:22.569657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07da2f7e-b743-4db9-b2c1-e9c2756af7f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272A8477110>]}
[0m11:03:22.570662 [info ] [Thread-1 (]: 1 of 1 OK created sql view model marketing.fct_campaign_roi .................... [[32mSUCCESS 1[0m in 1.20s]
[0m11:03:22.572657 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_campaign_roi
[0m11:03:22.573658 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:03:22.574657 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m11:03:22.574657 [debug] [MainThread]: On list_MARKETING: Close
[0m11:03:22.962207 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m11:03:22.962207 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m11:03:23.512525 [debug] [MainThread]: Connection 'model.Marketing.fct_campaign_roi' was left open.
[0m11:03:23.512525 [debug] [MainThread]: On model.Marketing.fct_campaign_roi: Close
[0m11:03:24.038007 [info ] [MainThread]: 
[0m11:03:24.040955 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 5.02 seconds (5.02s).
[0m11:03:24.044968 [debug] [MainThread]: Command end result
[0m11:03:24.137096 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m11:03:24.140061 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m11:03:24.146538 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\run_results.json
[0m11:03:24.147535 [info ] [MainThread]: 
[0m11:03:24.148368 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:03:24.148929 [info ] [MainThread]: 
[0m11:03:24.148929 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:03:24.150217 [debug] [MainThread]: Command `dbt run` succeeded at 11:03:24.150217 after 6.74 seconds
[0m11:03:24.151240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272AB1A8D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272A8CF28A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000272A8CF2780>]}
[0m11:03:24.151240 [debug] [MainThread]: Flushing usage events
[0m11:03:25.176355 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:04:29.473696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7D961FF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7D8FD8260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7D961E4E0>]}


============================== 11:04:29.479697 | 0ed9bec2-f65c-44c7-97ff-6805caec90ea ==============================
[0m11:04:29.479697 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:04:29.480065 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'c:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\Marketing\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:04:29.631279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0ed9bec2-f65c-44c7-97ff-6805caec90ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7D9782ED0>]}
[0m11:04:29.680822 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:04:29.681825 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m11:04:29.684060 [debug] [MainThread]: Command `cli deps` succeeded at 11:04:29.683059 after 0.40 seconds
[0m11:04:29.684060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7D8B37230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7D9BA41A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7D8FD8260>]}
[0m11:04:29.685098 [debug] [MainThread]: Flushing usage events
[0m11:04:30.800181 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:05:14.985390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237E9C489B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237ECC361E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237ECC36AE0>]}


============================== 11:05:15.001172 | 82525a16-98a5-468c-99ce-112d3b066c5d ==============================
[0m11:05:15.001172 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:05:15.001172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select fct_campaign_roi', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:05:15.527763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82525a16-98a5-468c-99ce-112d3b066c5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237EE26F440>]}
[0m11:05:15.593117 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82525a16-98a5-468c-99ce-112d3b066c5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237EC6FF020>]}
[0m11:05:15.593117 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:05:15.990181 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:05:16.111905 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:05:16.111905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '82525a16-98a5-468c-99ce-112d3b066c5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237EF96D250>]}
[0m11:05:17.859790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82525a16-98a5-468c-99ce-112d3b066c5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237EF9C1130>]}
[0m11:05:17.948349 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m11:05:17.959899 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m11:05:17.991547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82525a16-98a5-468c-99ce-112d3b066c5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237EFC4C260>]}
[0m11:05:17.991547 [info ] [MainThread]: Found 10 models, 7 data tests, 5 sources, 479 macros
[0m11:05:17.991547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82525a16-98a5-468c-99ce-112d3b066c5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237EFA7E300>]}
[0m11:05:17.991547 [info ] [MainThread]: 
[0m11:05:17.991547 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:05:17.991547 [info ] [MainThread]: 
[0m11:05:17.991547 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:05:17.991547 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m11:05:18.103637 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m11:05:18.103637 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m11:05:18.104634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:05:19.263274 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.168 seconds
[0m11:05:19.274018 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m11:05:19.289884 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m11:05:19.289884 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m11:05:19.289884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:05:20.266311 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.978 seconds
[0m11:05:20.293730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82525a16-98a5-468c-99ce-112d3b066c5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237EFF676B0>]}
[0m11:05:20.293730 [debug] [Thread-1 (]: Began running node model.Marketing.fct_campaign_roi
[0m11:05:20.293730 [info ] [Thread-1 (]: 1 of 1 START sql table model marketing.fct_campaign_roi ........................ [RUN]
[0m11:05:20.293730 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.fct_campaign_roi'
[0m11:05:20.293730 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_campaign_roi
[0m11:05:20.314036 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_campaign_roi"
[0m11:05:20.315732 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_campaign_roi
[0m11:05:20.331546 [debug] [Thread-1 (]:  adapter: Dropping relation "MARKETING"."MARKETING"."FCT_CAMPAIGN_ROI" because it is a view and target relation MARKETING.marketing.fct_campaign_roi is of type table.
[0m11:05:20.346519 [debug] [Thread-1 (]: Applying DROP to: "MARKETING"."MARKETING"."FCT_CAMPAIGN_ROI"
[0m11:05:20.355617 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_campaign_roi"
[0m11:05:20.355617 [debug] [Thread-1 (]: On model.Marketing.fct_campaign_roi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_campaign_roi"} */
drop view if exists "MARKETING"."MARKETING"."FCT_CAMPAIGN_ROI" cascade
[0m11:05:20.356616 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:05:21.457723 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.104 seconds
[0m11:05:21.489610 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_campaign_roi"
[0m11:05:21.489610 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_campaign_roi"
[0m11:05:21.489610 [debug] [Thread-1 (]: On model.Marketing.fct_campaign_roi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_campaign_roi"} */
create or replace transient table MARKETING.marketing.fct_campaign_roi
         as
        (-- models/final/fct_campaign_roi.sql

with revenue as (
    select
        campaign_id,
        sum(revenue_amount) as total_revenue
    from MARKETING.marketing.stg_revenue
    group by campaign_id
),

performance as (
    select *
    from MARKETING.marketing.int_campaign_performance
)

select
    p.campaign_id,
    p.campaign_name,
    p.total_spend,
    r.total_revenue,
    (r.total_revenue - p.total_spend) / nullif(p.total_spend, 0) as roi
from performance p
left join revenue r on p.campaign_id = r.campaign_id
        );
[0m11:05:22.315102 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.825 seconds
[0m11:05:22.346813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '82525a16-98a5-468c-99ce-112d3b066c5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237EA976FC0>]}
[0m11:05:22.346813 [info ] [Thread-1 (]: 1 of 1 OK created sql table model marketing.fct_campaign_roi ................... [[32mSUCCESS 1[0m in 2.04s]
[0m11:05:22.346813 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_campaign_roi
[0m11:05:22.346813 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:05:22.346813 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m11:05:22.346813 [debug] [MainThread]: On list_MARKETING: Close
[0m11:05:22.715471 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m11:05:22.715471 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m11:05:23.050472 [debug] [MainThread]: Connection 'model.Marketing.fct_campaign_roi' was left open.
[0m11:05:23.050472 [debug] [MainThread]: On model.Marketing.fct_campaign_roi: Close
[0m11:05:23.885350 [info ] [MainThread]: 
[0m11:05:23.885350 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.89 seconds (5.89s).
[0m11:05:23.885350 [debug] [MainThread]: Command end result
[0m11:05:23.926834 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m11:05:23.929832 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m11:05:23.935236 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\run_results.json
[0m11:05:23.938385 [info ] [MainThread]: 
[0m11:05:23.938385 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:05:23.938385 [info ] [MainThread]: 
[0m11:05:23.940395 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:05:23.940395 [debug] [MainThread]: Command `dbt run` succeeded at 11:05:23.940395 after 9.10 seconds
[0m11:05:23.940395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237ED758050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237E9F984A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237EC840E90>]}
[0m11:05:23.942904 [debug] [MainThread]: Flushing usage events
[0m11:05:24.846311 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:08:37.521759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029090017F20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290908B4FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002908DA73170>]}


============================== 11:08:37.526794 | 1e407f24-e696-4173-8e3b-2931a21d36b6 ==============================
[0m11:08:37.526794 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:08:37.527697 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select final', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:08:38.064995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1e407f24-e696-4173-8e3b-2931a21d36b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290915BF2F0>]}
[0m11:08:38.129325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1e407f24-e696-4173-8e3b-2931a21d36b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002908F5FF200>]}
[0m11:08:38.144480 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:08:38.562092 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:08:38.695726 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:08:38.695726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1e407f24-e696-4173-8e3b-2931a21d36b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029092B04C20>]}
[0m11:08:40.297840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e407f24-e696-4173-8e3b-2931a21d36b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029092BE9AC0>]}
[0m11:08:40.396423 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m11:08:40.407304 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m11:08:40.437639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1e407f24-e696-4173-8e3b-2931a21d36b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029092E427B0>]}
[0m11:08:40.440799 [info ] [MainThread]: Found 10 models, 7 data tests, 5 sources, 479 macros
[0m11:08:40.440799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e407f24-e696-4173-8e3b-2931a21d36b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029092BEF8F0>]}
[0m11:08:40.440799 [info ] [MainThread]: 
[0m11:08:40.443956 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:08:40.443956 [info ] [MainThread]: 
[0m11:08:40.443956 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:08:40.446795 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m11:08:40.551210 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m11:08:40.552210 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m11:08:40.552210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:41.754750 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.202 seconds
[0m11:08:41.770731 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m11:08:41.786502 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m11:08:41.786502 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m11:08:41.786502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:08:42.727760 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.942 seconds
[0m11:08:42.747108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1e407f24-e696-4173-8e3b-2931a21d36b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029092B65AF0>]}
[0m11:08:42.750606 [debug] [Thread-1 (]: Began running node model.Marketing.fct_campaign_roi
[0m11:08:42.750606 [info ] [Thread-1 (]: 1 of 1 START sql table model marketing.fct_campaign_roi ........................ [RUN]
[0m11:08:42.750606 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.fct_campaign_roi'
[0m11:08:42.750606 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_campaign_roi
[0m11:08:42.764186 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_campaign_roi"
[0m11:08:42.766261 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_campaign_roi
[0m11:08:42.804133 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_campaign_roi"
[0m11:08:42.806132 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_campaign_roi"
[0m11:08:42.806132 [debug] [Thread-1 (]: On model.Marketing.fct_campaign_roi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_campaign_roi"} */
create or replace transient table MARKETING.marketing.fct_campaign_roi
         as
        (-- models/final/fct_campaign_roi.sql

with revenue as (
    select
        campaign_id,
        sum(revenue_amount) as total_revenue
    from MARKETING.marketing.stg_revenue
    group by campaign_id
),

performance as (
    select *
    from MARKETING.marketing.int_campaign_performance
)

select
    p.campaign_id,
    p.campaign_name,
    p.total_spend,
    r.total_revenue,
    (r.total_revenue - p.total_spend) / nullif(p.total_spend, 0) as roi
from performance p
left join revenue r on p.campaign_id = r.campaign_id
        );
[0m11:08:42.807133 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:08:44.474531 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.674 seconds
[0m11:08:44.507267 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e407f24-e696-4173-8e3b-2931a21d36b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002908FF2D8B0>]}
[0m11:08:44.507267 [info ] [Thread-1 (]: 1 of 1 OK created sql table model marketing.fct_campaign_roi ................... [[32mSUCCESS 1[0m in 1.76s]
[0m11:08:44.517642 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_campaign_roi
[0m11:08:44.518649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:08:44.519683 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m11:08:44.519683 [debug] [MainThread]: On list_MARKETING: Close
[0m11:08:44.832864 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m11:08:44.848601 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m11:08:45.186863 [debug] [MainThread]: Connection 'model.Marketing.fct_campaign_roi' was left open.
[0m11:08:45.186863 [debug] [MainThread]: On model.Marketing.fct_campaign_roi: Close
[0m11:08:45.507754 [info ] [MainThread]: 
[0m11:08:45.507754 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.06 seconds (5.06s).
[0m11:08:45.507754 [debug] [MainThread]: Command end result
[0m11:08:45.551613 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m11:08:45.555649 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m11:08:45.558622 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\run_results.json
[0m11:08:45.558622 [info ] [MainThread]: 
[0m11:08:45.558622 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:08:45.558622 [info ] [MainThread]: 
[0m11:08:45.558622 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:08:45.568535 [debug] [MainThread]: Command `dbt run` succeeded at 11:08:45.568535 after 8.22 seconds
[0m11:08:45.569544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002908DA73170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290905E15E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000290905E0890>]}
[0m11:08:45.569544 [debug] [MainThread]: Flushing usage events
[0m11:08:46.520499 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:12:17.462883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A9CA18440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A9CA1B3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A9CA1AC00>]}


============================== 11:12:17.468093 | f5d85008-2021-4853-9c5e-aaa41e741d9b ==============================
[0m11:12:17.468093 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:12:17.469092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fct_monthly_spend_by_channel', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:12:18.010407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5d85008-2021-4853-9c5e-aaa41e741d9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A9E054290>]}
[0m11:12:18.093269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5d85008-2021-4853-9c5e-aaa41e741d9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A9CE051F0>]}
[0m11:12:18.094767 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:12:18.514027 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:12:18.647850 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m11:12:18.647850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f5d85008-2021-4853-9c5e-aaa41e741d9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A9F670DD0>]}
[0m11:12:20.380924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5d85008-2021-4853-9c5e-aaa41e741d9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A9F2E8800>]}
[0m11:12:20.476580 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m11:12:20.476580 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m11:12:20.507894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5d85008-2021-4853-9c5e-aaa41e741d9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A9F61E090>]}
[0m11:12:20.507894 [info ] [MainThread]: Found 11 models, 7 data tests, 5 sources, 479 macros
[0m11:12:20.507894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5d85008-2021-4853-9c5e-aaa41e741d9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A9F8D67E0>]}
[0m11:12:20.507894 [info ] [MainThread]: 
[0m11:12:20.507894 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:12:20.507894 [info ] [MainThread]: 
[0m11:12:20.507894 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:12:20.523686 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m11:12:20.618611 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m11:12:20.618611 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m11:12:20.618611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:21.740740 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.115 seconds
[0m11:12:21.748960 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m11:12:21.756737 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m11:12:21.756737 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m11:12:21.756737 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:12:22.758978 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.001 seconds
[0m11:12:22.758978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5d85008-2021-4853-9c5e-aaa41e741d9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A9FC6BBF0>]}
[0m11:12:22.758978 [debug] [Thread-1 (]: Began running node model.Marketing.fct_monthly_spend_by_channel
[0m11:12:22.758978 [info ] [Thread-1 (]: 1 of 1 START sql table model marketing.fct_monthly_spend_by_channel ............ [RUN]
[0m11:12:22.774611 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.fct_monthly_spend_by_channel'
[0m11:12:22.774611 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_monthly_spend_by_channel
[0m11:12:22.774611 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_monthly_spend_by_channel"
[0m11:12:22.774611 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_monthly_spend_by_channel
[0m11:12:22.821942 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_monthly_spend_by_channel"
[0m11:12:22.821942 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_monthly_spend_by_channel"
[0m11:12:22.821942 [debug] [Thread-1 (]: On model.Marketing.fct_monthly_spend_by_channel: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_monthly_spend_by_channel"} */
create or replace transient table MARKETING.marketing.fct_monthly_spend_by_channel
         as
        (with spend as (
    select
        c.channel_id,
        to_char(s.spend_date, 'YYYY-MM') as month,
        sum(s.spend_amount) as total_spend
    from MARKETING.marketing.stg_spend s
    left join MARKETING.marketing.stg_campaigns c
        on s.campaign_id = c.campaign_id
    group by c.channel_id, to_char(s.spend_date, 'YYYY-MM')
)

select * from spend
        );
[0m11:12:22.821942 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:12:24.441725 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.617 seconds
[0m11:12:24.467710 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5d85008-2021-4853-9c5e-aaa41e741d9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A9F75A7B0>]}
[0m11:12:24.467710 [info ] [Thread-1 (]: 1 of 1 OK created sql table model marketing.fct_monthly_spend_by_channel ....... [[32mSUCCESS 1[0m in 1.69s]
[0m11:12:24.467710 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_monthly_spend_by_channel
[0m11:12:24.473493 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:12:24.473493 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m11:12:24.473493 [debug] [MainThread]: On list_MARKETING: Close
[0m11:12:24.785563 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m11:12:24.785563 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m11:12:25.118411 [debug] [MainThread]: Connection 'model.Marketing.fct_monthly_spend_by_channel' was left open.
[0m11:12:25.121964 [debug] [MainThread]: On model.Marketing.fct_monthly_spend_by_channel: Close
[0m11:12:25.454076 [info ] [MainThread]: 
[0m11:12:25.454076 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.95 seconds (4.95s).
[0m11:12:25.454076 [debug] [MainThread]: Command end result
[0m11:12:25.517303 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m11:12:25.517303 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m11:12:25.517303 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\run_results.json
[0m11:12:25.517303 [info ] [MainThread]: 
[0m11:12:25.517303 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:12:25.517303 [info ] [MainThread]: 
[0m11:12:25.517303 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:12:25.517303 [debug] [MainThread]: Command `dbt run` succeeded at 11:12:25.517303 after 8.24 seconds
[0m11:12:25.533187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A9CCE9190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A9D136C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023A9C9E7290>]}
[0m11:12:25.533187 [debug] [MainThread]: Flushing usage events
[0m11:12:26.455813 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:24:31.704319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023947E5E6C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239477B7860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002394783E1E0>]}


============================== 11:24:31.710318 | fababe4b-82c0-406d-968a-49ac5b288466 ==============================
[0m11:24:31.710318 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:24:31.710672 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select final', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:24:32.372918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fababe4b-82c0-406d-968a-49ac5b288466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002394A148E60>]}
[0m11:24:32.454477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fababe4b-82c0-406d-968a-49ac5b288466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023948D7EB70>]}
[0m11:24:32.454477 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:24:33.082721 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:24:35.292538 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 8 files added, 1 files changed.
[0m11:24:35.292538 [debug] [MainThread]: Partial parsing: added file: Marketing://models\final\fct_campaign_channel_effectiveness.sql
[0m11:24:35.292538 [debug] [MainThread]: Partial parsing: added file: Marketing://models\final\fct_campaign_duration_cost.sql
[0m11:24:35.292538 [debug] [MainThread]: Partial parsing: added file: Marketing://models\final\fct_active_campaign_revenue.sql
[0m11:24:35.292538 [debug] [MainThread]: Partial parsing: added file: Marketing://models\final\fct_channel_conversion_rate.sql
[0m11:24:35.292538 [debug] [MainThread]: Partial parsing: added file: Marketing://models\final\fct_total_revenue_by_campaign.sql
[0m11:24:35.292538 [debug] [MainThread]: Partial parsing: added file: Marketing://models\final\fct_channel_spend_efficiency.sql
[0m11:24:35.308318 [debug] [MainThread]: Partial parsing: added file: Marketing://models\final\fct_inactive_campaigns.sql
[0m11:24:35.308318 [debug] [MainThread]: Partial parsing: added file: Marketing://models\final\fct_lead_time_to_convert.sql
[0m11:24:35.308318 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\final\schema.yml
[0m11:24:35.649297 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'fct_monthly_channel_spend' in the 'models' section of file 'models\final\schema.yml'
[0m11:24:35.746598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fababe4b-82c0-406d-968a-49ac5b288466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002394A664050>]}
[0m11:24:35.880336 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m11:24:35.912155 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m11:24:35.951531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fababe4b-82c0-406d-968a-49ac5b288466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002394A667710>]}
[0m11:24:35.951531 [info ] [MainThread]: Found 19 models, 6 data tests, 5 sources, 479 macros
[0m11:24:35.952532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fababe4b-82c0-406d-968a-49ac5b288466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239455BFD40>]}
[0m11:24:35.955530 [info ] [MainThread]: 
[0m11:24:35.955530 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:24:35.956530 [info ] [MainThread]: 
[0m11:24:35.957531 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:24:35.965570 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m11:24:41.651274 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m11:24:41.651274 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m11:24:41.651274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:42.876852 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.229 seconds
[0m11:24:42.887600 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m11:24:42.887600 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m11:24:42.887600 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m11:24:42.887600 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:24:43.879504 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 0.978 seconds
[0m11:24:43.887633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fababe4b-82c0-406d-968a-49ac5b288466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002394783FBF0>]}
[0m11:24:43.893348 [debug] [Thread-1 (]: Began running node model.Marketing.fct_active_campaign_revenue
[0m11:24:43.894341 [info ] [Thread-1 (]: 1 of 10 START sql table model marketing.fct_active_campaign_revenue ............ [RUN]
[0m11:24:43.895342 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.fct_active_campaign_revenue'
[0m11:24:43.895342 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_active_campaign_revenue
[0m11:24:43.904373 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_active_campaign_revenue"
[0m11:24:43.907306 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_active_campaign_revenue
[0m11:24:43.949427 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_active_campaign_revenue"
[0m11:24:43.951425 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_active_campaign_revenue"
[0m11:24:43.951425 [debug] [Thread-1 (]: On model.Marketing.fct_active_campaign_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_active_campaign_revenue"} */
create or replace transient table MARKETING.marketing.fct_active_campaign_revenue
         as
        (select
    c.campaign_id,
    c.campaign_name,
    sum(r.revenue) as total_revenue
from MARKETING.marketing.stg_campaigns c
left join MARKETING.marketing.stg_revenue r on c.campaign_id = r.campaign_id
where c.status = 'Active'
group by 1, 2
        );
[0m11:24:43.952425 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:24:45.211807 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbb303-3201-8a6f-0000-000cd70aaabd
[0m11:24:45.211807 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 6 at position 8
invalid identifier 'R.REVENUE'
[0m11:24:45.227863 [debug] [Thread-1 (]: Database Error in model fct_active_campaign_revenue (models\final\fct_active_campaign_revenue.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'R.REVENUE'
  compiled code at target\run\Marketing\models\final\fct_active_campaign_revenue.sql
[0m11:24:45.227863 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fababe4b-82c0-406d-968a-49ac5b288466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002394780D850>]}
[0m11:24:45.227863 [error] [Thread-1 (]: 1 of 10 ERROR creating sql table model marketing.fct_active_campaign_revenue ... [[31mERROR[0m in 1.33s]
[0m11:24:45.243507 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_active_campaign_revenue
[0m11:24:45.243507 [debug] [Thread-1 (]: Began running node model.Marketing.fct_campaign_channel_effectiveness
[0m11:24:45.243507 [debug] [Thread-4 (]: Marking all children of 'model.Marketing.fct_active_campaign_revenue' to be skipped because of status 'error'.  Reason: Database Error in model fct_active_campaign_revenue (models\final\fct_active_campaign_revenue.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'R.REVENUE'
  compiled code at target\run\Marketing\models\final\fct_active_campaign_revenue.sql.
[0m11:24:45.243507 [info ] [Thread-1 (]: 2 of 10 START sql table model marketing.fct_campaign_channel_effectiveness ..... [RUN]
[0m11:24:45.243507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_active_campaign_revenue, now model.Marketing.fct_campaign_channel_effectiveness)
[0m11:24:45.243507 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_campaign_channel_effectiveness
[0m11:24:45.243507 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_campaign_channel_effectiveness"
[0m11:24:45.243507 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_campaign_channel_effectiveness
[0m11:24:45.243507 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_campaign_channel_effectiveness"
[0m11:24:45.261665 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_campaign_channel_effectiveness"
[0m11:24:45.262665 [debug] [Thread-1 (]: On model.Marketing.fct_campaign_channel_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_campaign_channel_effectiveness"} */
create or replace transient table MARKETING.marketing.fct_campaign_channel_effectiveness
         as
        (with leads as (
    select campaign_id, count(*) as total_leads
    from MARKETING.marketing.stg_leads
    group by campaign_id
),

conversions as (
    select campaign_id, count(*) as converted_leads
    from MARKETING.marketing.stg_leads
    where is_converted = true
    group by campaign_id
)

select
    c.campaign_id,
    c.campaign_name,
    c.channel_id,
    l.total_leads,
    cv.converted_leads,
    round(cv.converted_leads * 1.0 / nullif(l.total_leads, 0), 2) as conversion_rate
from MARKETING.marketing.stg_campaigns c
left join leads l on c.campaign_id = l.campaign_id
left join conversions cv on c.campaign_id = cv.campaign_id
        );
[0m11:24:45.966190 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.714 seconds
[0m11:24:45.999262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fababe4b-82c0-406d-968a-49ac5b288466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239454A6EA0>]}
[0m11:24:45.999262 [info ] [Thread-1 (]: 2 of 10 OK created sql table model marketing.fct_campaign_channel_effectiveness  [[32mSUCCESS 1[0m in 0.76s]
[0m11:24:45.999262 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_campaign_channel_effectiveness
[0m11:24:45.999262 [debug] [Thread-1 (]: Began running node model.Marketing.fct_campaign_duration_cost
[0m11:24:46.008606 [info ] [Thread-1 (]: 3 of 10 START sql table model marketing.fct_campaign_duration_cost ............. [RUN]
[0m11:24:46.009716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_campaign_channel_effectiveness, now model.Marketing.fct_campaign_duration_cost)
[0m11:24:46.009716 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_campaign_duration_cost
[0m11:24:46.012696 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_campaign_duration_cost"
[0m11:24:46.013696 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_campaign_duration_cost
[0m11:24:46.016697 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_campaign_duration_cost"
[0m11:24:46.018699 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_campaign_duration_cost"
[0m11:24:46.019724 [debug] [Thread-1 (]: On model.Marketing.fct_campaign_duration_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_campaign_duration_cost"} */
create or replace transient table MARKETING.marketing.fct_campaign_duration_cost
         as
        (with performance as (
    select * from MARKETING.marketing.int_campaign_performance
)

select
    campaign_id,
    campaign_name,
    start_date,
    end_date,
    datediff('day', start_date, end_date) + 1 as duration_days,
    total_spend,
    round(total_spend / nullif(datediff('day', start_date, end_date) + 1, 0), 2) as cost_per_day
from performance
        );
[0m11:24:46.636499 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.616 seconds
[0m11:24:46.638501 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fababe4b-82c0-406d-968a-49ac5b288466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002394AB18470>]}
[0m11:24:46.639464 [info ] [Thread-1 (]: 3 of 10 OK created sql table model marketing.fct_campaign_duration_cost ........ [[32mSUCCESS 1[0m in 0.63s]
[0m11:24:46.640466 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_campaign_duration_cost
[0m11:24:46.640466 [debug] [Thread-1 (]: Began running node model.Marketing.fct_campaign_roi
[0m11:24:46.641464 [info ] [Thread-1 (]: 4 of 10 START sql table model marketing.fct_campaign_roi ....................... [RUN]
[0m11:24:46.642104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_campaign_duration_cost, now model.Marketing.fct_campaign_roi)
[0m11:24:46.643307 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_campaign_roi
[0m11:24:46.647306 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_campaign_roi"
[0m11:24:46.648270 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_campaign_roi
[0m11:24:46.652272 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_campaign_roi"
[0m11:24:46.654271 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_campaign_roi"
[0m11:24:46.654271 [debug] [Thread-1 (]: On model.Marketing.fct_campaign_roi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_campaign_roi"} */
create or replace transient table MARKETING.marketing.fct_campaign_roi
         as
        (-- models/final/fct_campaign_roi.sql

with revenue as (
    select
        campaign_id,
        sum(revenue_amount) as total_revenue
    from MARKETING.marketing.stg_revenue
    group by campaign_id
),

performance as (
    select *
    from MARKETING.marketing.int_campaign_performance
)

select
    p.campaign_id,
    p.campaign_name,
    p.total_spend,
    r.total_revenue,
    (r.total_revenue - p.total_spend) / nullif(p.total_spend, 0) as roi
from performance p
left join revenue r on p.campaign_id = r.campaign_id
        );
[0m11:24:47.242064 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.589 seconds
[0m11:24:47.242064 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fababe4b-82c0-406d-968a-49ac5b288466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002394AB2E8A0>]}
[0m11:24:47.242064 [info ] [Thread-1 (]: 4 of 10 OK created sql table model marketing.fct_campaign_roi .................. [[32mSUCCESS 1[0m in 0.60s]
[0m11:24:47.242064 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_campaign_roi
[0m11:24:47.242064 [debug] [Thread-1 (]: Began running node model.Marketing.fct_channel_conversion_rate
[0m11:24:47.242064 [info ] [Thread-1 (]: 5 of 10 START sql table model marketing.fct_channel_conversion_rate ............ [RUN]
[0m11:24:47.242064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_campaign_roi, now model.Marketing.fct_channel_conversion_rate)
[0m11:24:47.242064 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_channel_conversion_rate
[0m11:24:47.242064 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_channel_conversion_rate"
[0m11:24:47.258127 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_channel_conversion_rate
[0m11:24:47.262102 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_channel_conversion_rate"
[0m11:24:47.264098 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_channel_conversion_rate"
[0m11:24:47.265099 [debug] [Thread-1 (]: On model.Marketing.fct_channel_conversion_rate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_channel_conversion_rate"} */
create or replace transient table MARKETING.marketing.fct_channel_conversion_rate
         as
        (with conversions as (
    select * from MARKETING.marketing.int_lead_conversion
)

select
    channel_id,
    total_leads,
    converted_leads,
    round(converted_leads * 1.0 / nullif(total_leads, 0), 2) as conversion_rate
from conversions
order by conversion_rate desc
        );
[0m11:24:47.889119 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m11:24:47.892433 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fababe4b-82c0-406d-968a-49ac5b288466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002394ACBF080>]}
[0m11:24:47.893294 [info ] [Thread-1 (]: 5 of 10 OK created sql table model marketing.fct_channel_conversion_rate ....... [[32mSUCCESS 1[0m in 0.65s]
[0m11:24:47.898126 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_channel_conversion_rate
[0m11:24:47.899126 [debug] [Thread-1 (]: Began running node model.Marketing.fct_channel_spend_efficiency
[0m11:24:47.899126 [info ] [Thread-1 (]: 6 of 10 START sql table model marketing.fct_channel_spend_efficiency ........... [RUN]
[0m11:24:47.901125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_channel_conversion_rate, now model.Marketing.fct_channel_spend_efficiency)
[0m11:24:47.902126 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_channel_spend_efficiency
[0m11:24:47.906126 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_channel_spend_efficiency"
[0m11:24:47.907127 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_channel_spend_efficiency
[0m11:24:47.910764 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_channel_spend_efficiency"
[0m11:24:47.913772 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_channel_spend_efficiency"
[0m11:24:47.913772 [debug] [Thread-1 (]: On model.Marketing.fct_channel_spend_efficiency: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_channel_spend_efficiency"} */
create or replace transient table MARKETING.marketing.fct_channel_spend_efficiency
         as
        (with leads as (
    select campaign_id, count(*) as leads
    from MARKETING.marketing.stg_leads
    group by campaign_id
),

spend as (
    select campaign_id, sum(spend_amount) as spend
    from MARKETING.marketing.stg_spend
    group by campaign_id
),

combined as (
    select
        c.channel_id,
        s.spend,
        l.leads
    from MARKETING.marketing.stg_campaigns c
    left join spend s on c.campaign_id = s.campaign_id
    left join leads l on c.campaign_id = l.campaign_id
)

select
    channel_id,
    sum(spend) as total_spend,
    sum(leads) as total_leads,
    round(sum(spend) / nullif(sum(leads), 0), 2) as spend_per_lead
from combined
group by channel_id
        );
[0m11:24:48.618436 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.703 seconds
[0m11:24:48.620186 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fababe4b-82c0-406d-968a-49ac5b288466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002394ACEB500>]}
[0m11:24:48.620186 [info ] [Thread-1 (]: 6 of 10 OK created sql table model marketing.fct_channel_spend_efficiency ...... [[32mSUCCESS 1[0m in 0.72s]
[0m11:24:48.624204 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_channel_spend_efficiency
[0m11:24:48.624204 [debug] [Thread-1 (]: Began running node model.Marketing.fct_inactive_campaigns
[0m11:24:48.626212 [info ] [Thread-1 (]: 7 of 10 START sql table model marketing.fct_inactive_campaigns ................. [RUN]
[0m11:24:48.628220 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_channel_spend_efficiency, now model.Marketing.fct_inactive_campaigns)
[0m11:24:48.630227 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_inactive_campaigns
[0m11:24:48.634244 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_inactive_campaigns"
[0m11:24:48.635992 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_inactive_campaigns
[0m11:24:48.645230 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_inactive_campaigns"
[0m11:24:48.650208 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_inactive_campaigns"
[0m11:24:48.650208 [debug] [Thread-1 (]: On model.Marketing.fct_inactive_campaigns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_inactive_campaigns"} */
create or replace transient table MARKETING.marketing.fct_inactive_campaigns
         as
        (with leads as (
    select campaign_id, count(*) as total_leads
    from MARKETING.marketing.stg_leads
    group by campaign_id
),

conversions as (
    select campaign_id, count(*) as converted_leads
    from MARKETING.marketing.stg_leads
    where is_converted = true
    group by campaign_id
)

select
    c.campaign_id,
    c.campaign_name,
    coalesce(l.total_leads, 0) as total_leads,
    coalesce(cv.converted_leads, 0) as converted_leads
from MARKETING.marketing.stg_campaigns c
left join leads l on c.campaign_id = l.campaign_id
left join conversions cv on c.campaign_id = cv.campaign_id
where coalesce(l.total_leads, 0) = 0 or coalesce(cv.converted_leads, 0) = 0
        );
[0m11:24:49.186305 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.535 seconds
[0m11:24:49.189269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fababe4b-82c0-406d-968a-49ac5b288466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002394AD047A0>]}
[0m11:24:49.190266 [info ] [Thread-1 (]: 7 of 10 OK created sql table model marketing.fct_inactive_campaigns ............ [[32mSUCCESS 1[0m in 0.56s]
[0m11:24:49.191267 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_inactive_campaigns
[0m11:24:49.191267 [debug] [Thread-1 (]: Began running node model.Marketing.fct_lead_time_to_convert
[0m11:24:49.192275 [info ] [Thread-1 (]: 8 of 10 START sql table model marketing.fct_lead_time_to_convert ............... [RUN]
[0m11:24:49.194273 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_inactive_campaigns, now model.Marketing.fct_lead_time_to_convert)
[0m11:24:49.194273 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_lead_time_to_convert
[0m11:24:49.198325 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_lead_time_to_convert"
[0m11:24:49.200324 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_lead_time_to_convert
[0m11:24:49.203324 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_lead_time_to_convert"
[0m11:24:49.206324 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_lead_time_to_convert"
[0m11:24:49.206324 [debug] [Thread-1 (]: On model.Marketing.fct_lead_time_to_convert: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_lead_time_to_convert"} */
create or replace transient table MARKETING.marketing.fct_lead_time_to_convert
         as
        (select
    campaign_id,
    avg(datediff('day', created_date, converted_date)) as avg_days_to_convert
from (
    select
        campaign_id,
        cast(created_at as date) as created_date,
        cast(converted_date as date) as converted_date
    from MARKETING.marketing.stg_leads
    where is_converted = true
)
group by campaign_id
        );
[0m11:24:49.394850 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbb303-3201-8af3-0000-000cd70a9949
[0m11:24:49.395981 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 13
invalid identifier 'CREATED_AT'
[0m11:24:49.398982 [debug] [Thread-1 (]: Database Error in model fct_lead_time_to_convert (models\final\fct_lead_time_to_convert.sql)
  000904 (42000): SQL compilation error: error line 9 at position 13
  invalid identifier 'CREATED_AT'
  compiled code at target\run\Marketing\models\final\fct_lead_time_to_convert.sql
[0m11:24:49.399981 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fababe4b-82c0-406d-968a-49ac5b288466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002394AAA3050>]}
[0m11:24:49.400982 [error] [Thread-1 (]: 8 of 10 ERROR creating sql table model marketing.fct_lead_time_to_convert ...... [[31mERROR[0m in 0.21s]
[0m11:24:49.401982 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_lead_time_to_convert
[0m11:24:49.402982 [debug] [Thread-1 (]: Began running node model.Marketing.fct_monthly_spend_by_channel
[0m11:24:49.402982 [debug] [Thread-4 (]: Marking all children of 'model.Marketing.fct_lead_time_to_convert' to be skipped because of status 'error'.  Reason: Database Error in model fct_lead_time_to_convert (models\final\fct_lead_time_to_convert.sql)
  000904 (42000): SQL compilation error: error line 9 at position 13
  invalid identifier 'CREATED_AT'
  compiled code at target\run\Marketing\models\final\fct_lead_time_to_convert.sql.
[0m11:24:49.403980 [info ] [Thread-1 (]: 9 of 10 START sql table model marketing.fct_monthly_spend_by_channel ........... [RUN]
[0m11:24:49.404981 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_lead_time_to_convert, now model.Marketing.fct_monthly_spend_by_channel)
[0m11:24:49.405984 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_monthly_spend_by_channel
[0m11:24:49.410876 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_monthly_spend_by_channel"
[0m11:24:49.412604 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_monthly_spend_by_channel
[0m11:24:49.416649 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_monthly_spend_by_channel"
[0m11:24:49.416649 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_monthly_spend_by_channel"
[0m11:24:49.420019 [debug] [Thread-1 (]: On model.Marketing.fct_monthly_spend_by_channel: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_monthly_spend_by_channel"} */
create or replace transient table MARKETING.marketing.fct_monthly_spend_by_channel
         as
        (with spend as (
    select
        c.channel_id,
        to_char(s.spend_date, 'YYYY-MM') as month,
        sum(s.spend_amount) as total_spend
    from MARKETING.marketing.stg_spend s
    left join MARKETING.marketing.stg_campaigns c
        on s.campaign_id = c.campaign_id
    group by c.channel_id, to_char(s.spend_date, 'YYYY-MM')
)

select * from spend
        );
[0m11:24:50.012965 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.597 seconds
[0m11:24:50.012965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fababe4b-82c0-406d-968a-49ac5b288466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002394ABD84A0>]}
[0m11:24:50.012965 [info ] [Thread-1 (]: 9 of 10 OK created sql table model marketing.fct_monthly_spend_by_channel ...... [[32mSUCCESS 1[0m in 0.61s]
[0m11:24:50.012965 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_monthly_spend_by_channel
[0m11:24:50.012965 [debug] [Thread-1 (]: Began running node model.Marketing.fct_total_revenue_by_campaign
[0m11:24:50.012965 [info ] [Thread-1 (]: 10 of 10 START sql table model marketing.fct_total_revenue_by_campaign ......... [RUN]
[0m11:24:50.012965 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_monthly_spend_by_channel, now model.Marketing.fct_total_revenue_by_campaign)
[0m11:24:50.012965 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_total_revenue_by_campaign
[0m11:24:50.028046 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_total_revenue_by_campaign"
[0m11:24:50.029963 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_total_revenue_by_campaign
[0m11:24:50.033985 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_total_revenue_by_campaign"
[0m11:24:50.034991 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_total_revenue_by_campaign"
[0m11:24:50.035984 [debug] [Thread-1 (]: On model.Marketing.fct_total_revenue_by_campaign: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_total_revenue_by_campaign"} */
create or replace transient table MARKETING.marketing.fct_total_revenue_by_campaign
         as
        (select
    campaign_id,
    sum(revenue) as total_revenue
from MARKETING.marketing.stg_revenue
group by campaign_id
        );
[0m11:24:50.216112 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbb303-3201-8a6f-0000-000cd70aaac9
[0m11:24:50.217108 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 5 at position 8
invalid identifier 'REVENUE'
[0m11:24:50.220108 [debug] [Thread-1 (]: Database Error in model fct_total_revenue_by_campaign (models\final\fct_total_revenue_by_campaign.sql)
  000904 (42000): SQL compilation error: error line 5 at position 8
  invalid identifier 'REVENUE'
  compiled code at target\run\Marketing\models\final\fct_total_revenue_by_campaign.sql
[0m11:24:50.220108 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fababe4b-82c0-406d-968a-49ac5b288466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002394AAA2E40>]}
[0m11:24:50.221109 [error] [Thread-1 (]: 10 of 10 ERROR creating sql table model marketing.fct_total_revenue_by_campaign  [[31mERROR[0m in 0.21s]
[0m11:24:50.222109 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_total_revenue_by_campaign
[0m11:24:50.223108 [debug] [Thread-4 (]: Marking all children of 'model.Marketing.fct_total_revenue_by_campaign' to be skipped because of status 'error'.  Reason: Database Error in model fct_total_revenue_by_campaign (models\final\fct_total_revenue_by_campaign.sql)
  000904 (42000): SQL compilation error: error line 5 at position 8
  invalid identifier 'REVENUE'
  compiled code at target\run\Marketing\models\final\fct_total_revenue_by_campaign.sql.
[0m11:24:50.225109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:24:50.225109 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m11:24:50.226111 [debug] [MainThread]: On list_MARKETING: Close
[0m11:24:50.537596 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m11:24:50.549027 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m11:24:50.867970 [debug] [MainThread]: Connection 'model.Marketing.fct_total_revenue_by_campaign' was left open.
[0m11:24:50.867970 [debug] [MainThread]: On model.Marketing.fct_total_revenue_by_campaign: Close
[0m11:24:51.189122 [info ] [MainThread]: 
[0m11:24:51.189122 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 15.23 seconds (15.23s).
[0m11:24:51.192636 [debug] [MainThread]: Command end result
[0m11:24:51.232245 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m11:24:51.232245 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m11:24:51.251715 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\run_results.json
[0m11:24:51.251715 [info ] [MainThread]: 
[0m11:24:51.252718 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m11:24:51.253750 [info ] [MainThread]: 
[0m11:24:51.254733 [error] [MainThread]:   Database Error in model fct_active_campaign_revenue (models\final\fct_active_campaign_revenue.sql)
  000904 (42000): SQL compilation error: error line 6 at position 8
  invalid identifier 'R.REVENUE'
  compiled code at target\run\Marketing\models\final\fct_active_campaign_revenue.sql
[0m11:24:51.255734 [info ] [MainThread]: 
[0m11:24:51.256718 [error] [MainThread]:   Database Error in model fct_lead_time_to_convert (models\final\fct_lead_time_to_convert.sql)
  000904 (42000): SQL compilation error: error line 9 at position 13
  invalid identifier 'CREATED_AT'
  compiled code at target\run\Marketing\models\final\fct_lead_time_to_convert.sql
[0m11:24:51.256718 [info ] [MainThread]: 
[0m11:24:51.258720 [error] [MainThread]:   Database Error in model fct_total_revenue_by_campaign (models\final\fct_total_revenue_by_campaign.sql)
  000904 (42000): SQL compilation error: error line 5 at position 8
  invalid identifier 'REVENUE'
  compiled code at target\run\Marketing\models\final\fct_total_revenue_by_campaign.sql
[0m11:24:51.259719 [info ] [MainThread]: 
[0m11:24:51.260717 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=3 SKIP=0 TOTAL=10
[0m11:24:51.261750 [debug] [MainThread]: Command `dbt run` failed at 11:24:51.261750 after 19.80 seconds
[0m11:24:51.262718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023947B2FB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023948215D00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000239470C1DF0>]}
[0m11:24:51.262718 [debug] [MainThread]: Flushing usage events
[0m11:24:52.445749 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:27:44.575756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BCDFB8BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BCEF51FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BD15DFE60>]}


============================== 11:27:44.583135 | 50146545-2850-487f-95b0-b70414aaa5f4 ==============================
[0m11:27:44.583135 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:27:44.583135 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select final', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:27:45.454736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50146545-2850-487f-95b0-b70414aaa5f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BD37E1C10>]}
[0m11:27:45.523931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50146545-2850-487f-95b0-b70414aaa5f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BD3812510>]}
[0m11:27:45.525938 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:27:45.926975 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:27:46.220901 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m11:27:46.222083 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\final\schema.yml
[0m11:27:46.222083 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\final\fct_active_campaign_revenue.sql
[0m11:27:46.223080 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\final\fct_lead_time_to_convert.sql
[0m11:27:46.223080 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\final\fct_total_revenue_by_campaign.sql
[0m11:27:46.622522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50146545-2850-487f-95b0-b70414aaa5f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BD3E16540>]}
[0m11:27:46.776280 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m11:27:46.782296 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m11:27:46.832617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50146545-2850-487f-95b0-b70414aaa5f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BD3D34170>]}
[0m11:27:46.832617 [info ] [MainThread]: Found 19 models, 6 data tests, 5 sources, 479 macros
[0m11:27:46.833625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50146545-2850-487f-95b0-b70414aaa5f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BD3D86480>]}
[0m11:27:46.833625 [info ] [MainThread]: 
[0m11:27:46.837281 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:27:46.837281 [info ] [MainThread]: 
[0m11:27:46.839481 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:27:46.847380 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m11:27:46.954321 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m11:27:46.954321 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m11:27:46.954321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:27:48.256706 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.309 seconds
[0m11:27:48.272112 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m11:27:48.272112 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m11:27:48.272112 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m11:27:48.272112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:27:49.262062 [debug] [ThreadPool]: SQL status: SUCCESS 16 in 0.984 seconds
[0m11:27:49.272646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50146545-2850-487f-95b0-b70414aaa5f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BD3E9BE90>]}
[0m11:27:49.277850 [debug] [Thread-1 (]: Began running node model.Marketing.fct_active_campaign_revenue
[0m11:27:49.277850 [info ] [Thread-1 (]: 1 of 10 START sql table model marketing.fct_active_campaign_revenue ............ [RUN]
[0m11:27:49.277850 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.fct_active_campaign_revenue'
[0m11:27:49.277850 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_active_campaign_revenue
[0m11:27:49.294651 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_active_campaign_revenue"
[0m11:27:49.295629 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_active_campaign_revenue
[0m11:27:49.325730 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_active_campaign_revenue"
[0m11:27:49.325730 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_active_campaign_revenue"
[0m11:27:49.325730 [debug] [Thread-1 (]: On model.Marketing.fct_active_campaign_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_active_campaign_revenue"} */
create or replace transient table MARKETING.marketing.fct_active_campaign_revenue
         as
        (select
    c.campaign_id,
    c.campaign_name,
    sum(r.revenue_amount) as total_revenue
from MARKETING.marketing.stg_campaigns c
left join MARKETING.marketing.stg_revenue r on c.campaign_id = r.campaign_id
where c.status = 'Active'
group by 1, 2
        );
[0m11:27:49.325730 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:27:50.725824 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.389 seconds
[0m11:27:50.751773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50146545-2850-487f-95b0-b70414aaa5f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BCEBE6F30>]}
[0m11:27:50.753778 [info ] [Thread-1 (]: 1 of 10 OK created sql table model marketing.fct_active_campaign_revenue ....... [[32mSUCCESS 1[0m in 1.47s]
[0m11:27:50.753778 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_active_campaign_revenue
[0m11:27:50.755783 [debug] [Thread-1 (]: Began running node model.Marketing.fct_campaign_channel_effectiveness
[0m11:27:50.755783 [info ] [Thread-1 (]: 2 of 10 START sql table model marketing.fct_campaign_channel_effectiveness ..... [RUN]
[0m11:27:50.757788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_active_campaign_revenue, now model.Marketing.fct_campaign_channel_effectiveness)
[0m11:27:50.757788 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_campaign_channel_effectiveness
[0m11:27:50.761797 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_campaign_channel_effectiveness"
[0m11:27:50.763545 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_campaign_channel_effectiveness
[0m11:27:50.767102 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_campaign_channel_effectiveness"
[0m11:27:50.772674 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_campaign_channel_effectiveness"
[0m11:27:50.773673 [debug] [Thread-1 (]: On model.Marketing.fct_campaign_channel_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_campaign_channel_effectiveness"} */
create or replace transient table MARKETING.marketing.fct_campaign_channel_effectiveness
         as
        (with leads as (
    select campaign_id, count(*) as total_leads
    from MARKETING.marketing.stg_leads
    group by campaign_id
),

conversions as (
    select campaign_id, count(*) as converted_leads
    from MARKETING.marketing.stg_leads
    where is_converted = true
    group by campaign_id
)

select
    c.campaign_id,
    c.campaign_name,
    c.channel_id,
    l.total_leads,
    cv.converted_leads,
    round(cv.converted_leads * 1.0 / nullif(l.total_leads, 0), 2) as conversion_rate
from MARKETING.marketing.stg_campaigns c
left join leads l on c.campaign_id = l.campaign_id
left join conversions cv on c.campaign_id = cv.campaign_id
        );
[0m11:27:51.397324 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.628 seconds
[0m11:27:51.397324 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50146545-2850-487f-95b0-b70414aaa5f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BD4311640>]}
[0m11:27:51.397324 [info ] [Thread-1 (]: 2 of 10 OK created sql table model marketing.fct_campaign_channel_effectiveness  [[32mSUCCESS 1[0m in 0.64s]
[0m11:27:51.397324 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_campaign_channel_effectiveness
[0m11:27:51.397324 [debug] [Thread-1 (]: Began running node model.Marketing.fct_campaign_duration_cost
[0m11:27:51.397324 [info ] [Thread-1 (]: 3 of 10 START sql table model marketing.fct_campaign_duration_cost ............. [RUN]
[0m11:27:51.397324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_campaign_channel_effectiveness, now model.Marketing.fct_campaign_duration_cost)
[0m11:27:51.397324 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_campaign_duration_cost
[0m11:27:51.414070 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_campaign_duration_cost"
[0m11:27:51.414070 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_campaign_duration_cost
[0m11:27:51.414070 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_campaign_duration_cost"
[0m11:27:51.414070 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_campaign_duration_cost"
[0m11:27:51.414070 [debug] [Thread-1 (]: On model.Marketing.fct_campaign_duration_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_campaign_duration_cost"} */
create or replace transient table MARKETING.marketing.fct_campaign_duration_cost
         as
        (with performance as (
    select * from MARKETING.marketing.int_campaign_performance
)

select
    campaign_id,
    campaign_name,
    start_date,
    end_date,
    datediff('day', start_date, end_date) + 1 as duration_days,
    total_spend,
    round(total_spend / nullif(datediff('day', start_date, end_date) + 1, 0), 2) as cost_per_day
from performance
        );
[0m11:27:52.050064 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.628 seconds
[0m11:27:52.052058 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50146545-2850-487f-95b0-b70414aaa5f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BD4311520>]}
[0m11:27:52.053056 [info ] [Thread-1 (]: 3 of 10 OK created sql table model marketing.fct_campaign_duration_cost ........ [[32mSUCCESS 1[0m in 0.65s]
[0m11:27:52.054059 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_campaign_duration_cost
[0m11:27:52.054059 [debug] [Thread-1 (]: Began running node model.Marketing.fct_campaign_roi
[0m11:27:52.055058 [info ] [Thread-1 (]: 4 of 10 START sql table model marketing.fct_campaign_roi ....................... [RUN]
[0m11:27:52.056057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_campaign_duration_cost, now model.Marketing.fct_campaign_roi)
[0m11:27:52.056057 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_campaign_roi
[0m11:27:52.059055 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_campaign_roi"
[0m11:27:52.060410 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_campaign_roi
[0m11:27:52.064517 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_campaign_roi"
[0m11:27:52.066520 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_campaign_roi"
[0m11:27:52.067518 [debug] [Thread-1 (]: On model.Marketing.fct_campaign_roi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_campaign_roi"} */
create or replace transient table MARKETING.marketing.fct_campaign_roi
         as
        (-- models/final/fct_campaign_roi.sql

with revenue as (
    select
        campaign_id,
        sum(revenue_amount) as total_revenue
    from MARKETING.marketing.stg_revenue
    group by campaign_id
),

performance as (
    select *
    from MARKETING.marketing.int_campaign_performance
)

select
    p.campaign_id,
    p.campaign_name,
    p.total_spend,
    r.total_revenue,
    (r.total_revenue - p.total_spend) / nullif(p.total_spend, 0) as roi
from performance p
left join revenue r on p.campaign_id = r.campaign_id
        );
[0m11:27:52.673386 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.616 seconds
[0m11:27:52.673386 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50146545-2850-487f-95b0-b70414aaa5f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BD4310800>]}
[0m11:27:52.673386 [info ] [Thread-1 (]: 4 of 10 OK created sql table model marketing.fct_campaign_roi .................. [[32mSUCCESS 1[0m in 0.62s]
[0m11:27:52.673386 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_campaign_roi
[0m11:27:52.689165 [debug] [Thread-1 (]: Began running node model.Marketing.fct_channel_conversion_rate
[0m11:27:52.689165 [info ] [Thread-1 (]: 5 of 10 START sql table model marketing.fct_channel_conversion_rate ............ [RUN]
[0m11:27:52.689165 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_campaign_roi, now model.Marketing.fct_channel_conversion_rate)
[0m11:27:52.689165 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_channel_conversion_rate
[0m11:27:52.689165 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_channel_conversion_rate"
[0m11:27:52.689165 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_channel_conversion_rate
[0m11:27:52.689165 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_channel_conversion_rate"
[0m11:27:52.689165 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_channel_conversion_rate"
[0m11:27:52.689165 [debug] [Thread-1 (]: On model.Marketing.fct_channel_conversion_rate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_channel_conversion_rate"} */
create or replace transient table MARKETING.marketing.fct_channel_conversion_rate
         as
        (with conversions as (
    select * from MARKETING.marketing.int_lead_conversion
)

select
    channel_id,
    total_leads,
    converted_leads,
    round(converted_leads * 1.0 / nullif(total_leads, 0), 2) as conversion_rate
from conversions
order by conversion_rate desc
        );
[0m11:27:53.223673 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.524 seconds
[0m11:27:53.226545 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50146545-2850-487f-95b0-b70414aaa5f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BD43296A0>]}
[0m11:27:53.228553 [info ] [Thread-1 (]: 5 of 10 OK created sql table model marketing.fct_channel_conversion_rate ....... [[32mSUCCESS 1[0m in 0.54s]
[0m11:27:53.228553 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_channel_conversion_rate
[0m11:27:53.228553 [debug] [Thread-1 (]: Began running node model.Marketing.fct_channel_spend_efficiency
[0m11:27:53.228553 [info ] [Thread-1 (]: 6 of 10 START sql table model marketing.fct_channel_spend_efficiency ........... [RUN]
[0m11:27:53.228553 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_channel_conversion_rate, now model.Marketing.fct_channel_spend_efficiency)
[0m11:27:53.228553 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_channel_spend_efficiency
[0m11:27:53.228553 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_channel_spend_efficiency"
[0m11:27:53.228553 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_channel_spend_efficiency
[0m11:27:53.239504 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_channel_spend_efficiency"
[0m11:27:53.242809 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_channel_spend_efficiency"
[0m11:27:53.243465 [debug] [Thread-1 (]: On model.Marketing.fct_channel_spend_efficiency: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_channel_spend_efficiency"} */
create or replace transient table MARKETING.marketing.fct_channel_spend_efficiency
         as
        (with leads as (
    select campaign_id, count(*) as leads
    from MARKETING.marketing.stg_leads
    group by campaign_id
),

spend as (
    select campaign_id, sum(spend_amount) as spend
    from MARKETING.marketing.stg_spend
    group by campaign_id
),

combined as (
    select
        c.channel_id,
        s.spend,
        l.leads
    from MARKETING.marketing.stg_campaigns c
    left join spend s on c.campaign_id = s.campaign_id
    left join leads l on c.campaign_id = l.campaign_id
)

select
    channel_id,
    sum(spend) as total_spend,
    sum(leads) as total_leads,
    round(sum(spend) / nullif(sum(leads), 0), 2) as spend_per_lead
from combined
group by channel_id
        );
[0m11:27:53.904887 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.661 seconds
[0m11:27:53.904887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50146545-2850-487f-95b0-b70414aaa5f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BD4327DA0>]}
[0m11:27:53.904887 [info ] [Thread-1 (]: 6 of 10 OK created sql table model marketing.fct_channel_spend_efficiency ...... [[32mSUCCESS 1[0m in 0.68s]
[0m11:27:53.921064 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_channel_spend_efficiency
[0m11:27:53.921064 [debug] [Thread-1 (]: Began running node model.Marketing.fct_inactive_campaigns
[0m11:27:53.921064 [info ] [Thread-1 (]: 7 of 10 START sql table model marketing.fct_inactive_campaigns ................. [RUN]
[0m11:27:53.921064 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_channel_spend_efficiency, now model.Marketing.fct_inactive_campaigns)
[0m11:27:53.930529 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_inactive_campaigns
[0m11:27:53.937666 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_inactive_campaigns"
[0m11:27:53.937666 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_inactive_campaigns
[0m11:27:53.951850 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_inactive_campaigns"
[0m11:27:53.953850 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_inactive_campaigns"
[0m11:27:53.953850 [debug] [Thread-1 (]: On model.Marketing.fct_inactive_campaigns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_inactive_campaigns"} */
create or replace transient table MARKETING.marketing.fct_inactive_campaigns
         as
        (with leads as (
    select campaign_id, count(*) as total_leads
    from MARKETING.marketing.stg_leads
    group by campaign_id
),

conversions as (
    select campaign_id, count(*) as converted_leads
    from MARKETING.marketing.stg_leads
    where is_converted = true
    group by campaign_id
)

select
    c.campaign_id,
    c.campaign_name,
    coalesce(l.total_leads, 0) as total_leads,
    coalesce(cv.converted_leads, 0) as converted_leads
from MARKETING.marketing.stg_campaigns c
left join leads l on c.campaign_id = l.campaign_id
left join conversions cv on c.campaign_id = cv.campaign_id
where coalesce(l.total_leads, 0) = 0 or coalesce(cv.converted_leads, 0) = 0
        );
[0m11:27:54.426636 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.474 seconds
[0m11:27:54.426636 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50146545-2850-487f-95b0-b70414aaa5f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BD435F470>]}
[0m11:27:54.442413 [info ] [Thread-1 (]: 7 of 10 OK created sql table model marketing.fct_inactive_campaigns ............ [[32mSUCCESS 1[0m in 0.51s]
[0m11:27:54.442413 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_inactive_campaigns
[0m11:27:54.446317 [debug] [Thread-1 (]: Began running node model.Marketing.fct_lead_time_to_convert
[0m11:27:54.446317 [info ] [Thread-1 (]: 8 of 10 START sql table model marketing.fct_lead_time_to_convert ............... [RUN]
[0m11:27:54.446317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_inactive_campaigns, now model.Marketing.fct_lead_time_to_convert)
[0m11:27:54.452889 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_lead_time_to_convert
[0m11:27:54.457903 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_lead_time_to_convert"
[0m11:27:54.457903 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_lead_time_to_convert
[0m11:27:54.463500 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_lead_time_to_convert"
[0m11:27:54.465317 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_lead_time_to_convert"
[0m11:27:54.466325 [debug] [Thread-1 (]: On model.Marketing.fct_lead_time_to_convert: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_lead_time_to_convert"} */
create or replace transient table MARKETING.marketing.fct_lead_time_to_convert
         as
        (select
    campaign_id,
    avg(datediff('day', created_date, converted_date)) as avg_days_to_convert
from (
    select
        campaign_id,
        cast(created_date as date) as created_date,
        cast(converted_date as date) as converted_date
    from MARKETING.marketing.stg_leads
    where is_converted = true
)
group by campaign_id
        );
[0m11:27:54.678960 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbb306-3201-8af3-0000-000cd70a9955
[0m11:27:54.678960 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 9 at position 13
invalid identifier 'CREATED_DATE'
[0m11:27:54.697102 [debug] [Thread-1 (]: Database Error in model fct_lead_time_to_convert (models\final\fct_lead_time_to_convert.sql)
  000904 (42000): SQL compilation error: error line 9 at position 13
  invalid identifier 'CREATED_DATE'
  compiled code at target\run\Marketing\models\final\fct_lead_time_to_convert.sql
[0m11:27:54.698103 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50146545-2850-487f-95b0-b70414aaa5f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BD41B7230>]}
[0m11:27:54.699102 [error] [Thread-1 (]: 8 of 10 ERROR creating sql table model marketing.fct_lead_time_to_convert ...... [[31mERROR[0m in 0.25s]
[0m11:27:54.701100 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_lead_time_to_convert
[0m11:27:54.702064 [debug] [Thread-1 (]: Began running node model.Marketing.fct_monthly_spend_by_channel
[0m11:27:54.702064 [debug] [Thread-4 (]: Marking all children of 'model.Marketing.fct_lead_time_to_convert' to be skipped because of status 'error'.  Reason: Database Error in model fct_lead_time_to_convert (models\final\fct_lead_time_to_convert.sql)
  000904 (42000): SQL compilation error: error line 9 at position 13
  invalid identifier 'CREATED_DATE'
  compiled code at target\run\Marketing\models\final\fct_lead_time_to_convert.sql.
[0m11:27:54.703424 [info ] [Thread-1 (]: 9 of 10 START sql table model marketing.fct_monthly_spend_by_channel ........... [RUN]
[0m11:27:54.705195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_lead_time_to_convert, now model.Marketing.fct_monthly_spend_by_channel)
[0m11:27:54.706204 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_monthly_spend_by_channel
[0m11:27:54.710204 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_monthly_spend_by_channel"
[0m11:27:54.711226 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_monthly_spend_by_channel
[0m11:27:54.715237 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_monthly_spend_by_channel"
[0m11:27:54.717236 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_monthly_spend_by_channel"
[0m11:27:54.718237 [debug] [Thread-1 (]: On model.Marketing.fct_monthly_spend_by_channel: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_monthly_spend_by_channel"} */
create or replace transient table MARKETING.marketing.fct_monthly_spend_by_channel
         as
        (with spend as (
    select
        c.channel_id,
        to_char(s.spend_date, 'YYYY-MM') as month,
        sum(s.spend_amount) as total_spend
    from MARKETING.marketing.stg_spend s
    left join MARKETING.marketing.stg_campaigns c
        on s.campaign_id = c.campaign_id
    group by c.channel_id, to_char(s.spend_date, 'YYYY-MM')
)

select * from spend
        );
[0m11:27:55.300508 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m11:27:55.300508 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50146545-2850-487f-95b0-b70414aaa5f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BD4137C80>]}
[0m11:27:55.300508 [info ] [Thread-1 (]: 9 of 10 OK created sql table model marketing.fct_monthly_spend_by_channel ...... [[32mSUCCESS 1[0m in 0.60s]
[0m11:27:55.300508 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_monthly_spend_by_channel
[0m11:27:55.300508 [debug] [Thread-1 (]: Began running node model.Marketing.fct_total_revenue_by_campaign
[0m11:27:55.300508 [info ] [Thread-1 (]: 10 of 10 START sql table model marketing.fct_total_revenue_by_campaign ......... [RUN]
[0m11:27:55.311593 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_monthly_spend_by_channel, now model.Marketing.fct_total_revenue_by_campaign)
[0m11:27:55.311593 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_total_revenue_by_campaign
[0m11:27:55.311593 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_total_revenue_by_campaign"
[0m11:27:55.311593 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_total_revenue_by_campaign
[0m11:27:55.311593 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_total_revenue_by_campaign"
[0m11:27:55.311593 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_total_revenue_by_campaign"
[0m11:27:55.311593 [debug] [Thread-1 (]: On model.Marketing.fct_total_revenue_by_campaign: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_total_revenue_by_campaign"} */
create or replace transient table MARKETING.marketing.fct_total_revenue_by_campaign
         as
        (select
    campaign_id,
    sum(revenue_amount) as total_revenue
from MARKETING.marketing.stg_revenue
group by campaign_id
        );
[0m11:27:55.830110 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.519 seconds
[0m11:27:55.830110 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50146545-2850-487f-95b0-b70414aaa5f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BD43404D0>]}
[0m11:27:55.830110 [info ] [Thread-1 (]: 10 of 10 OK created sql table model marketing.fct_total_revenue_by_campaign .... [[32mSUCCESS 1[0m in 0.52s]
[0m11:27:55.846002 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_total_revenue_by_campaign
[0m11:27:55.846002 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:27:55.846002 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m11:27:55.846002 [debug] [MainThread]: On list_MARKETING: Close
[0m11:27:56.165641 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m11:27:56.165641 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m11:27:56.495204 [debug] [MainThread]: Connection 'model.Marketing.fct_total_revenue_by_campaign' was left open.
[0m11:27:56.495204 [debug] [MainThread]: On model.Marketing.fct_total_revenue_by_campaign: Close
[0m11:27:56.823325 [info ] [MainThread]: 
[0m11:27:56.826325 [info ] [MainThread]: Finished running 10 table models in 0 hours 0 minutes and 9.99 seconds (9.99s).
[0m11:27:56.836606 [debug] [MainThread]: Command end result
[0m11:27:56.869850 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m11:27:56.872955 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m11:27:56.880499 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\run_results.json
[0m11:27:56.880499 [info ] [MainThread]: 
[0m11:27:56.881533 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:27:56.882556 [info ] [MainThread]: 
[0m11:27:56.883134 [error] [MainThread]:   Database Error in model fct_lead_time_to_convert (models\final\fct_lead_time_to_convert.sql)
  000904 (42000): SQL compilation error: error line 9 at position 13
  invalid identifier 'CREATED_DATE'
  compiled code at target\run\Marketing\models\final\fct_lead_time_to_convert.sql
[0m11:27:56.883134 [info ] [MainThread]: 
[0m11:27:56.883134 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=1 SKIP=0 TOTAL=10
[0m11:27:56.883134 [debug] [MainThread]: Command `dbt run` failed at 11:27:56.883134 after 12.49 seconds
[0m11:27:56.887352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BD0F087A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BD0F68110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019BCEDB9C70>]}
[0m11:27:56.887352 [debug] [MainThread]: Flushing usage events
[0m11:27:58.061739 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:49:12.201482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A0CA1B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A0CA2090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A0CA2630>]}


============================== 11:49:12.216550 | 4a606f83-1900-41c5-b104-45d29a7d781d ==============================
[0m11:49:12.216550 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:49:12.216550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select fct_lead_time_to_convert', 'send_anonymous_usage_stats': 'True'}
[0m11:49:13.083807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a606f83-1900-41c5-b104-45d29a7d781d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A0EB20F0>]}
[0m11:49:13.152338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a606f83-1900-41c5-b104-45d29a7d781d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A0833AD0>]}
[0m11:49:13.154346 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:49:13.717838 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:49:15.408187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:49:15.408187 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\final\fct_lead_time_to_convert.sql
[0m11:49:15.889140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a606f83-1900-41c5-b104-45d29a7d781d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A30053D0>]}
[0m11:49:16.045074 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m11:49:16.066097 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m11:49:16.117221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a606f83-1900-41c5-b104-45d29a7d781d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A2F77140>]}
[0m11:49:16.117221 [info ] [MainThread]: Found 19 models, 6 data tests, 5 sources, 479 macros
[0m11:49:16.117221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a606f83-1900-41c5-b104-45d29a7d781d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A2FE4380>]}
[0m11:49:16.117221 [info ] [MainThread]: 
[0m11:49:16.121921 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:49:16.122932 [info ] [MainThread]: 
[0m11:49:16.123928 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:49:16.124966 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m11:49:19.281304 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m11:49:19.281304 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m11:49:19.281304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:20.543250 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.261 seconds
[0m11:49:20.550987 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m11:49:20.559075 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m11:49:20.559075 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m11:49:20.559075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:21.562019 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 1.005 seconds
[0m11:49:21.578011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a606f83-1900-41c5-b104-45d29a7d781d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A2F300B0>]}
[0m11:49:21.578011 [debug] [Thread-1 (]: Began running node model.Marketing.fct_lead_time_to_convert
[0m11:49:21.578011 [info ] [Thread-1 (]: 1 of 1 START sql table model marketing.fct_lead_time_to_convert ................ [RUN]
[0m11:49:21.578011 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.fct_lead_time_to_convert'
[0m11:49:21.578011 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_lead_time_to_convert
[0m11:49:21.601916 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_lead_time_to_convert"
[0m11:49:21.603924 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_lead_time_to_convert
[0m11:49:21.629252 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_lead_time_to_convert"
[0m11:49:21.644057 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_lead_time_to_convert"
[0m11:49:21.645099 [debug] [Thread-1 (]: On model.Marketing.fct_lead_time_to_convert: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_lead_time_to_convert"} */
create or replace transient table MARKETING.marketing.fct_lead_time_to_convert
         as
        (with lead_data as (
    -- Join stg_leads and stg_campaigns to get campaign start date and lead conversion info
    select
        l.lead_id,
        l.campaign_id,
        l.is_converted,
        l.converted_date,
        c.start_date,
        -- Calculate Time to Convert if lead is converted
        case 
            when l.is_converted then DATEDIFF(l.converted_date, c.start_date)
            else null
        end as time_to_convert
    from
        MARKETING.marketing.stg_leads l
    left join
        MARKETING.marketing.stg_campaigns c
    on
        l.campaign_id = c.campaign_id
)

-- Aggregate the results to calculate average Time to Convert per campaign
select
    campaign_id,
    avg(time_to_convert) as avg_time_to_convert
from
    lead_data
where
    time_to_convert is not null -- Only consider converted leads
group by
    campaign_id
order by
    avg_time_to_convert;
[0m11:49:21.645099 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:49:22.779658 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbb31c-3201-8a6f-0000-000cd70aab29
[0m11:49:22.779658 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 35 at position 23 unexpected ';'.
[0m11:49:22.795256 [debug] [Thread-1 (]: Database Error in model fct_lead_time_to_convert (models\final\fct_lead_time_to_convert.sql)
  001003 (42000): SQL compilation error:
  syntax error line 35 at position 23 unexpected ';'.
  compiled code at target\run\Marketing\models\final\fct_lead_time_to_convert.sql
[0m11:49:22.795256 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a606f83-1900-41c5-b104-45d29a7d781d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A017DF10>]}
[0m11:49:22.795256 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model marketing.fct_lead_time_to_convert ....... [[31mERROR[0m in 1.22s]
[0m11:49:22.795256 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_lead_time_to_convert
[0m11:49:22.795256 [debug] [Thread-4 (]: Marking all children of 'model.Marketing.fct_lead_time_to_convert' to be skipped because of status 'error'.  Reason: Database Error in model fct_lead_time_to_convert (models\final\fct_lead_time_to_convert.sql)
  001003 (42000): SQL compilation error:
  syntax error line 35 at position 23 unexpected ';'.
  compiled code at target\run\Marketing\models\final\fct_lead_time_to_convert.sql.
[0m11:49:22.795256 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:49:22.795256 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m11:49:22.795256 [debug] [MainThread]: On list_MARKETING: Close
[0m11:49:23.132127 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m11:49:23.134134 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m11:49:23.465618 [debug] [MainThread]: Connection 'model.Marketing.fct_lead_time_to_convert' was left open.
[0m11:49:23.465618 [debug] [MainThread]: On model.Marketing.fct_lead_time_to_convert: Close
[0m11:49:23.792900 [info ] [MainThread]: 
[0m11:49:23.792900 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 7.67 seconds (7.67s).
[0m11:49:23.792900 [debug] [MainThread]: Command end result
[0m11:49:23.830416 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m11:49:23.830416 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m11:49:23.830416 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\run_results.json
[0m11:49:23.830416 [info ] [MainThread]: 
[0m11:49:23.830416 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:49:23.830416 [info ] [MainThread]: 
[0m11:49:23.830416 [error] [MainThread]:   Database Error in model fct_lead_time_to_convert (models\final\fct_lead_time_to_convert.sql)
  001003 (42000): SQL compilation error:
  syntax error line 35 at position 23 unexpected ';'.
  compiled code at target\run\Marketing\models\final\fct_lead_time_to_convert.sql
[0m11:49:23.830416 [info ] [MainThread]: 
[0m11:49:23.847218 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:49:23.847218 [debug] [MainThread]: Command `dbt run` failed at 11:49:23.847218 after 11.85 seconds
[0m11:49:23.851013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A01B0260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A0CA2180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203A0CA2360>]}
[0m11:49:23.851013 [debug] [MainThread]: Flushing usage events
[0m11:49:24.811811 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:49:35.074586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173284230B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017324FE83E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017328422660>]}


============================== 11:49:35.074586 | c40f1752-b53e-4da9-b42d-5c439c4e2017 ==============================
[0m11:49:35.074586 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:49:35.074586 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fct_lead_time_to_convert', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:49:35.600613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c40f1752-b53e-4da9-b42d-5c439c4e2017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173288D7A70>]}
[0m11:49:35.659002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c40f1752-b53e-4da9-b42d-5c439c4e2017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173287AD430>]}
[0m11:49:35.659002 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:49:36.068678 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:49:36.275783 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:49:36.275783 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\final\fct_lead_time_to_convert.sql
[0m11:49:36.676153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c40f1752-b53e-4da9-b42d-5c439c4e2017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001732AB5FE90>]}
[0m11:49:36.829437 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m11:49:36.843534 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m11:49:36.882880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c40f1752-b53e-4da9-b42d-5c439c4e2017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001732AAF7020>]}
[0m11:49:36.883912 [info ] [MainThread]: Found 19 models, 6 data tests, 5 sources, 479 macros
[0m11:49:36.885899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c40f1752-b53e-4da9-b42d-5c439c4e2017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001732AB8BE60>]}
[0m11:49:36.885899 [info ] [MainThread]: 
[0m11:49:36.885899 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:49:36.885899 [info ] [MainThread]: 
[0m11:49:36.892259 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:49:36.894265 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m11:49:36.996961 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m11:49:36.996961 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m11:49:36.996961 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:38.145969 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.155 seconds
[0m11:49:38.178915 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m11:49:38.194864 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m11:49:38.194864 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m11:49:38.194864 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:49:39.188270 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.992 seconds
[0m11:49:39.188270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c40f1752-b53e-4da9-b42d-5c439c4e2017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001732AF99B80>]}
[0m11:49:39.204006 [debug] [Thread-1 (]: Began running node model.Marketing.fct_lead_time_to_convert
[0m11:49:39.204006 [info ] [Thread-1 (]: 1 of 1 START sql table model marketing.fct_lead_time_to_convert ................ [RUN]
[0m11:49:39.204006 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.fct_lead_time_to_convert'
[0m11:49:39.204006 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_lead_time_to_convert
[0m11:49:39.204006 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_lead_time_to_convert"
[0m11:49:39.204006 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_lead_time_to_convert
[0m11:49:39.262088 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_lead_time_to_convert"
[0m11:49:39.262088 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_lead_time_to_convert"
[0m11:49:39.262088 [debug] [Thread-1 (]: On model.Marketing.fct_lead_time_to_convert: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_lead_time_to_convert"} */
create or replace transient table MARKETING.marketing.fct_lead_time_to_convert
         as
        (with lead_data as (
    -- Join stg_leads and stg_campaigns to get campaign start date and lead conversion info
    select
        l.lead_id,
        l.campaign_id,
        l.is_converted,
        l.converted_date,
        c.start_date,
        -- Calculate Time to Convert if lead is converted
        case 
            when l.is_converted then DATEDIFF(l.converted_date, c.start_date)
            else null
        end as time_to_convert
    from
        MARKETING.marketing.stg_leads l
    left join
        MARKETING.marketing.stg_campaigns c
    on
        l.campaign_id = c.campaign_id
)

-- Aggregate the results to calculate average Time to Convert per campaign
select
    campaign_id,
    avg(time_to_convert) as avg_time_to_convert
from
    lead_data
where
    time_to_convert is not null -- Only consider converted leads
group by
    campaign_id
order by
    avg_time_to_convert
        );
[0m11:49:39.262088 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:49:40.185887 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbb31c-3201-8a6f-0000-000cd70aab31
[0m11:49:40.185887 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000938 (22023): SQL compilation error: error line 13 at position 37
not enough arguments for function [DATEDIFF('CONVERTED_DATE', C.START_DATE)], expected 3, got 2
[0m11:49:40.189906 [debug] [Thread-1 (]: Database Error in model fct_lead_time_to_convert (models\final\fct_lead_time_to_convert.sql)
  000938 (22023): SQL compilation error: error line 13 at position 37
  not enough arguments for function [DATEDIFF('CONVERTED_DATE', C.START_DATE)], expected 3, got 2
  compiled code at target\run\Marketing\models\final\fct_lead_time_to_convert.sql
[0m11:49:40.191915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c40f1752-b53e-4da9-b42d-5c439c4e2017', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017327D6DC10>]}
[0m11:49:40.195131 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model marketing.fct_lead_time_to_convert ....... [[31mERROR[0m in 0.99s]
[0m11:49:40.196928 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_lead_time_to_convert
[0m11:49:40.197928 [debug] [Thread-4 (]: Marking all children of 'model.Marketing.fct_lead_time_to_convert' to be skipped because of status 'error'.  Reason: Database Error in model fct_lead_time_to_convert (models\final\fct_lead_time_to_convert.sql)
  000938 (22023): SQL compilation error: error line 13 at position 37
  not enough arguments for function [DATEDIFF('CONVERTED_DATE', C.START_DATE)], expected 3, got 2
  compiled code at target\run\Marketing\models\final\fct_lead_time_to_convert.sql.
[0m11:49:40.199928 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:49:40.200927 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m11:49:40.201926 [debug] [MainThread]: On list_MARKETING: Close
[0m11:49:40.512701 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m11:49:40.512701 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m11:49:40.837505 [debug] [MainThread]: Connection 'model.Marketing.fct_lead_time_to_convert' was left open.
[0m11:49:40.845558 [debug] [MainThread]: On model.Marketing.fct_lead_time_to_convert: Close
[0m11:49:41.180834 [info ] [MainThread]: 
[0m11:49:41.180834 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.29 seconds (4.29s).
[0m11:49:41.180834 [debug] [MainThread]: Command end result
[0m11:49:41.219466 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m11:49:41.222464 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m11:49:41.222464 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\run_results.json
[0m11:49:41.230184 [info ] [MainThread]: 
[0m11:49:41.231196 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:49:41.232192 [info ] [MainThread]: 
[0m11:49:41.232192 [error] [MainThread]:   Database Error in model fct_lead_time_to_convert (models\final\fct_lead_time_to_convert.sql)
  000938 (22023): SQL compilation error: error line 13 at position 37
  not enough arguments for function [DATEDIFF('CONVERTED_DATE', C.START_DATE)], expected 3, got 2
  compiled code at target\run\Marketing\models\final\fct_lead_time_to_convert.sql
[0m11:49:41.232192 [info ] [MainThread]: 
[0m11:49:41.232192 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:49:41.232192 [debug] [MainThread]: Command `dbt run` failed at 11:49:41.232192 after 6.35 seconds
[0m11:49:41.232192 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173282B7FB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017325A9D310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001732AB456A0>]}
[0m11:49:41.232192 [debug] [MainThread]: Flushing usage events
[0m11:49:42.098315 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:51:13.793045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222CE048F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222CDE216A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222CDE208F0>]}


============================== 11:51:13.793045 | 85c109be-394b-4c9f-9ad8-063d59d0e689 ==============================
[0m11:51:13.793045 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:51:13.793045 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select fct_lead_time_to_convert', 'send_anonymous_usage_stats': 'True'}
[0m11:51:14.316302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '85c109be-394b-4c9f-9ad8-063d59d0e689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222CDCD0980>]}
[0m11:51:14.373226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '85c109be-394b-4c9f-9ad8-063d59d0e689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222CEE3E6F0>]}
[0m11:51:14.373226 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:51:14.767830 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:51:14.983884 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:51:14.984888 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\final\fct_lead_time_to_convert.sql
[0m11:51:15.344700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '85c109be-394b-4c9f-9ad8-063d59d0e689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222D04E0D70>]}
[0m11:51:15.508114 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m11:51:15.508114 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m11:51:15.539626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '85c109be-394b-4c9f-9ad8-063d59d0e689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222D0527020>]}
[0m11:51:15.539626 [info ] [MainThread]: Found 19 models, 6 data tests, 5 sources, 479 macros
[0m11:51:15.539626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85c109be-394b-4c9f-9ad8-063d59d0e689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222D0616810>]}
[0m11:51:15.539626 [info ] [MainThread]: 
[0m11:51:15.539626 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:51:15.539626 [info ] [MainThread]: 
[0m11:51:15.539626 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:51:15.539626 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m11:51:15.659626 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m11:51:15.659626 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m11:51:15.660627 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:16.887025 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.229 seconds
[0m11:51:16.887025 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m11:51:16.903091 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m11:51:16.903091 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m11:51:16.903091 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:17.883310 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.976 seconds
[0m11:51:17.888420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '85c109be-394b-4c9f-9ad8-063d59d0e689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222D05EF560>]}
[0m11:51:17.895619 [debug] [Thread-1 (]: Began running node model.Marketing.fct_lead_time_to_convert
[0m11:51:17.895619 [info ] [Thread-1 (]: 1 of 1 START sql table model marketing.fct_lead_time_to_convert ................ [RUN]
[0m11:51:17.895619 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.fct_lead_time_to_convert'
[0m11:51:17.895619 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_lead_time_to_convert
[0m11:51:17.910826 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_lead_time_to_convert"
[0m11:51:17.911822 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_lead_time_to_convert
[0m11:51:17.950545 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_lead_time_to_convert"
[0m11:51:17.950545 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_lead_time_to_convert"
[0m11:51:17.950545 [debug] [Thread-1 (]: On model.Marketing.fct_lead_time_to_convert: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_lead_time_to_convert"} */
create or replace transient table MARKETING.marketing.fct_lead_time_to_convert
         as
        (with lead_data as (
    -- Join stg_leads and stg_campaigns to get campaign start date and lead conversion info
    select
        l.lead_id,
        l.campaign_id,
        l.is_converted,
        l.converted_date,
        c.start_date,
        -- Correct usage of DATEDIFF with 'DAY' as the first argument
        case 
            when l.is_converted then DATEDIFF('DAY', c.start_date, l.converted_date)
            else null
        end as time_to_convert
    from
        MARKETING.marketing.stg_leads l
    left join
        MARKETING.marketing.stg_campaigns c
    on
        l.campaign_id = c.campaign_id
)

-- Aggregate the results to calculate average Time to Convert per campaign
select
    campaign_id,
    avg(time_to_convert) as avg_time_to_convert
from
    lead_data
where
    time_to_convert is not null -- Only consider converted leads
group by
    campaign_id
order by
    avg_time_to_convert;
[0m11:51:17.950545 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:51:18.866862 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bbb31e-3201-8a6f-0000-000cd70aab39
[0m11:51:18.866862 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 35 at position 23 unexpected ';'.
[0m11:51:18.871862 [debug] [Thread-1 (]: Database Error in model fct_lead_time_to_convert (models\final\fct_lead_time_to_convert.sql)
  001003 (42000): SQL compilation error:
  syntax error line 35 at position 23 unexpected ';'.
  compiled code at target\run\Marketing\models\final\fct_lead_time_to_convert.sql
[0m11:51:18.874831 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '85c109be-394b-4c9f-9ad8-063d59d0e689', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222CD76DB80>]}
[0m11:51:18.875840 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model marketing.fct_lead_time_to_convert ....... [[31mERROR[0m in 0.98s]
[0m11:51:18.876842 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_lead_time_to_convert
[0m11:51:18.877840 [debug] [Thread-4 (]: Marking all children of 'model.Marketing.fct_lead_time_to_convert' to be skipped because of status 'error'.  Reason: Database Error in model fct_lead_time_to_convert (models\final\fct_lead_time_to_convert.sql)
  001003 (42000): SQL compilation error:
  syntax error line 35 at position 23 unexpected ';'.
  compiled code at target\run\Marketing\models\final\fct_lead_time_to_convert.sql.
[0m11:51:18.880059 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:18.880059 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m11:51:18.881060 [debug] [MainThread]: On list_MARKETING: Close
[0m11:51:19.207194 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m11:51:19.208158 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m11:51:19.527954 [debug] [MainThread]: Connection 'model.Marketing.fct_lead_time_to_convert' was left open.
[0m11:51:19.527954 [debug] [MainThread]: On model.Marketing.fct_lead_time_to_convert: Close
[0m11:51:19.842400 [info ] [MainThread]: 
[0m11:51:19.858499 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.30 seconds (4.30s).
[0m11:51:19.858499 [debug] [MainThread]: Command end result
[0m11:51:19.896107 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m11:51:19.899131 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m11:51:19.901858 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\run_results.json
[0m11:51:19.901858 [info ] [MainThread]: 
[0m11:51:19.901858 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m11:51:19.901858 [info ] [MainThread]: 
[0m11:51:19.901858 [error] [MainThread]:   Database Error in model fct_lead_time_to_convert (models\final\fct_lead_time_to_convert.sql)
  001003 (42000): SQL compilation error:
  syntax error line 35 at position 23 unexpected ';'.
  compiled code at target\run\Marketing\models\final\fct_lead_time_to_convert.sql
[0m11:51:19.901858 [info ] [MainThread]: 
[0m11:51:19.901858 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m11:51:19.911780 [debug] [MainThread]: Command `dbt run` failed at 11:51:19.901858 after 6.28 seconds
[0m11:51:19.911780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222CE292570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222CD7A0260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222CB491550>]}
[0m11:51:19.912810 [debug] [MainThread]: Flushing usage events
[0m11:51:20.862416 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:51:28.959373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200331C83B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020035FA8260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020035FA8470>]}


============================== 11:51:28.964371 | 59d3dd53-30b2-45bb-89e0-49a5f83959f2 ==============================
[0m11:51:28.964371 [info ] [MainThread]: Running with dbt=1.9.4
[0m11:51:28.965342 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --select fct_lead_time_to_convert', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:51:29.481571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59d3dd53-30b2-45bb-89e0-49a5f83959f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200368BEDB0>]}
[0m11:51:29.538548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59d3dd53-30b2-45bb-89e0-49a5f83959f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002003665F6B0>]}
[0m11:51:29.555461 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m11:51:29.938643 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m11:51:30.139221 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:51:30.139221 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\final\fct_lead_time_to_convert.sql
[0m11:51:30.540110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59d3dd53-30b2-45bb-89e0-49a5f83959f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020038C214C0>]}
[0m11:51:30.689841 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m11:51:30.705312 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m11:51:30.739803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59d3dd53-30b2-45bb-89e0-49a5f83959f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020038D95040>]}
[0m11:51:30.739803 [info ] [MainThread]: Found 19 models, 6 data tests, 5 sources, 479 macros
[0m11:51:30.739803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59d3dd53-30b2-45bb-89e0-49a5f83959f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020035FA8380>]}
[0m11:51:30.739803 [info ] [MainThread]: 
[0m11:51:30.739803 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:51:30.739803 [info ] [MainThread]: 
[0m11:51:30.739803 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:51:30.739803 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m11:51:30.843726 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m11:51:30.843726 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m11:51:30.856062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:32.024822 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.179 seconds
[0m11:51:32.042016 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m11:51:32.062305 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m11:51:32.062305 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m11:51:32.062305 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:51:33.007086 [debug] [ThreadPool]: SQL status: SUCCESS 18 in 0.943 seconds
[0m11:51:33.007086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59d3dd53-30b2-45bb-89e0-49a5f83959f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200387115E0>]}
[0m11:51:33.007086 [debug] [Thread-1 (]: Began running node model.Marketing.fct_lead_time_to_convert
[0m11:51:33.022822 [info ] [Thread-1 (]: 1 of 1 START sql table model marketing.fct_lead_time_to_convert ................ [RUN]
[0m11:51:33.022822 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.fct_lead_time_to_convert'
[0m11:51:33.022822 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_lead_time_to_convert
[0m11:51:33.022822 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_lead_time_to_convert"
[0m11:51:33.022822 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_lead_time_to_convert
[0m11:51:33.059045 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_lead_time_to_convert"
[0m11:51:33.074001 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_lead_time_to_convert"
[0m11:51:33.074914 [debug] [Thread-1 (]: On model.Marketing.fct_lead_time_to_convert: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_lead_time_to_convert"} */
create or replace transient table MARKETING.marketing.fct_lead_time_to_convert
         as
        (with lead_data as (
    -- Join stg_leads and stg_campaigns to get campaign start date and lead conversion info
    select
        l.lead_id,
        l.campaign_id,
        l.is_converted,
        l.converted_date,
        c.start_date,
        -- Correct usage of DATEDIFF with 'DAY' as the first argument
        case 
            when l.is_converted then DATEDIFF('DAY', c.start_date, l.converted_date)
            else null
        end as time_to_convert
    from
        MARKETING.marketing.stg_leads l
    left join
        MARKETING.marketing.stg_campaigns c
    on
        l.campaign_id = c.campaign_id
)

-- Aggregate the results to calculate average Time to Convert per campaign
select
    campaign_id,
    avg(time_to_convert) as avg_time_to_convert
from
    lead_data
where
    time_to_convert is not null -- Only consider converted leads
group by
    campaign_id
order by
    avg_time_to_convert
        );
[0m11:51:33.075530 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:51:34.891560 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.817 seconds
[0m11:51:34.906747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59d3dd53-30b2-45bb-89e0-49a5f83959f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020033B87080>]}
[0m11:51:34.906747 [info ] [Thread-1 (]: 1 of 1 OK created sql table model marketing.fct_lead_time_to_convert ........... [[32mSUCCESS 1[0m in 1.88s]
[0m11:51:34.906747 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_lead_time_to_convert
[0m11:51:34.906747 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:51:34.906747 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m11:51:34.922458 [debug] [MainThread]: On list_MARKETING: Close
[0m11:51:35.246367 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m11:51:35.246367 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m11:51:35.578875 [debug] [MainThread]: Connection 'model.Marketing.fct_lead_time_to_convert' was left open.
[0m11:51:35.578875 [debug] [MainThread]: On model.Marketing.fct_lead_time_to_convert: Close
[0m11:51:35.897924 [info ] [MainThread]: 
[0m11:51:35.897924 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.16 seconds (5.16s).
[0m11:51:35.897924 [debug] [MainThread]: Command end result
[0m11:51:35.940229 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m11:51:35.940229 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m11:51:35.951559 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\run_results.json
[0m11:51:35.952336 [info ] [MainThread]: 
[0m11:51:35.952336 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:51:35.952336 [info ] [MainThread]: 
[0m11:51:35.952336 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:51:35.952336 [debug] [MainThread]: Command `dbt run` succeeded at 11:51:35.952336 after 7.16 seconds
[0m11:51:35.952336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000200331C83B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020036A11B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020036A11970>]}
[0m11:51:35.952336 [debug] [MainThread]: Flushing usage events
[0m11:51:36.879814 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:26:18.751277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7ACDA7DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7ACCB90A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7AC4584D0>]}


============================== 12:26:18.758791 | 046ea526-49d8-4347-b81d-34b537ea61db ==============================
[0m12:26:18.758791 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:26:18.758791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select fct_inactive_campaigns', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:26:19.614801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '046ea526-49d8-4347-b81d-34b537ea61db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A9696D20>]}
[0m12:26:19.690961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '046ea526-49d8-4347-b81d-34b537ea61db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7AEB51B50>]}
[0m12:26:19.690961 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:26:20.301985 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m12:26:22.256700 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m12:26:22.256700 [debug] [MainThread]: Partial parsing: updated file: Marketing://models\final\fct_lead_time_to_convert.sql
[0m12:26:22.693046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '046ea526-49d8-4347-b81d-34b537ea61db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7AF169DC0>]}
[0m12:26:22.848354 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m12:26:22.873359 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m12:26:22.925632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '046ea526-49d8-4347-b81d-34b537ea61db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7AF127020>]}
[0m12:26:22.926632 [info ] [MainThread]: Found 19 models, 6 data tests, 5 sources, 479 macros
[0m12:26:22.927634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '046ea526-49d8-4347-b81d-34b537ea61db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7AF215FA0>]}
[0m12:26:22.929632 [info ] [MainThread]: 
[0m12:26:22.930636 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:26:22.930636 [info ] [MainThread]: 
[0m12:26:22.931632 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:26:22.932632 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m12:26:26.305724 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m12:26:26.305724 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m12:26:26.305724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:27.625563 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.320 seconds
[0m12:26:27.627573 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m12:26:27.641604 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m12:26:27.641604 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m12:26:27.641604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:26:28.597895 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 0.951 seconds
[0m12:26:28.603892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '046ea526-49d8-4347-b81d-34b537ea61db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7AD9D74A0>]}
[0m12:26:28.612054 [debug] [Thread-1 (]: Began running node model.Marketing.fct_inactive_campaigns
[0m12:26:28.613084 [info ] [Thread-1 (]: 1 of 1 START sql table model marketing.fct_inactive_campaigns .................. [RUN]
[0m12:26:28.613084 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.fct_inactive_campaigns'
[0m12:26:28.614405 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_inactive_campaigns
[0m12:26:28.623415 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_inactive_campaigns"
[0m12:26:28.624414 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_inactive_campaigns
[0m12:26:28.662771 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_inactive_campaigns"
[0m12:26:28.662771 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_inactive_campaigns"
[0m12:26:28.662771 [debug] [Thread-1 (]: On model.Marketing.fct_inactive_campaigns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_inactive_campaigns"} */
create or replace transient table MARKETING.marketing.fct_inactive_campaigns
         as
        (with leads as (
    select campaign_id, count(*) as total_leads
    from MARKETING.marketing.stg_leads
    group by campaign_id
),

conversions as (
    select campaign_id, count(*) as converted_leads
    from MARKETING.marketing.stg_leads
    where is_converted = true
    group by campaign_id
)

select
    c.campaign_id,
    c.campaign_name,
    coalesce(l.total_leads, 0) as total_leads,
    coalesce(cv.converted_leads, 0) as converted_leads
from MARKETING.marketing.stg_campaigns c
left join leads l on c.campaign_id = l.campaign_id
left join conversions cv on c.campaign_id = cv.campaign_id
where coalesce(l.total_leads, 0) = 0 or coalesce(cv.converted_leads, 0) = 0
        );
[0m12:26:28.662771 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:26:30.158851 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.487 seconds
[0m12:26:30.189104 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '046ea526-49d8-4347-b81d-34b537ea61db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7A9FF7080>]}
[0m12:26:30.190096 [info ] [Thread-1 (]: 1 of 1 OK created sql table model marketing.fct_inactive_campaigns ............. [[32mSUCCESS 1[0m in 1.57s]
[0m12:26:30.190487 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_inactive_campaigns
[0m12:26:30.192494 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:26:30.192494 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m12:26:30.193526 [debug] [MainThread]: On list_MARKETING: Close
[0m12:26:30.500253 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m12:26:30.515479 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m12:26:30.832827 [debug] [MainThread]: Connection 'model.Marketing.fct_inactive_campaigns' was left open.
[0m12:26:30.832827 [debug] [MainThread]: On model.Marketing.fct_inactive_campaigns: Close
[0m12:26:31.175750 [info ] [MainThread]: 
[0m12:26:31.178740 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.24 seconds (8.24s).
[0m12:26:31.182290 [debug] [MainThread]: Command end result
[0m12:26:31.238325 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m12:26:31.240325 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m12:26:31.247326 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\run_results.json
[0m12:26:31.248327 [info ] [MainThread]: 
[0m12:26:31.248327 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:26:31.249328 [info ] [MainThread]: 
[0m12:26:31.250312 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:26:31.251359 [debug] [MainThread]: Command `dbt run` succeeded at 12:26:31.251359 after 12.75 seconds
[0m12:26:31.251359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7ACDD81A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7ACA53440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7ACA52A50>]}
[0m12:26:31.252351 [debug] [MainThread]: Flushing usage events
[0m12:26:32.143683 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:31:59.011252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5EB55AD20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5EE358200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5EE358350>]}


============================== 12:31:59.022149 | c9090016-31e0-4549-a509-ca72119ab46d ==============================
[0m12:31:59.022149 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:31:59.022149 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\Marketing\\logs', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt ', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:31:59.067164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F3A43260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F3A43E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F3A43B90>]}


============================== 12:31:59.073180 | a19edbef-b5d8-455b-8e03-5e296c1893fa ==============================
[0m12:31:59.073180 [info ] [MainThread]: Running with dbt=1.9.4
[0m12:31:59.074952 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'c:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\Marketing\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:31:59.174139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9090016-31e0-4549-a509-ca72119ab46d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5EEB73F80>]}
[0m12:31:59.221620 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:31:59.221620 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m12:31:59.226012 [debug] [MainThread]: Command `cli deps` succeeded at 12:31:59.226012 after 0.45 seconds
[0m12:31:59.226012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5EE9B73E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5EE952720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5EE953F20>]}
[0m12:31:59.226012 [debug] [MainThread]: Flushing usage events
[0m12:31:59.588749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a19edbef-b5d8-455b-8e03-5e296c1893fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F11423F0>]}
[0m12:31:59.666419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a19edbef-b5d8-455b-8e03-5e296c1893fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F27F3AA0>]}
[0m12:31:59.668427 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m12:32:00.225631 [debug] [MainThread]: checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, vars: {}, profile: , target: dev, version: 1.9.4
[0m12:32:00.243508 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:32:00.360792 [info ] [MainThread]: Unable to do partial parsing because config vars, config profile, or config target have changed
[0m12:32:00.360792 [debug] [MainThread]: previous checksum: 53ed91fada2233efb98368d1716b44ab532c83a9c293cf1890b7905d5b45fb25, current checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c
[0m12:32:00.360792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'a19edbef-b5d8-455b-8e03-5e296c1893fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F5AF6750>]}
[0m12:32:02.444599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a19edbef-b5d8-455b-8e03-5e296c1893fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F611C980>]}
[0m12:32:02.552745 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\RajgokulRM\Documents\DE_FINAL\Marketing\target\manifest.json
[0m12:32:02.677794 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\RajgokulRM\Documents\DE_FINAL\Marketing\target\semantic_manifest.json
[0m12:32:02.770781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a19edbef-b5d8-455b-8e03-5e296c1893fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F62BE960>]}
[0m12:32:02.770781 [info ] [MainThread]: Found 20 models, 6 data tests, 5 sources, 479 macros
[0m12:32:02.789327 [info ] [MainThread]: 
[0m12:32:02.790328 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:32:02.790851 [info ] [MainThread]: 
[0m12:32:02.791703 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:32:02.792963 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m12:32:07.308315 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m12:32:07.308315 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m12:32:07.309313 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:08.706383 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.397 seconds
[0m12:32:08.714293 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m12:32:08.717880 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m12:32:08.717880 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m12:32:08.717880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:32:09.755974 [debug] [ThreadPool]: SQL status: SUCCESS 19 in 1.038 seconds
[0m12:32:09.780937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a19edbef-b5d8-455b-8e03-5e296c1893fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F6255460>]}
[0m12:32:09.785755 [debug] [Thread-1 (]: Began running node model.Marketing.tmp_campaign_lead_check
[0m12:32:09.785755 [info ] [Thread-1 (]: 1 of 1 START sql view model marketing.tmp_campaign_lead_check .................. [RUN]
[0m12:32:09.785755 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.tmp_campaign_lead_check'
[0m12:32:09.785755 [debug] [Thread-1 (]: Began compiling node model.Marketing.tmp_campaign_lead_check
[0m12:32:09.806613 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.tmp_campaign_lead_check"
[0m12:32:09.807578 [debug] [Thread-1 (]: Began executing node model.Marketing.tmp_campaign_lead_check
[0m12:32:09.836993 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.tmp_campaign_lead_check"
[0m12:32:09.836993 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.tmp_campaign_lead_check"
[0m12:32:09.836993 [debug] [Thread-1 (]: On model.Marketing.tmp_campaign_lead_check: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.tmp_campaign_lead_check"} */
create or replace   view MARKETING.marketing.tmp_campaign_lead_check
  
   as (
    select 
    campaign_id,
    count(*) as total_leads,
    sum(case when is_converted then 1 else 0 end) as total_conversions
from MARKETING.marketing.stg_leads
group by campaign_id
order by total_leads desc
  );
[0m12:32:09.836993 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m12:32:10.831279 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.982 seconds
[0m12:32:10.854154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a19edbef-b5d8-455b-8e03-5e296c1893fa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F0FE70B0>]}
[0m12:32:10.858629 [info ] [Thread-1 (]: 1 of 1 OK created sql view model marketing.tmp_campaign_lead_check ............. [[32mSUCCESS 1[0m in 1.07s]
[0m12:32:10.858629 [debug] [Thread-1 (]: Finished running node model.Marketing.tmp_campaign_lead_check
[0m12:32:10.858629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:32:10.858629 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m12:32:10.858629 [debug] [MainThread]: On list_MARKETING: Close
[0m12:32:11.171103 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m12:32:11.171103 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m12:32:11.504449 [debug] [MainThread]: Connection 'model.Marketing.tmp_campaign_lead_check' was left open.
[0m12:32:11.504449 [debug] [MainThread]: On model.Marketing.tmp_campaign_lead_check: Close
[0m12:32:11.839518 [info ] [MainThread]: 
[0m12:32:11.841467 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 9.05 seconds (9.05s).
[0m12:32:11.845463 [debug] [MainThread]: Command end result
[0m12:32:11.944684 [debug] [MainThread]: Wrote artifact WritableManifest to c:\Users\RajgokulRM\Documents\DE_FINAL\Marketing\target\manifest.json
[0m12:32:11.944684 [debug] [MainThread]: Wrote artifact SemanticManifest to c:\Users\RajgokulRM\Documents\DE_FINAL\Marketing\target\semantic_manifest.json
[0m12:32:11.954849 [debug] [MainThread]: Wrote artifact RunExecutionResult to c:\Users\RajgokulRM\Documents\DE_FINAL\Marketing\target\run_results.json
[0m12:32:11.954849 [info ] [MainThread]: 
[0m12:32:11.955883 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:32:11.956851 [info ] [MainThread]: 
[0m12:32:11.957855 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m12:32:11.958852 [debug] [MainThread]: Command `cli build` succeeded at 12:32:11.958852 after 13.13 seconds
[0m12:32:11.959883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F39DFE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F39DF0B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198F6A0F9B0>]}
[0m12:32:11.960411 [debug] [MainThread]: Flushing usage events
[0m12:32:12.855772 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:03:04.767766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F44C1EBA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F45018440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F487D9670>]}


============================== 14:03:04.767766 | 74d73d0b-87dc-4442-b2c9-409b3d6dc81f ==============================
[0m14:03:04.767766 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:03:04.783496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select fct_campaign_channel_effectiveness', 'send_anonymous_usage_stats': 'True'}
[0m14:03:05.715558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74d73d0b-87dc-4442-b2c9-409b3d6dc81f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F4A6FCD40>]}
[0m14:03:05.790710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74d73d0b-87dc-4442-b2c9-409b3d6dc81f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F47DD10A0>]}
[0m14:03:05.792701 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:03:06.349595 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:03:06.558613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:03:06.560620 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:03:06.613890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74d73d0b-87dc-4442-b2c9-409b3d6dc81f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F4A68CFE0>]}
[0m14:03:06.722556 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m14:03:06.749541 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m14:03:06.802328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74d73d0b-87dc-4442-b2c9-409b3d6dc81f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F4A9055B0>]}
[0m14:03:06.802328 [info ] [MainThread]: Found 20 models, 6 data tests, 5 sources, 479 macros
[0m14:03:06.803361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74d73d0b-87dc-4442-b2c9-409b3d6dc81f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F4AB243E0>]}
[0m14:03:06.806330 [info ] [MainThread]: 
[0m14:03:06.806330 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:03:06.806330 [info ] [MainThread]: 
[0m14:03:06.806330 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:03:06.806330 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m14:03:10.137160 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m14:03:10.137160 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m14:03:10.137160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:11.490936 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.366 seconds
[0m14:03:11.509971 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m14:03:11.523166 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m14:03:11.526772 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m14:03:11.527829 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:12.550360 [debug] [ThreadPool]: SQL status: SUCCESS 20 in 1.022 seconds
[0m14:03:12.573212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74d73d0b-87dc-4442-b2c9-409b3d6dc81f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F4AEBDB80>]}
[0m14:03:12.585080 [debug] [Thread-1 (]: Began running node model.Marketing.fct_campaign_channel_effectiveness
[0m14:03:12.586119 [info ] [Thread-1 (]: 1 of 1 START sql table model marketing.fct_campaign_channel_effectiveness ...... [RUN]
[0m14:03:12.587129 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.fct_campaign_channel_effectiveness'
[0m14:03:12.588118 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_campaign_channel_effectiveness
[0m14:03:12.601647 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_campaign_channel_effectiveness"
[0m14:03:12.603653 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_campaign_channel_effectiveness
[0m14:03:12.629160 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_campaign_channel_effectiveness"
[0m14:03:12.645289 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_campaign_channel_effectiveness"
[0m14:03:12.646287 [debug] [Thread-1 (]: On model.Marketing.fct_campaign_channel_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_campaign_channel_effectiveness"} */
create or replace transient table MARKETING.marketing.fct_campaign_channel_effectiveness
         as
        (with leads as (
    select campaign_id, count(*) as total_leads
    from MARKETING.marketing.stg_leads
    group by campaign_id
),

conversions as (
    select campaign_id, count(*) as converted_leads
    from MARKETING.marketing.stg_leads
    where is_converted = true
    group by campaign_id
),

campaign_summary as (
    select
        c.channel_id,
        l.total_leads,
        cv.converted_leads
    from MARKETING.marketing.stg_campaigns c
    left join leads l on c.campaign_id = l.campaign_id
    left join conversions cv on c.campaign_id = cv.campaign_id
)

select
    channel_id,
    sum(total_leads) as total_leads,
    sum(converted_leads) as total_conversions,
    round(sum(converted_leads) * 1.0 / nullif(sum(total_leads), 0), 2) as conversion_rate
from campaign_summary
group by channel_id
order by conversion_rate desc
        );
[0m14:03:12.646287 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:03:14.613602 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.969 seconds
[0m14:03:14.660550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74d73d0b-87dc-4442-b2c9-409b3d6dc81f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F47D9DAF0>]}
[0m14:03:14.660550 [info ] [Thread-1 (]: 1 of 1 OK created sql table model marketing.fct_campaign_channel_effectiveness . [[32mSUCCESS 1[0m in 2.07s]
[0m14:03:14.660550 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_campaign_channel_effectiveness
[0m14:03:14.660550 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:03:14.660550 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m14:03:14.660550 [debug] [MainThread]: On list_MARKETING: Close
[0m14:03:15.001524 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m14:03:15.001524 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m14:03:15.339620 [debug] [MainThread]: Connection 'model.Marketing.fct_campaign_channel_effectiveness' was left open.
[0m14:03:15.339620 [debug] [MainThread]: On model.Marketing.fct_campaign_channel_effectiveness: Close
[0m14:03:15.651386 [info ] [MainThread]: 
[0m14:03:15.651386 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.85 seconds (8.85s).
[0m14:03:15.667039 [debug] [MainThread]: Command end result
[0m14:03:15.764607 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m14:03:15.768605 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m14:03:15.776605 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\run_results.json
[0m14:03:15.777607 [info ] [MainThread]: 
[0m14:03:15.778606 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:03:15.778606 [info ] [MainThread]: 
[0m14:03:15.779606 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:03:15.780938 [debug] [MainThread]: Command `dbt run` succeeded at 14:03:15.780938 after 11.25 seconds
[0m14:03:15.781971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F4809CFB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F47D7B1D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015F47D7B500>]}
[0m14:03:15.781971 [debug] [MainThread]: Flushing usage events
[0m14:03:16.771532 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:06:08.889671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD25252A80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD24EA5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD24C93AA0>]}


============================== 14:06:08.905499 | d2e8b196-437c-45ab-9ea9-621f4f6db8df ==============================
[0m14:06:08.905499 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:06:08.905499 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select fct_campaign_channel_effectiveness', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:06:10.004913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd2e8b196-437c-45ab-9ea9-621f4f6db8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD27497AD0>]}
[0m14:06:10.086896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd2e8b196-437c-45ab-9ea9-621f4f6db8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD2763BC80>]}
[0m14:06:10.088222 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:06:10.576721 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:06:10.772113 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:06:10.772113 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:06:10.822209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd2e8b196-437c-45ab-9ea9-621f4f6db8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD276B8710>]}
[0m14:06:10.922351 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m14:06:10.973120 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m14:06:11.039122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd2e8b196-437c-45ab-9ea9-621f4f6db8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD27A45F40>]}
[0m14:06:11.039122 [info ] [MainThread]: Found 20 models, 6 data tests, 5 sources, 479 macros
[0m14:06:11.039122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2e8b196-437c-45ab-9ea9-621f4f6db8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD27A27B00>]}
[0m14:06:11.039122 [info ] [MainThread]: 
[0m14:06:11.039122 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:06:11.039122 [info ] [MainThread]: 
[0m14:06:11.039122 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:06:11.039122 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m14:06:11.244838 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m14:06:11.245839 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m14:06:11.246839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:12.790111 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.552 seconds
[0m14:06:12.811005 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m14:06:12.823916 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m14:06:12.824988 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m14:06:12.825989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:13.775278 [debug] [ThreadPool]: SQL status: SUCCESS 20 in 0.954 seconds
[0m14:06:13.806587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd2e8b196-437c-45ab-9ea9-621f4f6db8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD276C8440>]}
[0m14:06:13.838314 [debug] [Thread-1 (]: Began running node model.Marketing.fct_campaign_channel_effectiveness
[0m14:06:13.838314 [info ] [Thread-1 (]: 1 of 1 START sql table model marketing.fct_campaign_channel_effectiveness ...... [RUN]
[0m14:06:13.840804 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.fct_campaign_channel_effectiveness'
[0m14:06:13.840804 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_campaign_channel_effectiveness
[0m14:06:13.858313 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_campaign_channel_effectiveness"
[0m14:06:13.861140 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_campaign_channel_effectiveness
[0m14:06:13.892140 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_campaign_channel_effectiveness"
[0m14:06:13.892140 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_campaign_channel_effectiveness"
[0m14:06:13.892140 [debug] [Thread-1 (]: On model.Marketing.fct_campaign_channel_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_campaign_channel_effectiveness"} */
create or replace transient table MARKETING.marketing.fct_campaign_channel_effectiveness
         as
        (with leads as (
    select campaign_id, count(*) as total_leads
    from MARKETING.marketing.stg_leads
    group by campaign_id
),

conversions as (
    select campaign_id, count(*) as converted_leads
    from MARKETING.marketing.stg_leads
    where is_converted = true
    group by campaign_id
)

select
    c.campaign_id,
    c.campaign_name,
    c.channel_id,
    l.total_leads,
    cv.converted_leads,
    round(cv.converted_leads * 1.0 / nullif(l.total_leads, 0), 2) as conversion_rate
from MARKETING.marketing.stg_campaigns c
left join leads l on c.campaign_id = l.campaign_id
left join conversions cv on c.campaign_id = cv.campaign_id
        );
[0m14:06:13.892140 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:06:15.493993 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.599 seconds
[0m14:06:15.525865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd2e8b196-437c-45ab-9ea9-621f4f6db8df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD24CEDDF0>]}
[0m14:06:15.525865 [info ] [Thread-1 (]: 1 of 1 OK created sql table model marketing.fct_campaign_channel_effectiveness . [[32mSUCCESS 1[0m in 1.69s]
[0m14:06:15.525865 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_campaign_channel_effectiveness
[0m14:06:15.525865 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:15.525865 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m14:06:15.525865 [debug] [MainThread]: On list_MARKETING: Close
[0m14:06:15.872448 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m14:06:15.872448 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m14:06:16.194257 [debug] [MainThread]: Connection 'model.Marketing.fct_campaign_channel_effectiveness' was left open.
[0m14:06:16.194257 [debug] [MainThread]: On model.Marketing.fct_campaign_channel_effectiveness: Close
[0m14:06:16.536068 [info ] [MainThread]: 
[0m14:06:16.538015 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 5.50 seconds (5.50s).
[0m14:06:16.543012 [debug] [MainThread]: Command end result
[0m14:06:16.671948 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m14:06:16.673947 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m14:06:16.682947 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\run_results.json
[0m14:06:16.682947 [info ] [MainThread]: 
[0m14:06:16.684946 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:06:16.684946 [info ] [MainThread]: 
[0m14:06:16.685946 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:06:16.686808 [debug] [MainThread]: Command `dbt run` succeeded at 14:06:16.686808 after 8.01 seconds
[0m14:06:16.687847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD256A8BC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD2638D9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD25539460>]}
[0m14:06:16.688816 [debug] [MainThread]: Flushing usage events
[0m14:06:17.696291 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:22:54.667450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C261FAD550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2651160C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C265117650>]}


============================== 14:22:54.671852 | c13a2a2a-d68b-4409-aebb-ccdc3a0696cf ==============================
[0m14:22:54.671852 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:22:54.673698 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:22:55.133843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c13a2a2a-d68b-4409-aebb-ccdc3a0696cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2676727B0>]}
[0m14:22:55.210190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c13a2a2a-d68b-4409-aebb-ccdc3a0696cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C264F488C0>]}
[0m14:22:55.211190 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:22:55.676021 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:22:55.873191 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:22:55.873191 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:22:55.927288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c13a2a2a-d68b-4409-aebb-ccdc3a0696cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2677ED5E0>]}
[0m14:22:56.033512 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m14:22:56.057825 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m14:22:56.094248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c13a2a2a-d68b-4409-aebb-ccdc3a0696cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C267B66D20>]}
[0m14:22:56.094248 [info ] [MainThread]: Found 20 models, 6 data tests, 5 sources, 479 macros
[0m14:22:56.095249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c13a2a2a-d68b-4409-aebb-ccdc3a0696cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2659CC2C0>]}
[0m14:22:56.099247 [info ] [MainThread]: 
[0m14:22:56.100248 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:22:56.100248 [info ] [MainThread]: 
[0m14:22:56.101248 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:22:56.111275 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m14:22:56.227339 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m14:22:56.228338 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m14:22:56.228338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:57.412324 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.185 seconds
[0m14:22:57.412324 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m14:22:57.430430 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m14:22:57.430430 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m14:22:57.430430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:58.384793 [debug] [ThreadPool]: SQL status: SUCCESS 20 in 0.955 seconds
[0m14:22:58.384793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c13a2a2a-d68b-4409-aebb-ccdc3a0696cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C26773A9C0>]}
[0m14:22:58.400535 [debug] [Thread-1 (]: Began running node model.Marketing.stg_campaigns
[0m14:22:58.400535 [info ] [Thread-1 (]: 1 of 20 START sql table model marketing.stg_campaigns .......................... [RUN]
[0m14:22:58.400535 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.stg_campaigns'
[0m14:22:58.400535 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_campaigns
[0m14:22:58.424427 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_campaigns"
[0m14:22:58.429452 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_campaigns
[0m14:22:58.466472 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_campaigns"
[0m14:22:58.469762 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_campaigns"
[0m14:22:58.470794 [debug] [Thread-1 (]: On model.Marketing.stg_campaigns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_campaigns"} */
create or replace transient table MARKETING.marketing.stg_campaigns
         as
        (with source as (
    select * from MARKETING.raw.raw_campaigns
),


cleaned as (
    select
        campaign_id,
        
    lower(trim(nullif(campaign_name, '')))
 as campaign_name,
        upper(
    lower(trim(nullif(channel_id, '')))
) as channel_id,
         
    try_to_date(start_date, 'MM/DD/YYYY')
 as start_date,
        
    try_to_date(end_date, 'DD-MM-YYYY')
 as end_date,
        initcap(trim(nullif(status, ''))) as status,
        
    lower(trim(nullif(owner, '')))
 as owner,
        split(tags, ',') as tag_list
    from source
)

select * from cleaned
        );
[0m14:22:58.470794 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:23:00.150814 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.688 seconds
[0m14:23:00.248800 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c13a2a2a-d68b-4409-aebb-ccdc3a0696cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C264E8DA00>]}
[0m14:23:00.248800 [info ] [Thread-1 (]: 1 of 20 OK created sql table model marketing.stg_campaigns ..................... [[32mSUCCESS 1[0m in 1.85s]
[0m14:23:00.248800 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_campaigns
[0m14:23:00.248800 [debug] [Thread-1 (]: Began running node model.Marketing.stg_channels
[0m14:23:00.248800 [info ] [Thread-1 (]: 2 of 20 START sql table model marketing.stg_channels ........................... [RUN]
[0m14:23:00.248800 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_campaigns, now model.Marketing.stg_channels)
[0m14:23:00.248800 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_channels
[0m14:23:00.265147 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_channels"
[0m14:23:00.267174 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_channels
[0m14:23:00.270459 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_channels"
[0m14:23:00.270459 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_channels"
[0m14:23:00.270459 [debug] [Thread-1 (]: On model.Marketing.stg_channels: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_channels"} */
create or replace transient table MARKETING.marketing.stg_channels
         as
        (with source as (
    select * from MARKETING.raw.raw_channels
),



cleaned as (
    select
        upper(trim(nullif(channel_id, ''))) as channel_id,
        lower(trim(nullif(channel_name, ''))) as channel_name,
        lower(trim(nullif(channel_type, ''))) as channel_type,
        initcap(trim(nullif(region, ''))) as region,
        
    nullif(
        case 
            when lower(description) in ('', 'n/a', 'none', 'null', '-') then null 
            else description
        end,
        ''
    )
 as description
    from source
)

select * from cleaned
        );
[0m14:23:01.056576 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.782 seconds
[0m14:23:01.056576 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c13a2a2a-d68b-4409-aebb-ccdc3a0696cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2676AE5A0>]}
[0m14:23:01.056576 [info ] [Thread-1 (]: 2 of 20 OK created sql table model marketing.stg_channels ...................... [[32mSUCCESS 1[0m in 0.81s]
[0m14:23:01.056576 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_channels
[0m14:23:01.056576 [debug] [Thread-1 (]: Began running node model.Marketing.stg_leads
[0m14:23:01.056576 [info ] [Thread-1 (]: 3 of 20 START sql table model marketing.stg_leads .............................. [RUN]
[0m14:23:01.056576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_channels, now model.Marketing.stg_leads)
[0m14:23:01.056576 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_leads
[0m14:23:01.056576 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_leads"
[0m14:23:01.056576 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_leads
[0m14:23:01.074860 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_leads"
[0m14:23:01.077531 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_leads"
[0m14:23:01.078659 [debug] [Thread-1 (]: On model.Marketing.stg_leads: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_leads"} */
create or replace transient table MARKETING.marketing.stg_leads
         as
        (with source as (
    select  * from MARKETING.raw.raw_leads
),

cleaned as (
    select
        lead_id,
        campaign_id,
        lower(trim(nullif(lead_source, ''))) as lead_source,
        
    case 
        when lower(converted) in ('1', 'true', 'yes') then true
        when lower(converted) in ('0', 'false', 'no') then false
        else null
    end
 as is_converted,
        initcap(trim(nullif(name, ''))) as name,
        lower(trim(nullif(email, ''))) as email,
        converted_date,
    from source
)

select * from cleaned
        );
[0m14:23:01.941151 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.863 seconds
[0m14:23:01.944194 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c13a2a2a-d68b-4409-aebb-ccdc3a0696cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C268077830>]}
[0m14:23:01.945420 [info ] [Thread-1 (]: 3 of 20 OK created sql table model marketing.stg_leads ......................... [[32mSUCCESS 1[0m in 0.89s]
[0m14:23:01.946455 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_leads
[0m14:23:01.947455 [debug] [Thread-1 (]: Began running node model.Marketing.stg_revenue
[0m14:23:01.948455 [info ] [Thread-1 (]: 4 of 20 START sql table model marketing.stg_revenue ............................ [RUN]
[0m14:23:01.948959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_leads, now model.Marketing.stg_revenue)
[0m14:23:01.950001 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_revenue
[0m14:23:01.954003 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_revenue"
[0m14:23:01.955002 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_revenue
[0m14:23:01.957998 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_revenue"
[0m14:23:01.959967 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_revenue"
[0m14:23:01.960967 [debug] [Thread-1 (]: On model.Marketing.stg_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_revenue"} */
create or replace transient table MARKETING.marketing.stg_revenue
         as
        (with source as (
    select  * from MARKETING.raw.raw_revenue
),

cleaned as (
    select
        lead_id,
        campaign_id,
        lower(trim(nullif(lead_source, ''))) as lead_source,
        
    case 
        when lower(converted) in ('1', 'true', 'yes') then true
        when lower(converted) in ('0', 'false', 'no') then false
        else null
    end
 as is_converted,
        revenue as revenue_amount, 
        cast(revenue_date as date) as revenue_date,
    from source
)

select * from cleaned
        );
[0m14:23:02.608754 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.653 seconds
[0m14:23:02.608754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c13a2a2a-d68b-4409-aebb-ccdc3a0696cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C26803C4D0>]}
[0m14:23:02.608754 [info ] [Thread-1 (]: 4 of 20 OK created sql table model marketing.stg_revenue ....................... [[32mSUCCESS 1[0m in 0.66s]
[0m14:23:02.608754 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_revenue
[0m14:23:02.608754 [debug] [Thread-1 (]: Began running node model.Marketing.stg_spend
[0m14:23:02.608754 [info ] [Thread-1 (]: 5 of 20 START sql table model marketing.stg_spend .............................. [RUN]
[0m14:23:02.608754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_revenue, now model.Marketing.stg_spend)
[0m14:23:02.608754 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_spend
[0m14:23:02.626743 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_spend"
[0m14:23:02.628276 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_spend
[0m14:23:02.632356 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.stg_spend"
[0m14:23:02.632356 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.stg_spend"
[0m14:23:02.632356 [debug] [Thread-1 (]: On model.Marketing.stg_spend: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.stg_spend"} */
create or replace transient table MARKETING.marketing.stg_spend
         as
        (with source as (
    select  * from MARKETING.raw.raw_spend
),

cleaned as (
    select
        spend_id,
        campaign_id,
        
    try_to_date(spend_date, 'DD/MM/YYYY')
 as spend_date,
        try_to_number(replace(spend_amount, '$', '')) as spend_amount,
        lower(currency) as currency,
        
    nullif(
        case 
            when lower(notes) in ('', 'n/a', 'none', 'null', '-') then null 
            else notes
        end,
        ''
    )
 as notes,
    from source
)

select * from cleaned
        );
[0m14:23:03.363491 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.740 seconds
[0m14:23:03.379363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c13a2a2a-d68b-4409-aebb-ccdc3a0696cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C26813BAA0>]}
[0m14:23:03.379363 [info ] [Thread-1 (]: 5 of 20 OK created sql table model marketing.stg_spend ......................... [[32mSUCCESS 1[0m in 0.77s]
[0m14:23:03.379363 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_spend
[0m14:23:03.379363 [debug] [Thread-1 (]: Began running node model.Marketing.fct_campaign_channel_effectiveness
[0m14:23:03.379363 [info ] [Thread-1 (]: 6 of 20 START sql table model marketing.fct_campaign_channel_effectiveness ..... [RUN]
[0m14:23:03.379363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_spend, now model.Marketing.fct_campaign_channel_effectiveness)
[0m14:23:03.379363 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_campaign_channel_effectiveness
[0m14:23:03.379363 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_campaign_channel_effectiveness"
[0m14:23:03.379363 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_campaign_channel_effectiveness
[0m14:23:03.379363 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_campaign_channel_effectiveness"
[0m14:23:03.396187 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_campaign_channel_effectiveness"
[0m14:23:03.397228 [debug] [Thread-1 (]: On model.Marketing.fct_campaign_channel_effectiveness: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_campaign_channel_effectiveness"} */
create or replace transient table MARKETING.marketing.fct_campaign_channel_effectiveness
         as
        (with leads as (
    select campaign_id, count(*) as total_leads
    from MARKETING.marketing.stg_leads
    group by campaign_id
),

conversions as (
    select campaign_id, count(*) as converted_leads
    from MARKETING.marketing.stg_leads
    where is_converted = true
    group by campaign_id
)

select
    c.campaign_id,
    c.campaign_name,
    c.channel_id,
    l.total_leads,
    cv.converted_leads,
    round(cv.converted_leads * 1.0 / nullif(l.total_leads, 0), 2) as conversion_rate
from MARKETING.marketing.stg_campaigns c
left join leads l on c.campaign_id = l.campaign_id
left join conversions cv on c.campaign_id = cv.campaign_id
        );
[0m14:23:04.149823 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.763 seconds
[0m14:23:04.161477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c13a2a2a-d68b-4409-aebb-ccdc3a0696cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C268160A70>]}
[0m14:23:04.161477 [info ] [Thread-1 (]: 6 of 20 OK created sql table model marketing.fct_campaign_channel_effectiveness  [[32mSUCCESS 1[0m in 0.78s]
[0m14:23:04.161477 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_campaign_channel_effectiveness
[0m14:23:04.161477 [debug] [Thread-1 (]: Began running node model.Marketing.fct_inactive_campaigns
[0m14:23:04.161477 [info ] [Thread-1 (]: 7 of 20 START sql table model marketing.fct_inactive_campaigns ................. [RUN]
[0m14:23:04.161477 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_campaign_channel_effectiveness, now model.Marketing.fct_inactive_campaigns)
[0m14:23:04.161477 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_inactive_campaigns
[0m14:23:04.161477 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_inactive_campaigns"
[0m14:23:04.161477 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_inactive_campaigns
[0m14:23:04.161477 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_inactive_campaigns"
[0m14:23:04.178225 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_inactive_campaigns"
[0m14:23:04.178225 [debug] [Thread-1 (]: On model.Marketing.fct_inactive_campaigns: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_inactive_campaigns"} */
create or replace transient table MARKETING.marketing.fct_inactive_campaigns
         as
        (with leads as (
    select
        campaign_id,
        count(*) as total_leads,
        sum(case when is_converted then 1 else 0 end) as total_conversions
    from MARKETING.marketing.stg_leads
    group by campaign_id
),

all_campaigns as (
    select
        campaign_id,
        campaign_name,
        status,
        start_date,
        end_date
    from MARKETING.marketing.stg_campaigns
),

joined as (
    select 
        c.campaign_id,
        c.campaign_name,
        c.status,
        c.start_date,
        c.end_date,
        coalesce(l.total_leads, 0) as total_leads,
        coalesce(l.total_conversions, 0) as total_conversions
    from all_campaigns c
    left join leads l on c.campaign_id = l.campaign_id
)

select *,
    case 
        when total_leads = 0 then 'No Leads'
        when total_conversions = 0 then 'Zero Conversions'
    end as issue
from joined
where total_leads = 0 or total_conversions = 0
        );
[0m14:23:04.680465 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.511 seconds
[0m14:23:04.680465 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c13a2a2a-d68b-4409-aebb-ccdc3a0696cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C26798BB00>]}
[0m14:23:04.680465 [info ] [Thread-1 (]: 7 of 20 OK created sql table model marketing.fct_inactive_campaigns ............ [[32mSUCCESS 1[0m in 0.52s]
[0m14:23:04.680465 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_inactive_campaigns
[0m14:23:04.680465 [debug] [Thread-1 (]: Began running node model.Marketing.fct_lead_time_to_convert
[0m14:23:04.680465 [info ] [Thread-1 (]: 8 of 20 START sql table model marketing.fct_lead_time_to_convert ............... [RUN]
[0m14:23:04.696324 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_inactive_campaigns, now model.Marketing.fct_lead_time_to_convert)
[0m14:23:04.696324 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_lead_time_to_convert
[0m14:23:04.696324 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_lead_time_to_convert"
[0m14:23:04.696324 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_lead_time_to_convert
[0m14:23:04.696324 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_lead_time_to_convert"
[0m14:23:04.696324 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_lead_time_to_convert"
[0m14:23:04.696324 [debug] [Thread-1 (]: On model.Marketing.fct_lead_time_to_convert: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_lead_time_to_convert"} */
create or replace transient table MARKETING.marketing.fct_lead_time_to_convert
         as
        (with campaigns as (
    select 
        campaign_id,
        campaign_name,
        status
    from MARKETING.marketing.stg_campaigns
),

leads as (
    select 
        campaign_id,
        count(*) as total_leads,
        sum(case when is_converted then 1 else 0 end) as total_conversions
    from MARKETING.marketing.stg_leads
    group by campaign_id
),

campaigns_with_lead_info as (
    select 
        c.campaign_id,
        c.campaign_name,
        c.status,
        coalesce(l.total_leads, 0) as total_leads,
        coalesce(l.total_conversions, 0) as total_conversions
    from campaigns c
    left join leads l
        on c.campaign_id = l.campaign_id
)

select *
from campaigns_with_lead_info
where total_leads = 0 or total_conversions = 0
        );
[0m14:23:05.211359 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.510 seconds
[0m14:23:05.227553 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c13a2a2a-d68b-4409-aebb-ccdc3a0696cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C268077C50>]}
[0m14:23:05.229583 [info ] [Thread-1 (]: 8 of 20 OK created sql table model marketing.fct_lead_time_to_convert .......... [[32mSUCCESS 1[0m in 0.52s]
[0m14:23:05.229583 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_lead_time_to_convert
[0m14:23:05.229583 [debug] [Thread-1 (]: Began running node model.Marketing.int_lead_conversion
[0m14:23:05.229583 [info ] [Thread-1 (]: 9 of 20 START sql table model marketing.int_lead_conversion .................... [RUN]
[0m14:23:05.229583 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_lead_time_to_convert, now model.Marketing.int_lead_conversion)
[0m14:23:05.239959 [debug] [Thread-1 (]: Began compiling node model.Marketing.int_lead_conversion
[0m14:23:05.247221 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.int_lead_conversion"
[0m14:23:05.250394 [debug] [Thread-1 (]: Began executing node model.Marketing.int_lead_conversion
[0m14:23:05.256919 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.int_lead_conversion"
[0m14:23:05.259513 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.int_lead_conversion"
[0m14:23:05.259513 [debug] [Thread-1 (]: On model.Marketing.int_lead_conversion: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.int_lead_conversion"} */
create or replace transient table MARKETING.marketing.int_lead_conversion
         as
        (with leads_with_channel as (
    select
        l.lead_id,
        l.is_converted,
        c.channel_id
    from MARKETING.marketing.stg_leads l
    left join MARKETING.marketing.stg_campaigns c
        on l.campaign_id = c.campaign_id
)

select
    channel_id,
    count(*) as total_leads,
    count_if(is_converted) as converted_leads
from leads_with_channel
group by channel_id
        );
[0m14:23:06.003057 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.741 seconds
[0m14:23:06.003057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c13a2a2a-d68b-4409-aebb-ccdc3a0696cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2659CE660>]}
[0m14:23:06.003057 [info ] [Thread-1 (]: 9 of 20 OK created sql table model marketing.int_lead_conversion ............... [[32mSUCCESS 1[0m in 0.77s]
[0m14:23:06.003057 [debug] [Thread-1 (]: Finished running node model.Marketing.int_lead_conversion
[0m14:23:06.003057 [debug] [Thread-1 (]: Began running node model.Marketing.int_lead_lifecycle
[0m14:23:06.003057 [info ] [Thread-1 (]: 10 of 20 START sql table model marketing.int_lead_lifecycle .................... [RUN]
[0m14:23:06.003057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.int_lead_conversion, now model.Marketing.int_lead_lifecycle)
[0m14:23:06.003057 [debug] [Thread-1 (]: Began compiling node model.Marketing.int_lead_lifecycle
[0m14:23:06.019358 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.int_lead_lifecycle"
[0m14:23:06.021318 [debug] [Thread-1 (]: Began executing node model.Marketing.int_lead_lifecycle
[0m14:23:06.026353 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.int_lead_lifecycle"
[0m14:23:06.028349 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.int_lead_lifecycle"
[0m14:23:06.029354 [debug] [Thread-1 (]: On model.Marketing.int_lead_lifecycle: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.int_lead_lifecycle"} */
create or replace transient table MARKETING.marketing.int_lead_lifecycle
         as
        (with leads_extended as (
    select
        l.lead_id,
        l.name,
        l.email,
        l.is_converted,
        l.converted_date,
        c.channel_id
    from MARKETING.marketing.stg_leads l
    left join MARKETING.marketing.stg_campaigns c
        on l.campaign_id = c.campaign_id
)

select *
from leads_extended
        );
[0m14:23:06.781771 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.765 seconds
[0m14:23:06.797494 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c13a2a2a-d68b-4409-aebb-ccdc3a0696cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2676DA270>]}
[0m14:23:06.797494 [info ] [Thread-1 (]: 10 of 20 OK created sql table model marketing.int_lead_lifecycle ............... [[32mSUCCESS 1[0m in 0.79s]
[0m14:23:06.797494 [debug] [Thread-1 (]: Finished running node model.Marketing.int_lead_lifecycle
[0m14:23:06.797494 [debug] [Thread-1 (]: Began running node model.Marketing.tmp_campaign_lead_check
[0m14:23:06.797494 [info ] [Thread-1 (]: 11 of 20 START sql view model marketing.tmp_campaign_lead_check ................ [RUN]
[0m14:23:06.797494 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.int_lead_lifecycle, now model.Marketing.tmp_campaign_lead_check)
[0m14:23:06.797494 [debug] [Thread-1 (]: Began compiling node model.Marketing.tmp_campaign_lead_check
[0m14:23:06.797494 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.tmp_campaign_lead_check"
[0m14:23:06.797494 [debug] [Thread-1 (]: Began executing node model.Marketing.tmp_campaign_lead_check
[0m14:23:06.842071 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.tmp_campaign_lead_check"
[0m14:23:06.844079 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.tmp_campaign_lead_check"
[0m14:23:06.844079 [debug] [Thread-1 (]: On model.Marketing.tmp_campaign_lead_check: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.tmp_campaign_lead_check"} */
create or replace   view MARKETING.marketing.tmp_campaign_lead_check
  
   as (
    select 
    campaign_id,
    count(*) as total_leads,
    sum(case when is_converted then 1 else 0 end) as total_conversions
from MARKETING.marketing.stg_leads
group by campaign_id
order by total_leads desc
  );
[0m14:23:07.094635 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.253 seconds
[0m14:23:07.094635 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c13a2a2a-d68b-4409-aebb-ccdc3a0696cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C268135BB0>]}
[0m14:23:07.094635 [info ] [Thread-1 (]: 11 of 20 OK created sql view model marketing.tmp_campaign_lead_check ........... [[32mSUCCESS 1[0m in 0.30s]
[0m14:23:07.094635 [debug] [Thread-1 (]: Finished running node model.Marketing.tmp_campaign_lead_check
[0m14:23:07.094635 [debug] [Thread-1 (]: Began running node model.Marketing.fct_active_campaign_revenue
[0m14:23:07.094635 [info ] [Thread-1 (]: 12 of 20 START sql table model marketing.fct_active_campaign_revenue ........... [RUN]
[0m14:23:07.094635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.tmp_campaign_lead_check, now model.Marketing.fct_active_campaign_revenue)
[0m14:23:07.094635 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_active_campaign_revenue
[0m14:23:07.094635 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_active_campaign_revenue"
[0m14:23:07.094635 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_active_campaign_revenue
[0m14:23:07.113564 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_active_campaign_revenue"
[0m14:23:07.115680 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_active_campaign_revenue"
[0m14:23:07.116814 [debug] [Thread-1 (]: On model.Marketing.fct_active_campaign_revenue: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_active_campaign_revenue"} */
create or replace transient table MARKETING.marketing.fct_active_campaign_revenue
         as
        (select
    c.campaign_id,
    c.campaign_name,
    sum(r.revenue_amount) as total_revenue
from MARKETING.marketing.stg_campaigns c
left join MARKETING.marketing.stg_revenue r on c.campaign_id = r.campaign_id
where c.status = 'Active'
group by 1, 2
        );
[0m14:23:07.799206 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.692 seconds
[0m14:23:07.811241 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c13a2a2a-d68b-4409-aebb-ccdc3a0696cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2654DDB20>]}
[0m14:23:07.813249 [info ] [Thread-1 (]: 12 of 20 OK created sql table model marketing.fct_active_campaign_revenue ...... [[32mSUCCESS 1[0m in 0.72s]
[0m14:23:07.813249 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_active_campaign_revenue
[0m14:23:07.814999 [debug] [Thread-1 (]: Began running node model.Marketing.fct_total_revenue_by_campaign
[0m14:23:07.814999 [info ] [Thread-1 (]: 13 of 20 START sql table model marketing.fct_total_revenue_by_campaign ......... [RUN]
[0m14:23:07.814999 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_active_campaign_revenue, now model.Marketing.fct_total_revenue_by_campaign)
[0m14:23:07.814999 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_total_revenue_by_campaign
[0m14:23:07.814999 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_total_revenue_by_campaign"
[0m14:23:07.814999 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_total_revenue_by_campaign
[0m14:23:07.814999 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_total_revenue_by_campaign"
[0m14:23:07.814999 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_total_revenue_by_campaign"
[0m14:23:07.814999 [debug] [Thread-1 (]: On model.Marketing.fct_total_revenue_by_campaign: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_total_revenue_by_campaign"} */
create or replace transient table MARKETING.marketing.fct_total_revenue_by_campaign
         as
        (select
    campaign_id,
    sum(revenue_amount) as total_revenue
from MARKETING.marketing.stg_revenue
group by campaign_id
        );
[0m14:23:08.383366 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.563 seconds
[0m14:23:08.383366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c13a2a2a-d68b-4409-aebb-ccdc3a0696cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C268138860>]}
[0m14:23:08.383366 [info ] [Thread-1 (]: 13 of 20 OK created sql table model marketing.fct_total_revenue_by_campaign .... [[32mSUCCESS 1[0m in 0.57s]
[0m14:23:08.383366 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_total_revenue_by_campaign
[0m14:23:08.383366 [debug] [Thread-1 (]: Began running node model.Marketing.fct_channel_spend_efficiency
[0m14:23:08.383366 [info ] [Thread-1 (]: 14 of 20 START sql table model marketing.fct_channel_spend_efficiency .......... [RUN]
[0m14:23:08.383366 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_total_revenue_by_campaign, now model.Marketing.fct_channel_spend_efficiency)
[0m14:23:08.383366 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_channel_spend_efficiency
[0m14:23:08.399180 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_channel_spend_efficiency"
[0m14:23:08.399180 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_channel_spend_efficiency
[0m14:23:08.399180 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_channel_spend_efficiency"
[0m14:23:08.399180 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_channel_spend_efficiency"
[0m14:23:08.399180 [debug] [Thread-1 (]: On model.Marketing.fct_channel_spend_efficiency: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_channel_spend_efficiency"} */
create or replace transient table MARKETING.marketing.fct_channel_spend_efficiency
         as
        (with leads as (
    select campaign_id, count(*) as leads
    from MARKETING.marketing.stg_leads
    group by campaign_id
),

spend as (
    select campaign_id, sum(spend_amount) as spend
    from MARKETING.marketing.stg_spend
    group by campaign_id
),

combined as (
    select
        c.channel_id,
        s.spend,
        l.leads
    from MARKETING.marketing.stg_campaigns c
    left join spend s on c.campaign_id = s.campaign_id
    left join leads l on c.campaign_id = l.campaign_id
)

select
    channel_id,
    sum(spend) as total_spend,
    sum(leads) as total_leads,
    round(sum(spend) / nullif(sum(leads), 0), 2) as spend_per_lead
from combined
group by channel_id
        );
[0m14:23:09.141468 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.739 seconds
[0m14:23:09.141468 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c13a2a2a-d68b-4409-aebb-ccdc3a0696cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C268033080>]}
[0m14:23:09.141468 [info ] [Thread-1 (]: 14 of 20 OK created sql table model marketing.fct_channel_spend_efficiency ..... [[32mSUCCESS 1[0m in 0.76s]
[0m14:23:09.141468 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_channel_spend_efficiency
[0m14:23:09.141468 [debug] [Thread-1 (]: Began running node model.Marketing.fct_monthly_spend_by_channel
[0m14:23:09.141468 [info ] [Thread-1 (]: 15 of 20 START sql table model marketing.fct_monthly_spend_by_channel .......... [RUN]
[0m14:23:09.141468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_channel_spend_efficiency, now model.Marketing.fct_monthly_spend_by_channel)
[0m14:23:09.141468 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_monthly_spend_by_channel
[0m14:23:09.141468 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_monthly_spend_by_channel"
[0m14:23:09.158488 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_monthly_spend_by_channel
[0m14:23:09.161741 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_monthly_spend_by_channel"
[0m14:23:09.161741 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_monthly_spend_by_channel"
[0m14:23:09.165672 [debug] [Thread-1 (]: On model.Marketing.fct_monthly_spend_by_channel: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_monthly_spend_by_channel"} */
create or replace transient table MARKETING.marketing.fct_monthly_spend_by_channel
         as
        (with spend as (
    select
        c.channel_id,
        to_char(s.spend_date, 'YYYY-MM') as month,
        sum(s.spend_amount) as total_spend
    from MARKETING.marketing.stg_spend s
    left join MARKETING.marketing.stg_campaigns c
        on s.campaign_id = c.campaign_id
    group by c.channel_id, to_char(s.spend_date, 'YYYY-MM')
)

select * from spend
        );
[0m14:23:09.777513 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.616 seconds
[0m14:23:09.777513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c13a2a2a-d68b-4409-aebb-ccdc3a0696cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C268031400>]}
[0m14:23:09.777513 [info ] [Thread-1 (]: 15 of 20 OK created sql table model marketing.fct_monthly_spend_by_channel ..... [[32mSUCCESS 1[0m in 0.64s]
[0m14:23:09.777513 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_monthly_spend_by_channel
[0m14:23:09.777513 [debug] [Thread-1 (]: Began running node model.Marketing.int_campaign_performance
[0m14:23:09.790310 [info ] [Thread-1 (]: 16 of 20 START sql table model marketing.int_campaign_performance .............. [RUN]
[0m14:23:09.790310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_monthly_spend_by_channel, now model.Marketing.int_campaign_performance)
[0m14:23:09.790310 [debug] [Thread-1 (]: Began compiling node model.Marketing.int_campaign_performance
[0m14:23:09.796982 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.int_campaign_performance"
[0m14:23:09.796982 [debug] [Thread-1 (]: Began executing node model.Marketing.int_campaign_performance
[0m14:23:09.800997 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.int_campaign_performance"
[0m14:23:09.800997 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.int_campaign_performance"
[0m14:23:09.800997 [debug] [Thread-1 (]: On model.Marketing.int_campaign_performance: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.int_campaign_performance"} */
create or replace transient table MARKETING.marketing.int_campaign_performance
         as
        (with spend as (
    select
        campaign_id,
        sum(spend_amount) as total_spend
    from MARKETING.marketing.stg_spend
    group by campaign_id
),

leads as (
    select
        campaign_id,
        count(*) as total_leads,
        count_if(is_converted) as converted_leads
    from MARKETING.marketing.stg_leads
    group by campaign_id
)

select
    c.campaign_id,
    c.campaign_name,
    c.channel_id,
    c.start_date,
    c.end_date,
    s.total_spend,
    l.total_leads,
    l.converted_leads
from MARKETING.marketing.stg_campaigns c
left join spend s on c.campaign_id = s.campaign_id
left join leads l on c.campaign_id = l.campaign_id
        );
[0m14:23:10.397966 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.593 seconds
[0m14:23:10.397966 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c13a2a2a-d68b-4409-aebb-ccdc3a0696cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C26813C3B0>]}
[0m14:23:10.397966 [info ] [Thread-1 (]: 16 of 20 OK created sql table model marketing.int_campaign_performance ......... [[32mSUCCESS 1[0m in 0.61s]
[0m14:23:10.397966 [debug] [Thread-1 (]: Finished running node model.Marketing.int_campaign_performance
[0m14:23:10.397966 [debug] [Thread-1 (]: Began running node model.Marketing.int_channel_spend
[0m14:23:10.405220 [info ] [Thread-1 (]: 17 of 20 START sql table model marketing.int_channel_spend ..................... [RUN]
[0m14:23:10.407444 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.int_campaign_performance, now model.Marketing.int_channel_spend)
[0m14:23:10.407444 [debug] [Thread-1 (]: Began compiling node model.Marketing.int_channel_spend
[0m14:23:10.410474 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.int_channel_spend"
[0m14:23:10.412441 [debug] [Thread-1 (]: Began executing node model.Marketing.int_channel_spend
[0m14:23:10.415475 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.int_channel_spend"
[0m14:23:10.417474 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.int_channel_spend"
[0m14:23:10.417474 [debug] [Thread-1 (]: On model.Marketing.int_channel_spend: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.int_channel_spend"} */
create or replace transient table MARKETING.marketing.int_channel_spend
         as
        (with spend_with_channel as (
    select
        s.spend_id,
        c.channel_id,
        s.spend_amount
    from MARKETING.marketing.stg_spend s
    left join MARKETING.marketing.stg_campaigns c
        on s.campaign_id = c.campaign_id
)

select
    channel_id,
    sum(spend_amount) as total_channel_spend
from spend_with_channel
group by channel_id
        );
[0m14:23:10.986554 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.580 seconds
[0m14:23:10.986554 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c13a2a2a-d68b-4409-aebb-ccdc3a0696cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C268162060>]}
[0m14:23:10.986554 [info ] [Thread-1 (]: 17 of 20 OK created sql table model marketing.int_channel_spend ................ [[32mSUCCESS 1[0m in 0.58s]
[0m14:23:11.002294 [debug] [Thread-1 (]: Finished running node model.Marketing.int_channel_spend
[0m14:23:11.002294 [debug] [Thread-1 (]: Began running node model.Marketing.fct_channel_conversion_rate
[0m14:23:11.002294 [info ] [Thread-1 (]: 18 of 20 START sql table model marketing.fct_channel_conversion_rate ........... [RUN]
[0m14:23:11.002294 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.int_channel_spend, now model.Marketing.fct_channel_conversion_rate)
[0m14:23:11.002294 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_channel_conversion_rate
[0m14:23:11.002294 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_channel_conversion_rate"
[0m14:23:11.002294 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_channel_conversion_rate
[0m14:23:11.002294 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_channel_conversion_rate"
[0m14:23:11.002294 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_channel_conversion_rate"
[0m14:23:11.002294 [debug] [Thread-1 (]: On model.Marketing.fct_channel_conversion_rate: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_channel_conversion_rate"} */
create or replace transient table MARKETING.marketing.fct_channel_conversion_rate
         as
        (with conversions as (
    select * from MARKETING.marketing.int_lead_conversion
)

select
    channel_id,
    total_leads,
    converted_leads,
    round(converted_leads * 1.0 / nullif(total_leads, 0), 2) as conversion_rate
from conversions
order by conversion_rate desc
        );
[0m14:23:11.649231 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.639 seconds
[0m14:23:11.649231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c13a2a2a-d68b-4409-aebb-ccdc3a0696cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2677EDC10>]}
[0m14:23:11.649231 [info ] [Thread-1 (]: 18 of 20 OK created sql table model marketing.fct_channel_conversion_rate ...... [[32mSUCCESS 1[0m in 0.65s]
[0m14:23:11.649231 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_channel_conversion_rate
[0m14:23:11.649231 [debug] [Thread-1 (]: Began running node model.Marketing.fct_campaign_duration_cost
[0m14:23:11.649231 [info ] [Thread-1 (]: 19 of 20 START sql table model marketing.fct_campaign_duration_cost ............ [RUN]
[0m14:23:11.649231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_channel_conversion_rate, now model.Marketing.fct_campaign_duration_cost)
[0m14:23:11.649231 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_campaign_duration_cost
[0m14:23:11.649231 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_campaign_duration_cost"
[0m14:23:11.666294 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_campaign_duration_cost
[0m14:23:11.670304 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_campaign_duration_cost"
[0m14:23:11.672305 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_campaign_duration_cost"
[0m14:23:11.673636 [debug] [Thread-1 (]: On model.Marketing.fct_campaign_duration_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_campaign_duration_cost"} */
create or replace transient table MARKETING.marketing.fct_campaign_duration_cost
         as
        (with performance as (
    select * from MARKETING.marketing.int_campaign_performance
)

select
    campaign_id,
    campaign_name,
    start_date,
    end_date,
    datediff('day', start_date, end_date) + 1 as duration_days,
    total_spend,
    round(total_spend / nullif(datediff('day', start_date, end_date) + 1, 0), 2) as cost_per_day
from performance
        );
[0m14:23:12.263141 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.595 seconds
[0m14:23:12.263141 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c13a2a2a-d68b-4409-aebb-ccdc3a0696cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2659B35F0>]}
[0m14:23:12.263141 [info ] [Thread-1 (]: 19 of 20 OK created sql table model marketing.fct_campaign_duration_cost ....... [[32mSUCCESS 1[0m in 0.61s]
[0m14:23:12.272897 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_campaign_duration_cost
[0m14:23:12.272897 [debug] [Thread-1 (]: Began running node model.Marketing.fct_campaign_roi
[0m14:23:12.272897 [info ] [Thread-1 (]: 20 of 20 START sql table model marketing.fct_campaign_roi ...................... [RUN]
[0m14:23:12.272897 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_campaign_duration_cost, now model.Marketing.fct_campaign_roi)
[0m14:23:12.272897 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_campaign_roi
[0m14:23:12.280300 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_campaign_roi"
[0m14:23:12.281410 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_campaign_roi
[0m14:23:12.285630 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_campaign_roi"
[0m14:23:12.289730 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_campaign_roi"
[0m14:23:12.290338 [debug] [Thread-1 (]: On model.Marketing.fct_campaign_roi: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_campaign_roi"} */
create or replace transient table MARKETING.marketing.fct_campaign_roi
         as
        (-- models/final/fct_campaign_roi.sql

with revenue as (
    select
        campaign_id,
        sum(revenue_amount) as total_revenue
    from MARKETING.marketing.stg_revenue
    group by campaign_id
),

performance as (
    select *
    from MARKETING.marketing.int_campaign_performance
)

select
    p.campaign_id,
    p.campaign_name,
    p.total_spend,
    r.total_revenue,
    (r.total_revenue - p.total_spend) / nullif(p.total_spend, 0) as roi
from performance p
left join revenue r on p.campaign_id = r.campaign_id
        );
[0m14:23:13.040321 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.752 seconds
[0m14:23:13.040321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c13a2a2a-d68b-4409-aebb-ccdc3a0696cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C26818DB50>]}
[0m14:23:13.040321 [info ] [Thread-1 (]: 20 of 20 OK created sql table model marketing.fct_campaign_roi ................. [[32mSUCCESS 1[0m in 0.77s]
[0m14:23:13.040321 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_campaign_roi
[0m14:23:13.040321 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:13.040321 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m14:23:13.040321 [debug] [MainThread]: On list_MARKETING: Close
[0m14:23:13.366570 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m14:23:13.366570 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m14:23:13.689015 [debug] [MainThread]: Connection 'model.Marketing.fct_campaign_roi' was left open.
[0m14:23:13.690396 [debug] [MainThread]: On model.Marketing.fct_campaign_roi: Close
[0m14:23:14.006613 [info ] [MainThread]: 
[0m14:23:14.006613 [info ] [MainThread]: Finished running 19 table models, 1 view model in 0 hours 0 minutes and 17.91 seconds (17.91s).
[0m14:23:14.022643 [debug] [MainThread]: Command end result
[0m14:23:14.076627 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m14:23:14.078637 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m14:23:14.078637 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\run_results.json
[0m14:23:14.078637 [info ] [MainThread]: 
[0m14:23:14.089547 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:23:14.089547 [info ] [MainThread]: 
[0m14:23:14.091165 [info ] [MainThread]: Done. PASS=20 WARN=0 ERROR=0 SKIP=0 TOTAL=20
[0m14:23:14.091165 [debug] [MainThread]: Command `dbt run` succeeded at 14:23:14.091165 after 19.61 seconds
[0m14:23:14.091165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C262F2C080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C265278530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C265279BB0>]}
[0m14:23:14.091165 [debug] [MainThread]: Flushing usage events
[0m14:23:15.409070 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:36:04.648083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7DA953290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7DD4C0F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7DD4C32C0>]}


============================== 14:36:04.664187 | a170727b-7c8f-4b47-903d-e949c3c134ef ==============================
[0m14:36:04.664187 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:36:04.664187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select fct_lead_time_to_convert', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:36:05.475272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a170727b-7c8f-4b47-903d-e949c3c134ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7DD974D40>]}
[0m14:36:05.549999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a170727b-7c8f-4b47-903d-e949c3c134ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7DD84D1C0>]}
[0m14:36:05.552006 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:36:06.066759 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:36:06.253122 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:36:06.253122 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:36:06.326398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a170727b-7c8f-4b47-903d-e949c3c134ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7DF6ED520>]}
[0m14:36:06.423186 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m14:36:06.439337 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m14:36:06.486477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a170727b-7c8f-4b47-903d-e949c3c134ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7DF987A70>]}
[0m14:36:06.486477 [info ] [MainThread]: Found 20 models, 6 data tests, 5 sources, 479 macros
[0m14:36:06.486477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a170727b-7c8f-4b47-903d-e949c3c134ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7DF8C4D40>]}
[0m14:36:06.486477 [info ] [MainThread]: 
[0m14:36:06.486477 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:36:06.486477 [info ] [MainThread]: 
[0m14:36:06.501403 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:36:06.503234 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m14:36:09.939244 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m14:36:09.939244 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m14:36:09.939244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:11.324163 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.386 seconds
[0m14:36:11.333231 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m14:36:11.340892 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m14:36:11.340892 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m14:36:11.348199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:12.467412 [debug] [ThreadPool]: SQL status: SUCCESS 20 in 1.129 seconds
[0m14:36:12.482927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a170727b-7c8f-4b47-903d-e949c3c134ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7DF7447D0>]}
[0m14:36:12.490954 [debug] [Thread-1 (]: Began running node model.Marketing.fct_lead_time_to_convert
[0m14:36:12.490954 [info ] [Thread-1 (]: 1 of 1 START sql table model marketing.fct_lead_time_to_convert ................ [RUN]
[0m14:36:12.490954 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.fct_lead_time_to_convert'
[0m14:36:12.490954 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_lead_time_to_convert
[0m14:36:12.499506 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_lead_time_to_convert"
[0m14:36:12.499506 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_lead_time_to_convert
[0m14:36:12.538498 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_lead_time_to_convert"
[0m14:36:12.538498 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_lead_time_to_convert"
[0m14:36:12.538498 [debug] [Thread-1 (]: On model.Marketing.fct_lead_time_to_convert: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_lead_time_to_convert"} */
create or replace transient table MARKETING.marketing.fct_lead_time_to_convert
         as
        (with lead_data as (
    -- Join stg_leads and stg_campaigns to get campaign start date and lead conversion info
    select
        l.lead_id,
        l.campaign_id,
        l.is_converted,
        l.converted_date,
        c.start_date,
        -- Correct usage of DATEDIFF with 'DAY' as the first argument
        case 
            when l.is_converted then DATEDIFF('DAY', c.start_date, l.converted_date)
            else null
        end as time_to_convert
    from
        MARKETING.marketing.stg_leads l
    left join
        MARKETING.marketing.stg_campaigns c
    on
        l.campaign_id = c.campaign_id
)

-- Aggregate the results to calculate average Time to Convert per campaign
select
    campaign_id,
    avg(time_to_convert) as avg_time_to_convert
from
    lead_data
where
    time_to_convert is not null -- Only consider converted leads
group by
    campaign_id
order by
    avg_time_to_convert
        );
[0m14:36:12.538498 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:36:14.824199 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.278 seconds
[0m14:36:14.852342 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a170727b-7c8f-4b47-903d-e949c3c134ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7DCE0D760>]}
[0m14:36:14.852342 [info ] [Thread-1 (]: 1 of 1 OK created sql table model marketing.fct_lead_time_to_convert ........... [[32mSUCCESS 1[0m in 2.36s]
[0m14:36:14.852342 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_lead_time_to_convert
[0m14:36:14.852342 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:36:14.852342 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m14:36:14.852342 [debug] [MainThread]: On list_MARKETING: Close
[0m14:36:15.188579 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m14:36:15.188579 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m14:36:15.512638 [debug] [MainThread]: Connection 'model.Marketing.fct_lead_time_to_convert' was left open.
[0m14:36:15.512638 [debug] [MainThread]: On model.Marketing.fct_lead_time_to_convert: Close
[0m14:36:15.836051 [info ] [MainThread]: 
[0m14:36:15.838274 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.33 seconds (9.33s).
[0m14:36:15.838274 [debug] [MainThread]: Command end result
[0m14:36:15.936630 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m14:36:15.940628 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m14:36:15.944263 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\run_results.json
[0m14:36:15.944263 [info ] [MainThread]: 
[0m14:36:15.944263 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:36:15.944263 [info ] [MainThread]: 
[0m14:36:15.944263 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:36:15.951811 [debug] [MainThread]: Command `dbt run` succeeded at 14:36:15.951811 after 11.49 seconds
[0m14:36:15.952298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7DA953290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7DD99C0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C7DD99C1A0>]}
[0m14:36:15.953361 [debug] [MainThread]: Flushing usage events
[0m14:36:16.907122 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:43:15.565834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BCD0E660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BD1776B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BCD0F050>]}


============================== 14:43:15.565834 | 7129d0cf-7b8e-4a6c-ad29-246b23255dfb ==============================
[0m14:43:15.565834 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:43:15.565834 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select fct_lead_time_to_convert', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:43:16.087224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7129d0cf-7b8e-4a6c-ad29-246b23255dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BF5EE4B0>]}
[0m14:43:16.160427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7129d0cf-7b8e-4a6c-ad29-246b23255dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BD1FC740>]}
[0m14:43:16.162425 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:43:16.543774 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:43:16.721894 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:43:16.737875 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:43:16.789651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7129d0cf-7b8e-4a6c-ad29-246b23255dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BF61DFD0>]}
[0m14:43:16.886512 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m14:43:16.890529 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m14:43:16.912185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7129d0cf-7b8e-4a6c-ad29-246b23255dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BF61DA30>]}
[0m14:43:16.912185 [info ] [MainThread]: Found 20 models, 6 data tests, 5 sources, 479 macros
[0m14:43:16.912185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7129d0cf-7b8e-4a6c-ad29-246b23255dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BFA06AB0>]}
[0m14:43:16.912185 [info ] [MainThread]: 
[0m14:43:16.912185 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:43:16.928290 [info ] [MainThread]: 
[0m14:43:16.928290 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:43:16.928290 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m14:43:17.038128 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m14:43:17.038128 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m14:43:17.038128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:18.189389 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.147 seconds
[0m14:43:18.198157 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m14:43:18.208299 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m14:43:18.208299 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m14:43:18.208299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:19.160446 [debug] [ThreadPool]: SQL status: SUCCESS 20 in 0.956 seconds
[0m14:43:19.176426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7129d0cf-7b8e-4a6c-ad29-246b23255dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BFD48C20>]}
[0m14:43:19.176426 [debug] [Thread-1 (]: Began running node model.Marketing.fct_lead_time_to_convert
[0m14:43:19.176426 [info ] [Thread-1 (]: 1 of 1 START sql table model marketing.fct_lead_time_to_convert ................ [RUN]
[0m14:43:19.176426 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.fct_lead_time_to_convert'
[0m14:43:19.176426 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_lead_time_to_convert
[0m14:43:19.194392 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_lead_time_to_convert"
[0m14:43:19.195681 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_lead_time_to_convert
[0m14:43:19.232787 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_lead_time_to_convert"
[0m14:43:19.235791 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_lead_time_to_convert"
[0m14:43:19.235791 [debug] [Thread-1 (]: On model.Marketing.fct_lead_time_to_convert: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_lead_time_to_convert"} */
create or replace transient table MARKETING.marketing.fct_lead_time_to_convert
         as
        (with lead_data as (
    -- Join stg_leads and stg_campaigns to get campaign start date and lead conversion info
    select
        l.lead_id,
        l.campaign_id,
        l.is_converted,
        l.converted_date,
        c.start_date,
        -- Correct usage of DATEDIFF with 'DAY' as the first argument
        case 
            when l.is_converted then DATEDIFF('DAY', c.start_date, l.converted_date)
            else null
        end as time_to_convert
    from
        MARKETING.marketing.stg_leads l
    left join
        MARKETING.marketing.stg_campaigns c
    on
        l.campaign_id = c.campaign_id
)

-- Aggregate the results to calculate average Time to Convert per campaign
select
    campaign_id,
    avg(time_to_convert) as avg_time_to_convert
from
    lead_data
where
    time_to_convert is not null -- Only consider converted leads
group by
    campaign_id
order by
    avg_time_to_convert
        );
[0m14:43:19.236787 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:43:20.652076 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.419 seconds
[0m14:43:20.699404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7129d0cf-7b8e-4a6c-ad29-246b23255dfb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BCCDD940>]}
[0m14:43:20.699404 [info ] [Thread-1 (]: 1 of 1 OK created sql table model marketing.fct_lead_time_to_convert ........... [[32mSUCCESS 1[0m in 1.52s]
[0m14:43:20.699404 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_lead_time_to_convert
[0m14:43:20.706929 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:20.706929 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m14:43:20.706929 [debug] [MainThread]: On list_MARKETING: Close
[0m14:43:21.025333 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m14:43:21.025333 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m14:43:21.355809 [debug] [MainThread]: Connection 'model.Marketing.fct_lead_time_to_convert' was left open.
[0m14:43:21.355809 [debug] [MainThread]: On model.Marketing.fct_lead_time_to_convert: Close
[0m14:43:21.667684 [info ] [MainThread]: 
[0m14:43:21.667684 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 4.74 seconds (4.74s).
[0m14:43:21.667684 [debug] [MainThread]: Command end result
[0m14:43:21.760496 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m14:43:21.760496 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m14:43:21.760496 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\run_results.json
[0m14:43:21.760496 [info ] [MainThread]: 
[0m14:43:21.760496 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:43:21.760496 [info ] [MainThread]: 
[0m14:43:21.776290 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:43:21.776290 [debug] [MainThread]: Command `dbt run` succeeded at 14:43:21.776290 after 6.39 seconds
[0m14:43:21.776290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BD32FDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BD32F110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000269BD6688C0>]}
[0m14:43:21.776290 [debug] [MainThread]: Flushing usage events
[0m14:43:22.750102 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:45:18.826275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98B820F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98B5B46B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98B5B7230>]}


============================== 14:45:18.831649 | 94656bb3-0469-46be-8f50-cdd9264c8022 ==============================
[0m14:45:18.831649 [info ] [MainThread]: Running with dbt=1.9.4
[0m14:45:18.832624 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fct_lead_time_to_convert', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:45:19.441003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '94656bb3-0469-46be-8f50-cdd9264c8022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98D77F140>]}
[0m14:45:19.513348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '94656bb3-0469-46be-8f50-cdd9264c8022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F988B57DD0>]}
[0m14:45:19.515001 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m14:45:20.027458 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m14:45:20.227397 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:45:20.227397 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:45:20.277661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '94656bb3-0469-46be-8f50-cdd9264c8022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98C5ED730>]}
[0m14:45:20.385968 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m14:45:20.403985 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m14:45:20.435794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '94656bb3-0469-46be-8f50-cdd9264c8022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98DC29EB0>]}
[0m14:45:20.435794 [info ] [MainThread]: Found 20 models, 6 data tests, 5 sources, 479 macros
[0m14:45:20.435794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94656bb3-0469-46be-8f50-cdd9264c8022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98BA3E270>]}
[0m14:45:20.442497 [info ] [MainThread]: 
[0m14:45:20.442497 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:45:20.442497 [info ] [MainThread]: 
[0m14:45:20.442497 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:45:20.442497 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m14:45:23.626944 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m14:45:23.631150 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m14:45:23.631150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:24.941201 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.310 seconds
[0m14:45:24.950059 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m14:45:24.961066 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m14:45:24.961066 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m14:45:24.962066 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:25.972062 [debug] [ThreadPool]: SQL status: SUCCESS 20 in 1.017 seconds
[0m14:45:25.989766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '94656bb3-0469-46be-8f50-cdd9264c8022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98DC00C50>]}
[0m14:45:26.002471 [debug] [Thread-1 (]: Began running node model.Marketing.fct_lead_time_to_convert
[0m14:45:26.003512 [info ] [Thread-1 (]: 1 of 1 START sql table model marketing.fct_lead_time_to_convert ................ [RUN]
[0m14:45:26.004514 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.fct_lead_time_to_convert'
[0m14:45:26.004514 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_lead_time_to_convert
[0m14:45:26.013512 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_lead_time_to_convert"
[0m14:45:26.015479 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_lead_time_to_convert
[0m14:45:26.054118 [debug] [Thread-1 (]: Writing runtime sql for node "model.Marketing.fct_lead_time_to_convert"
[0m14:45:26.056086 [debug] [Thread-1 (]: Using snowflake connection "model.Marketing.fct_lead_time_to_convert"
[0m14:45:26.057115 [debug] [Thread-1 (]: On model.Marketing.fct_lead_time_to_convert: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "model.Marketing.fct_lead_time_to_convert"} */
create or replace transient table MARKETING.marketing.fct_lead_time_to_convert
         as
        (with leads_extended as (
    -- Step 1: Calculate time to convert per lead
    select
        l.lead_id,
        l.campaign_id,
        l.is_converted,
        l.converted_date,
        c.start_date,
        -- Calculate time to convert only if the lead is converted, and the converted date is after or equal to start date
        case 
            when l.is_converted = true and l.converted_date is not null and l.converted_date >= c.start_date
            then datediff('day', c.start_date, l.converted_date)
            else null -- Set to null if not converted, or converted date is before start date, or converted date is null
        end as time_to_convert
    from MARKETING.marketing.stg_leads l
    left join MARKETING.marketing.stg_campaigns c
        on l.campaign_id = c.campaign_id
)

-- Step 2: Aggregate to get average time to convert per campaign
select
    campaign_id,
    avg(time_to_convert) as avg_time_to_convert
from leads_extended
where time_to_convert is not null  -- Only consider converted leads
group by campaign_id
order by avg_time_to_convert
        );
[0m14:45:26.057115 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:45:27.668308 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.619 seconds
[0m14:45:27.704571 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '94656bb3-0469-46be-8f50-cdd9264c8022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98AEFD970>]}
[0m14:45:27.704571 [info ] [Thread-1 (]: 1 of 1 OK created sql table model marketing.fct_lead_time_to_convert ........... [[32mSUCCESS 1[0m in 1.70s]
[0m14:45:27.704571 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_lead_time_to_convert
[0m14:45:27.704571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:27.704571 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m14:45:27.704571 [debug] [MainThread]: On list_MARKETING: Close
[0m14:45:28.047837 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m14:45:28.047837 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m14:45:28.374768 [debug] [MainThread]: Connection 'model.Marketing.fct_lead_time_to_convert' was left open.
[0m14:45:28.374768 [debug] [MainThread]: On model.Marketing.fct_lead_time_to_convert: Close
[0m14:45:28.701804 [info ] [MainThread]: 
[0m14:45:28.702813 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 8.26 seconds (8.26s).
[0m14:45:28.702813 [debug] [MainThread]: Command end result
[0m14:45:28.792609 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m14:45:28.795626 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m14:45:28.803606 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\run_results.json
[0m14:45:28.803606 [info ] [MainThread]: 
[0m14:45:28.803606 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:45:28.803606 [info ] [MainThread]: 
[0m14:45:28.803606 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:45:28.803606 [debug] [MainThread]: Command `dbt run` succeeded at 14:45:28.803606 after 10.17 seconds
[0m14:45:28.803606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98B4604D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F98D6E23C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F988F986B0>]}
[0m14:45:28.808859 [debug] [MainThread]: Flushing usage events
[0m14:45:29.753730 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:01:56.318920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025815D54860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025816217620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000258160290A0>]}


============================== 15:01:56.373565 | 173c4295-23e0-4694-a5a5-347d3e4cdfc7 ==============================
[0m15:01:56.373565 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:01:56.374572 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:01:57.337612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '173c4295-23e0-4694-a5a5-347d3e4cdfc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002581853E6F0>]}
[0m15:01:57.424668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '173c4295-23e0-4694-a5a5-347d3e4cdfc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025816140A40>]}
[0m15:01:57.426690 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:01:58.018551 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:01:58.247762 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:01:58.247762 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:01:58.307936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '173c4295-23e0-4694-a5a5-347d3e4cdfc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025818748680>]}
[0m15:01:58.373701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '173c4295-23e0-4694-a5a5-347d3e4cdfc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025818AEB4D0>]}
[0m15:01:58.374669 [info ] [MainThread]: Found 20 models, 6 data tests, 5 sources, 479 macros
[0m15:01:58.375667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '173c4295-23e0-4694-a5a5-347d3e4cdfc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025817367B30>]}
[0m15:01:58.378618 [info ] [MainThread]: 
[0m15:01:58.379622 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:01:58.380619 [info ] [MainThread]: 
[0m15:01:58.380619 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:01:58.388590 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_marketing'
[0m15:02:04.079035 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m15:02:04.079035 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m15:02:04.079035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:05.560384 [debug] [ThreadPool]: SQL status: SUCCESS 20 in 1.482 seconds
[0m15:02:05.570278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '173c4295-23e0-4694-a5a5-347d3e4cdfc7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025818601460>]}
[0m15:02:05.580874 [debug] [Thread-1 (]: Began running node model.Marketing.stg_campaigns
[0m15:02:05.581900 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.Marketing.stg_campaigns'
[0m15:02:05.581900 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_campaigns
[0m15:02:05.597907 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_campaigns"
[0m15:02:05.630230 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_campaigns
[0m15:02:05.631228 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_campaigns
[0m15:02:05.632229 [debug] [Thread-1 (]: Began running node model.Marketing.stg_channels
[0m15:02:05.633254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_campaigns, now model.Marketing.stg_channels)
[0m15:02:05.633254 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_channels
[0m15:02:05.636230 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_channels"
[0m15:02:05.636230 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_channels
[0m15:02:05.636230 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_channels
[0m15:02:05.636230 [debug] [Thread-1 (]: Began running node model.Marketing.stg_leads
[0m15:02:05.636230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_channels, now model.Marketing.stg_leads)
[0m15:02:05.636230 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_leads
[0m15:02:05.651444 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_leads"
[0m15:02:05.652418 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_leads
[0m15:02:05.652418 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_leads
[0m15:02:05.652418 [debug] [Thread-1 (]: Began running node model.Marketing.stg_revenue
[0m15:02:05.652418 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_leads, now model.Marketing.stg_revenue)
[0m15:02:05.652418 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_revenue
[0m15:02:05.652418 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_revenue"
[0m15:02:05.652418 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_revenue
[0m15:02:05.662072 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_revenue
[0m15:02:05.663116 [debug] [Thread-1 (]: Began running node model.Marketing.stg_spend
[0m15:02:05.664080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_revenue, now model.Marketing.stg_spend)
[0m15:02:05.665113 [debug] [Thread-1 (]: Began compiling node model.Marketing.stg_spend
[0m15:02:05.668940 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.stg_spend"
[0m15:02:05.668940 [debug] [Thread-1 (]: Began executing node model.Marketing.stg_spend
[0m15:02:05.668940 [debug] [Thread-1 (]: Finished running node model.Marketing.stg_spend
[0m15:02:05.668940 [debug] [Thread-1 (]: Began running node test.Marketing.accepted_values_stg_campaigns_status__planned__active__completed.5e1619bd58
[0m15:02:05.673194 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.stg_spend, now test.Marketing.accepted_values_stg_campaigns_status__planned__active__completed.5e1619bd58)
[0m15:02:05.673194 [debug] [Thread-1 (]: Began compiling node test.Marketing.accepted_values_stg_campaigns_status__planned__active__completed.5e1619bd58
[0m15:02:05.685899 [debug] [Thread-1 (]: Writing injected SQL for node "test.Marketing.accepted_values_stg_campaigns_status__planned__active__completed.5e1619bd58"
[0m15:02:05.685899 [debug] [Thread-1 (]: Began executing node test.Marketing.accepted_values_stg_campaigns_status__planned__active__completed.5e1619bd58
[0m15:02:05.685899 [debug] [Thread-1 (]: Finished running node test.Marketing.accepted_values_stg_campaigns_status__planned__active__completed.5e1619bd58
[0m15:02:05.685899 [debug] [Thread-1 (]: Began running node test.Marketing.not_null_stg_campaigns_campaign_id.644b49426a
[0m15:02:05.685899 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Marketing.accepted_values_stg_campaigns_status__planned__active__completed.5e1619bd58, now test.Marketing.not_null_stg_campaigns_campaign_id.644b49426a)
[0m15:02:05.685899 [debug] [Thread-1 (]: Began compiling node test.Marketing.not_null_stg_campaigns_campaign_id.644b49426a
[0m15:02:05.702473 [debug] [Thread-1 (]: Writing injected SQL for node "test.Marketing.not_null_stg_campaigns_campaign_id.644b49426a"
[0m15:02:05.702473 [debug] [Thread-1 (]: Began executing node test.Marketing.not_null_stg_campaigns_campaign_id.644b49426a
[0m15:02:05.702473 [debug] [Thread-1 (]: Finished running node test.Marketing.not_null_stg_campaigns_campaign_id.644b49426a
[0m15:02:05.702473 [debug] [Thread-1 (]: Began running node test.Marketing.unique_stg_campaigns_campaign_id.72679b60d0
[0m15:02:05.702473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Marketing.not_null_stg_campaigns_campaign_id.644b49426a, now test.Marketing.unique_stg_campaigns_campaign_id.72679b60d0)
[0m15:02:05.702473 [debug] [Thread-1 (]: Began compiling node test.Marketing.unique_stg_campaigns_campaign_id.72679b60d0
[0m15:02:05.717825 [debug] [Thread-1 (]: Writing injected SQL for node "test.Marketing.unique_stg_campaigns_campaign_id.72679b60d0"
[0m15:02:05.727391 [debug] [Thread-1 (]: Began executing node test.Marketing.unique_stg_campaigns_campaign_id.72679b60d0
[0m15:02:05.728388 [debug] [Thread-1 (]: Finished running node test.Marketing.unique_stg_campaigns_campaign_id.72679b60d0
[0m15:02:05.729034 [debug] [Thread-1 (]: Began running node model.Marketing.fct_campaign_channel_effectiveness
[0m15:02:05.729595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Marketing.unique_stg_campaigns_campaign_id.72679b60d0, now model.Marketing.fct_campaign_channel_effectiveness)
[0m15:02:05.730605 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_campaign_channel_effectiveness
[0m15:02:05.734636 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_campaign_channel_effectiveness"
[0m15:02:05.736104 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_campaign_channel_effectiveness
[0m15:02:05.737117 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_campaign_channel_effectiveness
[0m15:02:05.738113 [debug] [Thread-1 (]: Began running node model.Marketing.fct_inactive_campaigns
[0m15:02:05.739112 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_campaign_channel_effectiveness, now model.Marketing.fct_inactive_campaigns)
[0m15:02:05.739112 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_inactive_campaigns
[0m15:02:05.743421 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_inactive_campaigns"
[0m15:02:05.744456 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_inactive_campaigns
[0m15:02:05.745377 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_inactive_campaigns
[0m15:02:05.745377 [debug] [Thread-1 (]: Began running node model.Marketing.fct_lead_time_to_convert
[0m15:02:05.746622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_inactive_campaigns, now model.Marketing.fct_lead_time_to_convert)
[0m15:02:05.746622 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_lead_time_to_convert
[0m15:02:05.750589 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_lead_time_to_convert"
[0m15:02:05.751589 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_lead_time_to_convert
[0m15:02:05.752590 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_lead_time_to_convert
[0m15:02:05.753589 [debug] [Thread-1 (]: Began running node model.Marketing.int_lead_conversion
[0m15:02:05.753589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_lead_time_to_convert, now model.Marketing.int_lead_conversion)
[0m15:02:05.754590 [debug] [Thread-1 (]: Began compiling node model.Marketing.int_lead_conversion
[0m15:02:05.757589 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.int_lead_conversion"
[0m15:02:05.759385 [debug] [Thread-1 (]: Began executing node model.Marketing.int_lead_conversion
[0m15:02:05.760601 [debug] [Thread-1 (]: Finished running node model.Marketing.int_lead_conversion
[0m15:02:05.761972 [debug] [Thread-1 (]: Began running node model.Marketing.int_lead_lifecycle
[0m15:02:05.762621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.int_lead_conversion, now model.Marketing.int_lead_lifecycle)
[0m15:02:05.763250 [debug] [Thread-1 (]: Began compiling node model.Marketing.int_lead_lifecycle
[0m15:02:05.766603 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.int_lead_lifecycle"
[0m15:02:05.767604 [debug] [Thread-1 (]: Began executing node model.Marketing.int_lead_lifecycle
[0m15:02:05.768572 [debug] [Thread-1 (]: Finished running node model.Marketing.int_lead_lifecycle
[0m15:02:05.769605 [debug] [Thread-1 (]: Began running node model.Marketing.tmp_campaign_lead_check
[0m15:02:05.770361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.int_lead_lifecycle, now model.Marketing.tmp_campaign_lead_check)
[0m15:02:05.770361 [debug] [Thread-1 (]: Began compiling node model.Marketing.tmp_campaign_lead_check
[0m15:02:05.770361 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.tmp_campaign_lead_check"
[0m15:02:05.770361 [debug] [Thread-1 (]: Began executing node model.Marketing.tmp_campaign_lead_check
[0m15:02:05.770361 [debug] [Thread-1 (]: Finished running node model.Marketing.tmp_campaign_lead_check
[0m15:02:05.770361 [debug] [Thread-1 (]: Began running node test.Marketing.accepted_values_stg_leads_is_converted__True__False__None.f64a5036e1
[0m15:02:05.770361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.tmp_campaign_lead_check, now test.Marketing.accepted_values_stg_leads_is_converted__True__False__None.f64a5036e1)
[0m15:02:05.770361 [debug] [Thread-1 (]: Began compiling node test.Marketing.accepted_values_stg_leads_is_converted__True__False__None.f64a5036e1
[0m15:02:05.783028 [debug] [Thread-1 (]: Writing injected SQL for node "test.Marketing.accepted_values_stg_leads_is_converted__True__False__None.f64a5036e1"
[0m15:02:05.784997 [debug] [Thread-1 (]: Began executing node test.Marketing.accepted_values_stg_leads_is_converted__True__False__None.f64a5036e1
[0m15:02:05.784997 [debug] [Thread-1 (]: Finished running node test.Marketing.accepted_values_stg_leads_is_converted__True__False__None.f64a5036e1
[0m15:02:05.784997 [debug] [Thread-1 (]: Began running node test.Marketing.not_null_stg_leads_lead_id.2c6a8b754b
[0m15:02:05.787029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Marketing.accepted_values_stg_leads_is_converted__True__False__None.f64a5036e1, now test.Marketing.not_null_stg_leads_lead_id.2c6a8b754b)
[0m15:02:05.787029 [debug] [Thread-1 (]: Began compiling node test.Marketing.not_null_stg_leads_lead_id.2c6a8b754b
[0m15:02:05.841698 [debug] [Thread-1 (]: Writing injected SQL for node "test.Marketing.not_null_stg_leads_lead_id.2c6a8b754b"
[0m15:02:05.846720 [debug] [Thread-1 (]: Began executing node test.Marketing.not_null_stg_leads_lead_id.2c6a8b754b
[0m15:02:05.847721 [debug] [Thread-1 (]: Finished running node test.Marketing.not_null_stg_leads_lead_id.2c6a8b754b
[0m15:02:05.848720 [debug] [Thread-1 (]: Began running node test.Marketing.unique_stg_leads_lead_id.4eba5ab6bf
[0m15:02:05.848720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Marketing.not_null_stg_leads_lead_id.2c6a8b754b, now test.Marketing.unique_stg_leads_lead_id.4eba5ab6bf)
[0m15:02:05.849720 [debug] [Thread-1 (]: Began compiling node test.Marketing.unique_stg_leads_lead_id.4eba5ab6bf
[0m15:02:05.851721 [debug] [Thread-1 (]: Writing injected SQL for node "test.Marketing.unique_stg_leads_lead_id.4eba5ab6bf"
[0m15:02:05.851721 [debug] [Thread-1 (]: Began executing node test.Marketing.unique_stg_leads_lead_id.4eba5ab6bf
[0m15:02:05.851721 [debug] [Thread-1 (]: Finished running node test.Marketing.unique_stg_leads_lead_id.4eba5ab6bf
[0m15:02:05.851721 [debug] [Thread-1 (]: Began running node model.Marketing.fct_active_campaign_revenue
[0m15:02:05.851721 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.Marketing.unique_stg_leads_lead_id.4eba5ab6bf, now model.Marketing.fct_active_campaign_revenue)
[0m15:02:05.851721 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_active_campaign_revenue
[0m15:02:05.861327 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_active_campaign_revenue"
[0m15:02:05.863344 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_active_campaign_revenue
[0m15:02:05.864371 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_active_campaign_revenue
[0m15:02:05.864371 [debug] [Thread-1 (]: Began running node model.Marketing.fct_total_revenue_by_campaign
[0m15:02:05.865339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_active_campaign_revenue, now model.Marketing.fct_total_revenue_by_campaign)
[0m15:02:05.865339 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_total_revenue_by_campaign
[0m15:02:05.868338 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_total_revenue_by_campaign"
[0m15:02:05.868338 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_total_revenue_by_campaign
[0m15:02:05.868338 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_total_revenue_by_campaign
[0m15:02:05.868338 [debug] [Thread-1 (]: Began running node model.Marketing.fct_channel_spend_efficiency
[0m15:02:05.868338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_total_revenue_by_campaign, now model.Marketing.fct_channel_spend_efficiency)
[0m15:02:05.868338 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_channel_spend_efficiency
[0m15:02:05.876113 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_channel_spend_efficiency"
[0m15:02:05.876113 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_channel_spend_efficiency
[0m15:02:05.879061 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_channel_spend_efficiency
[0m15:02:05.879061 [debug] [Thread-1 (]: Began running node model.Marketing.fct_monthly_spend_by_channel
[0m15:02:05.880107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_channel_spend_efficiency, now model.Marketing.fct_monthly_spend_by_channel)
[0m15:02:05.880107 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_monthly_spend_by_channel
[0m15:02:05.884069 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_monthly_spend_by_channel"
[0m15:02:05.885069 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_monthly_spend_by_channel
[0m15:02:05.885069 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_monthly_spend_by_channel
[0m15:02:05.885069 [debug] [Thread-1 (]: Began running node model.Marketing.int_campaign_performance
[0m15:02:05.887157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_monthly_spend_by_channel, now model.Marketing.int_campaign_performance)
[0m15:02:05.887157 [debug] [Thread-1 (]: Began compiling node model.Marketing.int_campaign_performance
[0m15:02:05.891133 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.int_campaign_performance"
[0m15:02:05.891133 [debug] [Thread-1 (]: Began executing node model.Marketing.int_campaign_performance
[0m15:02:05.893140 [debug] [Thread-1 (]: Finished running node model.Marketing.int_campaign_performance
[0m15:02:05.893140 [debug] [Thread-1 (]: Began running node model.Marketing.int_channel_spend
[0m15:02:05.893140 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.int_campaign_performance, now model.Marketing.int_channel_spend)
[0m15:02:05.893140 [debug] [Thread-1 (]: Began compiling node model.Marketing.int_channel_spend
[0m15:02:05.898830 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.int_channel_spend"
[0m15:02:05.899829 [debug] [Thread-1 (]: Began executing node model.Marketing.int_channel_spend
[0m15:02:05.900830 [debug] [Thread-1 (]: Finished running node model.Marketing.int_channel_spend
[0m15:02:05.900830 [debug] [Thread-1 (]: Began running node model.Marketing.fct_channel_conversion_rate
[0m15:02:05.901832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.int_channel_spend, now model.Marketing.fct_channel_conversion_rate)
[0m15:02:05.901832 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_channel_conversion_rate
[0m15:02:05.901832 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_channel_conversion_rate"
[0m15:02:05.901832 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_channel_conversion_rate
[0m15:02:05.901832 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_channel_conversion_rate
[0m15:02:05.901832 [debug] [Thread-1 (]: Began running node model.Marketing.fct_campaign_duration_cost
[0m15:02:05.901832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_channel_conversion_rate, now model.Marketing.fct_campaign_duration_cost)
[0m15:02:05.901832 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_campaign_duration_cost
[0m15:02:05.912472 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_campaign_duration_cost"
[0m15:02:05.913514 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_campaign_duration_cost
[0m15:02:05.914481 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_campaign_duration_cost
[0m15:02:05.915487 [debug] [Thread-1 (]: Began running node model.Marketing.fct_campaign_roi
[0m15:02:05.916488 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.Marketing.fct_campaign_duration_cost, now model.Marketing.fct_campaign_roi)
[0m15:02:05.916488 [debug] [Thread-1 (]: Began compiling node model.Marketing.fct_campaign_roi
[0m15:02:05.918488 [debug] [Thread-1 (]: Writing injected SQL for node "model.Marketing.fct_campaign_roi"
[0m15:02:05.918488 [debug] [Thread-1 (]: Began executing node model.Marketing.fct_campaign_roi
[0m15:02:05.918488 [debug] [Thread-1 (]: Finished running node model.Marketing.fct_campaign_roi
[0m15:02:05.918488 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:02:05.918488 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m15:02:05.918488 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m15:02:06.247043 [debug] [MainThread]: Connection 'model.Marketing.fct_campaign_roi' was properly closed.
[0m15:02:06.252947 [debug] [MainThread]: Command end result
[0m15:02:06.358573 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m15:02:06.378901 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m15:02:06.388924 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\run_results.json
[0m15:02:06.944935 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m15:02:06.944935 [info ] [MainThread]: Building catalog
[0m15:02:06.961000 [debug] [ThreadPool]: Acquiring new snowflake connection 'MARKETING.information_schema'
[0m15:02:06.976945 [debug] [ThreadPool]: Using snowflake connection "MARKETING.information_schema"
[0m15:02:06.976945 [debug] [ThreadPool]: On MARKETING.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "MARKETING.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        case
            when is_dynamic = 'YES' and table_type = 'BASE TABLE' THEN 'DYNAMIC TABLE'
            else table_type
        end as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from MARKETING.INFORMATION_SCHEMA.tables
            where (
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'int_lead_conversion' and upper("table_name") = upper('int_lead_conversion')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'fct_campaign_roi' and upper("table_name") = upper('fct_campaign_roi')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'fct_campaign_channel_effectiveness' and upper("table_name") = upper('fct_campaign_channel_effectiveness')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'fct_channel_spend_efficiency' and upper("table_name") = upper('fct_channel_spend_efficiency')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'raw_channels' and upper("table_name") = upper('raw_channels')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'int_campaign_performance' and upper("table_name") = upper('int_campaign_performance')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'raw_spend' and upper("table_name") = upper('raw_spend')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'fct_lead_time_to_convert' and upper("table_name") = upper('fct_lead_time_to_convert')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'fct_monthly_spend_by_channel' and upper("table_name") = upper('fct_monthly_spend_by_channel')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'fct_active_campaign_revenue' and upper("table_name") = upper('fct_active_campaign_revenue')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'raw_leads' and upper("table_name") = upper('raw_leads')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'fct_channel_conversion_rate' and upper("table_name") = upper('fct_channel_conversion_rate')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'int_channel_spend' and upper("table_name") = upper('int_channel_spend')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'raw_campaigns' and upper("table_name") = upper('raw_campaigns')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'stg_leads' and upper("table_name") = upper('stg_leads')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'int_lead_lifecycle' and upper("table_name") = upper('int_lead_lifecycle')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'stg_channels' and upper("table_name") = upper('stg_channels')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'fct_campaign_duration_cost' and upper("table_name") = upper('fct_campaign_duration_cost')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'stg_campaigns' and upper("table_name") = upper('stg_campaigns')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'stg_revenue' and upper("table_name") = upper('stg_revenue')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'fct_inactive_campaigns' and upper("table_name") = upper('fct_inactive_campaigns')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'stg_spend' and upper("table_name") = upper('stg_spend')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'tmp_campaign_lead_check' and upper("table_name") = upper('tmp_campaign_lead_check')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'fct_total_revenue_by_campaign' and upper("table_name") = upper('fct_total_revenue_by_campaign')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'raw_revenue' and upper("table_name") = upper('raw_revenue')

                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from MARKETING.INFORMATION_SCHEMA.columns
            where (
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'int_lead_conversion' and upper("table_name") = upper('int_lead_conversion')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'fct_campaign_roi' and upper("table_name") = upper('fct_campaign_roi')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'fct_campaign_channel_effectiveness' and upper("table_name") = upper('fct_campaign_channel_effectiveness')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'fct_channel_spend_efficiency' and upper("table_name") = upper('fct_channel_spend_efficiency')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'raw_channels' and upper("table_name") = upper('raw_channels')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'int_campaign_performance' and upper("table_name") = upper('int_campaign_performance')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'raw_spend' and upper("table_name") = upper('raw_spend')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'fct_lead_time_to_convert' and upper("table_name") = upper('fct_lead_time_to_convert')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'fct_monthly_spend_by_channel' and upper("table_name") = upper('fct_monthly_spend_by_channel')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'fct_active_campaign_revenue' and upper("table_name") = upper('fct_active_campaign_revenue')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'raw_leads' and upper("table_name") = upper('raw_leads')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'fct_channel_conversion_rate' and upper("table_name") = upper('fct_channel_conversion_rate')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'int_channel_spend' and upper("table_name") = upper('int_channel_spend')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'raw_campaigns' and upper("table_name") = upper('raw_campaigns')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'stg_leads' and upper("table_name") = upper('stg_leads')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'int_lead_lifecycle' and upper("table_name") = upper('int_lead_lifecycle')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'stg_channels' and upper("table_name") = upper('stg_channels')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'fct_campaign_duration_cost' and upper("table_name") = upper('fct_campaign_duration_cost')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'stg_campaigns' and upper("table_name") = upper('stg_campaigns')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'stg_revenue' and upper("table_name") = upper('stg_revenue')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'fct_inactive_campaigns' and upper("table_name") = upper('fct_inactive_campaigns')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'stg_spend' and upper("table_name") = upper('stg_spend')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'tmp_campaign_lead_check' and upper("table_name") = upper('tmp_campaign_lead_check')

                )
             or 
                (
                    
    "table_schema" ilike 'marketing' and upper("table_schema") = upper('marketing')

                    and 
    "table_name" ilike 'fct_total_revenue_by_campaign' and upper("table_name") = upper('fct_total_revenue_by_campaign')

                )
             or 
                (
                    
    "table_schema" ilike 'raw' and upper("table_schema") = upper('raw')

                    and 
    "table_name" ilike 'raw_revenue' and upper("table_name") = upper('raw_revenue')

                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m15:02:06.976945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:02:16.433628 [debug] [ThreadPool]: SQL status: SUCCESS 130 in 9.445 seconds
[0m15:02:16.496666 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\catalog.json
[0m15:02:16.528498 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m15:02:16.537396 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m15:02:16.537396 [info ] [MainThread]: Catalog written to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\catalog.json
[0m15:02:16.537396 [debug] [MainThread]: Command `dbt docs generate` succeeded at 15:02:16.537396 after 20.81 seconds
[0m15:02:16.537396 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m15:02:16.537396 [debug] [MainThread]: Connection 'MARKETING.information_schema' was left open.
[0m15:02:16.537396 [debug] [MainThread]: On MARKETING.information_schema: Close
[0m15:02:16.860049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025818771A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025818771B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025818E58530>]}
[0m15:02:16.860049 [debug] [MainThread]: Flushing usage events
[0m15:02:17.793844 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:02:24.382160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4FFB8FE60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4FFB8EF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4FFB8EF60>]}


============================== 15:02:24.393185 | a78461d4-fe0e-48b7-8de2-1fedb6e1e6eb ==============================
[0m15:02:24.393185 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:02:24.393185 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m15:02:24.908433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a78461d4-fe0e-48b7-8de2-1fedb6e1e6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4FFA5CB00>]}
[0m15:02:24.982656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a78461d4-fe0e-48b7-8de2-1fedb6e1e6eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4FF9D78F0>]}
[0m15:04:14.826183 [error] [MainThread]: Encountered an error:

[0m15:04:14.930317 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\RajgokulRM\Documents\DE_FINAL\env\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\RajgokulRM\Documents\DE_FINAL\env\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\RajgokulRM\Documents\DE_FINAL\env\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\RajgokulRM\Documents\DE_FINAL\env\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\RajgokulRM\Documents\DE_FINAL\env\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\RajgokulRM\Documents\DE_FINAL\env\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\RajgokulRM\Documents\DE_FINAL\env\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\RajgokulRM\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\RajgokulRM\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\RajgokulRM\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m15:04:14.933640 [debug] [MainThread]: Command `dbt docs serve` failed at 15:04:14.933640 after 110.71 seconds
[0m15:04:14.934684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D4FFB37560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D481DD47D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D481DB38C0>]}
[0m15:04:14.935681 [debug] [MainThread]: Flushing usage events
[0m15:04:15.870820 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:53:24.230634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181E69E8DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181E69E9010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181E69E8EF0>]}


============================== 10:53:24.240485 | e3815777-621e-46da-b75f-388fcb6343d3 ==============================
[0m10:53:24.240485 [info ] [MainThread]: Running with dbt=1.9.4
[0m10:53:24.240485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:53:28.533557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3815777-621e-46da-b75f-388fcb6343d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F3D6F170>]}
[0m10:53:28.606594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3815777-621e-46da-b75f-388fcb6343d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181E664FA40>]}
[0m10:53:28.608601 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m10:53:29.413287 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m10:53:29.655609 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m10:53:29.655609 [debug] [MainThread]: Partial parsing: updated file: Marketing://snapshots\campaign_snapshot.sql
[0m10:53:30.036655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3815777-621e-46da-b75f-388fcb6343d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F45D11C0>]}
[0m10:53:30.149350 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m10:53:30.199247 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m10:53:30.500558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3815777-621e-46da-b75f-388fcb6343d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F43D7110>]}
[0m10:53:30.501785 [info ] [MainThread]: Found 20 models, 6 data tests, 1 snapshot, 5 sources, 479 macros
[0m10:53:30.502689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3815777-621e-46da-b75f-388fcb6343d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F460EAB0>]}
[0m10:53:30.505596 [info ] [MainThread]: 
[0m10:53:30.506594 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:53:30.507596 [info ] [MainThread]: 
[0m10:53:30.508596 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:53:30.509595 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m10:53:34.146468 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m10:53:34.146468 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m10:53:34.147470 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:36.315008 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.169 seconds
[0m10:53:36.319016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MARKETING, now create_MARKETING_snapshots)
[0m10:53:36.319016 [debug] [ThreadPool]: Creating schema "database: "MARKETING"
schema: "snapshots"
"
[0m10:53:36.327032 [debug] [ThreadPool]: Using snowflake connection "create_MARKETING_snapshots"
[0m10:53:36.327032 [debug] [ThreadPool]: On create_MARKETING_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "create_MARKETING_snapshots"} */
create schema if not exists MARKETING.snapshots
[0m10:53:36.676774 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.349 seconds
[0m10:53:36.686738 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_snapshots'
[0m10:53:36.699617 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_snapshots"
[0m10:53:36.700616 [debug] [ThreadPool]: On list_MARKETING_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_snapshots"} */
show objects in MARKETING.snapshots limit 10000;
[0m10:53:36.700616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:53:37.703751 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.003 seconds
[0m10:53:37.703751 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MARKETING_snapshots, now list_MARKETING_marketing)
[0m10:53:37.703751 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m10:53:37.703751 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m10:53:37.951964 [debug] [ThreadPool]: SQL status: SUCCESS 20 in 0.242 seconds
[0m10:53:38.206687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3815777-621e-46da-b75f-388fcb6343d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181E74C08F0>]}
[0m10:53:38.219029 [debug] [Thread-1 (]: Began running node snapshot.Marketing.campaign_snapshot
[0m10:53:38.219994 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.campaign_snapshot .............................. [RUN]
[0m10:53:38.222020 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.Marketing.campaign_snapshot'
[0m10:53:38.222020 [debug] [Thread-1 (]: Began compiling node snapshot.Marketing.campaign_snapshot
[0m10:53:38.232405 [debug] [Thread-1 (]: Began executing node snapshot.Marketing.campaign_snapshot
[0m10:53:38.339418 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Marketing.campaign_snapshot"
[0m10:53:38.340418 [debug] [Thread-1 (]: On snapshot.Marketing.campaign_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "snapshot.Marketing.campaign_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "snapshot.Marketing.campaign_snapshot"} */
select * from (
        
    

    select *,
        md5(coalesce(cast(campaign_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        
    

    SELECT * FROM MARKETING.marketing.stg_campaigns

    ) sbq



    ) as __dbt_sbq
    where false
    limit 0
[0m10:53:38.341419 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m10:53:39.767243 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.426 seconds
[0m10:53:39.771266 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Marketing.campaign_snapshot"
[0m10:53:39.772268 [debug] [Thread-1 (]: On snapshot.Marketing.campaign_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "snapshot.Marketing.campaign_snapshot"} */
/* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "snapshot.Marketing.campaign_snapshot"} */
select * from (
        select to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_snapshot_time
    ) as __dbt_sbq
    where false
    limit 0
[0m10:53:39.950494 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.178 seconds
[0m10:53:39.951494 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.Marketing.campaign_snapshot"
[0m10:53:39.953494 [debug] [Thread-1 (]: Using snowflake connection "snapshot.Marketing.campaign_snapshot"
[0m10:53:39.954494 [debug] [Thread-1 (]: On snapshot.Marketing.campaign_snapshot: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "node_id": "snapshot.Marketing.campaign_snapshot"} */
create or replace transient table MARKETING.snapshots.campaign_snapshot
         as
        (
    

    select *,
        md5(coalesce(cast(campaign_id as varchar ), '')
         || '|' || coalesce(cast(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as varchar ), '')
        ) as dbt_scd_id,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
        to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
        
  
  coalesce(nullif(to_timestamp_ntz(convert_timezone('UTC', current_timestamp())), to_timestamp_ntz(convert_timezone('UTC', current_timestamp()))), null)
  as dbt_valid_to
from (
        
    

    SELECT * FROM MARKETING.marketing.stg_campaigns

    ) sbq



        );
[0m10:53:41.028565 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.074 seconds
[0m10:53:41.065908 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3815777-621e-46da-b75f-388fcb6343d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181E6936720>]}
[0m10:53:41.066916 [info ] [Thread-1 (]: 1 of 1 OK snapshotted snapshots.campaign_snapshot .............................. [[32mSUCCESS 1[0m in 2.84s]
[0m10:53:41.067562 [debug] [Thread-1 (]: Finished running node snapshot.Marketing.campaign_snapshot
[0m10:53:41.069569 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:53:41.069569 [debug] [MainThread]: Connection 'create_MARKETING_snapshots' was left open.
[0m10:53:41.070615 [debug] [MainThread]: On create_MARKETING_snapshots: Close
[0m10:53:41.394181 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m10:53:41.394181 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m10:53:41.724674 [debug] [MainThread]: Connection 'snapshot.Marketing.campaign_snapshot' was left open.
[0m10:53:41.724674 [debug] [MainThread]: On snapshot.Marketing.campaign_snapshot: Close
[0m10:53:42.048158 [info ] [MainThread]: 
[0m10:53:42.049044 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 11.54 seconds (11.54s).
[0m10:53:42.051709 [debug] [MainThread]: Command end result
[0m10:53:42.078922 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m10:53:42.095051 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m10:53:42.095051 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\run_results.json
[0m10:53:42.095051 [info ] [MainThread]: 
[0m10:53:42.095051 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:53:42.105674 [info ] [MainThread]: 
[0m10:53:42.105674 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:53:42.105674 [debug] [MainThread]: Command `dbt snapshot` succeeded at 10:53:42.105674 after 18.10 seconds
[0m10:53:42.105674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181E7143E60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181F30C2030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000181E7369670>]}
[0m10:53:42.105674 [debug] [MainThread]: Flushing usage events
[0m10:53:43.323037 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:46:16.184652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F003D76420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F003D76B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F003F95C70>]}


============================== 15:46:16.184652 | e06c6891-896e-436d-b55a-7de8ac97dba5 ==============================
[0m15:46:16.184652 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:46:16.200595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt snapshot', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:46:22.626867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e06c6891-896e-436d-b55a-7de8ac97dba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0104DDFA0>]}
[0m15:46:22.706253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e06c6891-896e-436d-b55a-7de8ac97dba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0111BC7D0>]}
[0m15:46:22.706253 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:46:24.062567 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:46:24.357234 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:46:24.358234 [debug] [MainThread]: Partial parsing: updated file: Marketing://snapshots\campaign_snapshot.sql
[0m15:46:24.708727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e06c6891-896e-436d-b55a-7de8ac97dba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F011811190>]}
[0m15:46:24.927092 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m15:46:24.979970 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m15:46:25.067724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e06c6891-896e-436d-b55a-7de8ac97dba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F01172CC80>]}
[0m15:46:25.067724 [info ] [MainThread]: Found 20 models, 6 data tests, 1 snapshot, 5 sources, 479 macros
[0m15:46:25.073091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e06c6891-896e-436d-b55a-7de8ac97dba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F00FD9EE40>]}
[0m15:46:25.076829 [info ] [MainThread]: 
[0m15:46:25.076829 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:46:25.076829 [info ] [MainThread]: 
[0m15:46:25.079207 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:46:25.080712 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m15:46:29.462911 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m15:46:29.462911 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m15:46:29.463910 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:31.118426 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.669 seconds
[0m15:46:31.135114 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_snapshots'
[0m15:46:31.149476 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_snapshots"
[0m15:46:31.149476 [debug] [ThreadPool]: On list_MARKETING_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_snapshots"} */
show objects in MARKETING.snapshots limit 10000;
[0m15:46:31.149476 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:32.136221 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.986 seconds
[0m15:46:32.151581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MARKETING_snapshots, now list_MARKETING_marketing)
[0m15:46:32.151581 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m15:46:32.151581 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m15:46:32.383517 [debug] [ThreadPool]: SQL status: SUCCESS 20 in 0.237 seconds
[0m15:46:32.417681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e06c6891-896e-436d-b55a-7de8ac97dba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F011521070>]}
[0m15:46:32.436298 [debug] [Thread-1 (]: Began running node snapshot.Marketing.campaign_snapshot
[0m15:46:32.436298 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.campaign_snapshot .............................. [RUN]
[0m15:46:32.436298 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.Marketing.campaign_snapshot'
[0m15:46:32.436298 [debug] [Thread-1 (]: Began compiling node snapshot.Marketing.campaign_snapshot
[0m15:46:32.627744 [debug] [Thread-1 (]: Compilation Error in snapshot campaign_snapshot (snapshots\campaign_snapshot.sql)
  'snapshot_check' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:46:32.630744 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e06c6891-896e-436d-b55a-7de8ac97dba5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0116AA8A0>]}
[0m15:46:32.631746 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.campaign_snapshot .......................... [[31mERROR[0m in 0.19s]
[0m15:46:32.632752 [debug] [Thread-1 (]: Finished running node snapshot.Marketing.campaign_snapshot
[0m15:46:32.633745 [debug] [Thread-4 (]: Marking all children of 'snapshot.Marketing.campaign_snapshot' to be skipped because of status 'error'.  Reason: Compilation Error in snapshot campaign_snapshot (snapshots\campaign_snapshot.sql)
  'snapshot_check' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m15:46:32.635745 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:32.637095 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m15:46:32.637095 [debug] [MainThread]: On list_MARKETING: Close
[0m15:46:32.965098 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m15:46:32.965098 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m15:46:33.282390 [debug] [MainThread]: Connection 'snapshot.Marketing.campaign_snapshot' was properly closed.
[0m15:46:33.282390 [info ] [MainThread]: 
[0m15:46:33.282390 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 8.21 seconds (8.21s).
[0m15:46:33.282390 [debug] [MainThread]: Command end result
[0m15:46:33.321702 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m15:46:33.338613 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m15:46:33.338613 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\run_results.json
[0m15:46:33.338613 [info ] [MainThread]: 
[0m15:46:33.338613 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:46:33.338613 [info ] [MainThread]: 
[0m15:46:33.338613 [error] [MainThread]:   Compilation Error in snapshot campaign_snapshot (snapshots\campaign_snapshot.sql)
  'snapshot_check' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:46:33.338613 [info ] [MainThread]: 
[0m15:46:33.338613 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:46:33.354560 [debug] [MainThread]: Command `dbt snapshot` failed at 15:46:33.353809 after 17.65 seconds
[0m15:46:33.354560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0043AB740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F003AE8FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F003AEB0B0>]}
[0m15:46:33.354560 [debug] [MainThread]: Flushing usage events
[0m15:46:34.441229 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:47:56.233772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB7A789040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB7A1F0740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB77954440>]}


============================== 15:47:56.233772 | f0edd35e-a199-4712-a13d-d5ed11166dcf ==============================
[0m15:47:56.233772 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:47:56.249493 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:47:56.406710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0edd35e-a199-4712-a13d-d5ed11166dcf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB7AF89430>]}
[0m15:47:56.456495 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:47:56.458424 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m15:47:56.459423 [debug] [MainThread]: Command `dbt deps` succeeded at 15:47:56.459423 after 0.39 seconds
[0m15:47:56.459423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB7A789040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB7B2D8470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AB7B23BAA0>]}
[0m15:47:56.460455 [debug] [MainThread]: Flushing usage events
[0m15:47:57.364891 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:48:20.643176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2051EFB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2057208C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D208B15E80>]}


============================== 15:48:20.643176 | 9f6cdac8-13d5-4a61-a1d0-eceaa95ec6ea ==============================
[0m15:48:20.643176 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:48:20.643176 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:48:20.810600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9f6cdac8-13d5-4a61-a1d0-eceaa95ec6ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2086B11F0>]}
[0m15:48:20.861029 [debug] [MainThread]: Set downloads directory='C:\Users\RAJGOK~1\AppData\Local\Temp\dbt-downloads-hcm7le3t'
[0m15:48:20.861029 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m15:48:21.228381 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m15:48:21.243221 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m15:48:21.698219 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m15:48:21.714008 [info ] [MainThread]: Updating lock file in file path: C:\Users\RajgokulRM\Documents\DE_FINAL\Marketing/package-lock.yml
[0m15:48:21.730081 [debug] [MainThread]: Set downloads directory='C:\Users\RAJGOK~1\AppData\Local\Temp\dbt-downloads-8k1z1sqe'
[0m15:48:21.734072 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m15:48:23.325004 [info ] [MainThread]: Installed from version 0.9.0
[0m15:48:23.326000 [info ] [MainThread]: Updated version available: 1.3.0
[0m15:48:23.328002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9f6cdac8-13d5-4a61-a1d0-eceaa95ec6ea', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2090790A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D208FDA4B0>]}
[0m15:48:23.328002 [info ] [MainThread]: 
[0m15:48:23.329001 [info ] [MainThread]: Updates available for packages: ['dbt-labs/dbt_utils']                 
Update your versions in packages.yml, then run dbt deps
[0m15:48:23.333000 [debug] [MainThread]: Command `dbt deps` succeeded at 15:48:23.332003 after 2.85 seconds
[0m15:48:23.333000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D2088E72F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D20818F9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D20818EF30>]}
[0m15:48:23.334001 [debug] [MainThread]: Flushing usage events
[0m15:48:24.201514 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:48:30.620652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D732BF12B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D73047D010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D73047C620>]}


============================== 15:48:30.620652 | 4209906c-b679-4385-94c8-9b553c50267f ==============================
[0m15:48:30.620652 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:48:30.620652 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\RajgokulRM\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\RajgokulRM\\Documents\\DE_FINAL\\marketing\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:48:31.733816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4209906c-b679-4385-94c8-9b553c50267f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D73FA5C890>]}
[0m15:48:31.812234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4209906c-b679-4385-94c8-9b553c50267f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D732F49A30>]}
[0m15:48:31.815234 [info ] [MainThread]: Registered adapter: snowflake=1.9.2
[0m15:48:32.397323 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:48:32.536456 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m15:48:32.536456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4209906c-b679-4385-94c8-9b553c50267f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D73FF12F60>]}
[0m15:48:35.641628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4209906c-b679-4385-94c8-9b553c50267f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D74123A360>]}
[0m15:48:35.768385 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m15:48:35.768385 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m15:48:35.799879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4209906c-b679-4385-94c8-9b553c50267f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D74137E240>]}
[0m15:48:35.799879 [info ] [MainThread]: Found 20 models, 1 snapshot, 6 data tests, 5 sources, 676 macros
[0m15:48:35.799879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4209906c-b679-4385-94c8-9b553c50267f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D741147E30>]}
[0m15:48:35.799879 [info ] [MainThread]: 
[0m15:48:35.799879 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:48:35.815775 [info ] [MainThread]: 
[0m15:48:35.815775 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:48:35.815775 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING'
[0m15:48:35.926725 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING"
[0m15:48:35.926725 [debug] [ThreadPool]: On list_MARKETING: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING"} */
show terse schemas in database MARKETING
    limit 10000
[0m15:48:35.926725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:37.192251 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.255 seconds
[0m15:48:37.204965 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_MARKETING_snapshots'
[0m15:48:37.208227 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_snapshots"
[0m15:48:37.208227 [debug] [ThreadPool]: On list_MARKETING_snapshots: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_snapshots"} */
show objects in MARKETING.snapshots limit 10000;
[0m15:48:37.208227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:38.174954 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.956 seconds
[0m15:48:38.176989 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_MARKETING_snapshots, now list_MARKETING_marketing)
[0m15:48:38.180424 [debug] [ThreadPool]: Using snowflake connection "list_MARKETING_marketing"
[0m15:48:38.181423 [debug] [ThreadPool]: On list_MARKETING_marketing: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "Marketing", "target_name": "dev", "connection_name": "list_MARKETING_marketing"} */
show objects in MARKETING.marketing limit 10000;
[0m15:48:38.451068 [debug] [ThreadPool]: SQL status: SUCCESS 20 in 0.272 seconds
[0m15:48:38.456324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4209906c-b679-4385-94c8-9b553c50267f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7412CC4A0>]}
[0m15:48:38.466114 [debug] [Thread-1 (]: Began running node snapshot.Marketing.campaign_snapshot
[0m15:48:38.467117 [info ] [Thread-1 (]: 1 of 1 START snapshot snapshots.campaign_snapshot .............................. [RUN]
[0m15:48:38.468116 [debug] [Thread-1 (]: Acquiring new snowflake connection 'snapshot.Marketing.campaign_snapshot'
[0m15:48:38.468116 [debug] [Thread-1 (]: Began compiling node snapshot.Marketing.campaign_snapshot
[0m15:48:38.484795 [debug] [Thread-1 (]: Compilation Error in snapshot campaign_snapshot (snapshots\campaign_snapshot.sql)
  'snapshot_check' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:48:38.486795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4209906c-b679-4385-94c8-9b553c50267f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D7323E60C0>]}
[0m15:48:38.487795 [error] [Thread-1 (]: 1 of 1 ERROR snapshotting snapshots.campaign_snapshot .......................... [[31mERROR[0m in 0.02s]
[0m15:48:38.489800 [debug] [Thread-1 (]: Finished running node snapshot.Marketing.campaign_snapshot
[0m15:48:38.491795 [debug] [Thread-4 (]: Marking all children of 'snapshot.Marketing.campaign_snapshot' to be skipped because of status 'error'.  Reason: Compilation Error in snapshot campaign_snapshot (snapshots\campaign_snapshot.sql)
  'snapshot_check' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m15:48:38.493182 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:38.494190 [debug] [MainThread]: Connection 'list_MARKETING' was left open.
[0m15:48:38.495189 [debug] [MainThread]: On list_MARKETING: Close
[0m15:48:38.821885 [debug] [MainThread]: Connection 'list_MARKETING_marketing' was left open.
[0m15:48:38.823896 [debug] [MainThread]: On list_MARKETING_marketing: Close
[0m15:48:39.148642 [debug] [MainThread]: Connection 'snapshot.Marketing.campaign_snapshot' was properly closed.
[0m15:48:39.148642 [info ] [MainThread]: 
[0m15:48:39.149607 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 3.33 seconds (3.33s).
[0m15:48:39.150619 [debug] [MainThread]: Command end result
[0m15:48:39.192407 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\manifest.json
[0m15:48:39.195745 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\semantic_manifest.json
[0m15:48:39.204427 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\RajgokulRM\Documents\DE_FINAL\marketing\target\run_results.json
[0m15:48:39.204427 [info ] [MainThread]: 
[0m15:48:39.204427 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:48:39.204427 [info ] [MainThread]: 
[0m15:48:39.204427 [error] [MainThread]:   Compilation Error in snapshot campaign_snapshot (snapshots\campaign_snapshot.sql)
  'snapshot_check' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m15:48:39.204427 [info ] [MainThread]: 
[0m15:48:39.204427 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:48:39.204427 [debug] [MainThread]: Command `dbt snapshot` failed at 15:48:39.204427 after 8.76 seconds
[0m15:48:39.204427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D732F4BB30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D73FF0F2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D73FAED040>]}
[0m15:48:39.204427 [debug] [MainThread]: Flushing usage events
[0m15:48:40.076338 [debug] [MainThread]: An error was encountered while trying to flush usage events
